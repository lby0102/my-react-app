/* @preserve
 * Leaflet 1.3.4, a JS library for interactive maps. http://leafletjs.com
 * (c) 2010-2018 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 *//* esri-leaflet - v2.2.3 - Thu Aug 16 2018 13:01:56 GMT-0700 (PDT)
 * Copyright (c) 2018 Environmental Systems Research Institute, Inc.
 * Apache-2.0 *//*
 (c) 2014, Vladimir Agafonkin
 simpleheat, a tiny JavaScript library for drawing heatmaps with Canvas
 https://github.com/mourner/simpleheat
*//**
 * Created by dingzhuang on 2018/7/30.
 */
!function(a,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(a.L={})}(this,function(a){function e(d){var n,b,c,a;b=1;for(c=arguments.length;b<c;b++)for(n in a=arguments[b],a)d[n]=a[n];return d}function k(d,n){var b=Array.prototype.slice;if(d.bind)return d.bind.apply(d,b.call(arguments,1));var c=b.call(arguments,2);return function(){return d.apply(n,c.length?c.concat(b.call(arguments)):arguments)}}function f(d){return d._leaflet_id=d._leaflet_id||++ja,d._leaflet_id}function h(d,n,b){var B,c,a,l;return l=function(){B=!1;c&&(a.apply(b,c),c=!1)},a=function(){B?c=arguments:(d.apply(b,arguments),setTimeout(l,n),B=!0)}}function m(d,n,b){var B=n[1];n=n[0];var c=B-n;return d===B&&b?d:((d-n)%c+c)%c+n}function g(){return!1}function u(d,n){var b=Math.pow(10,void 0===n?6:n);return Math.round(d*b)/b}function p(d){return d.trim?d.trim():d.replace(/^\s+|\s+$/g,"")}function v(d){return p(d).split(/\s+/)}function x(d,n){d.hasOwnProperty("options")||(d.options=d.options?Ib(d.options):{});for(var b in n)d.options[b]=n[b];return d.options}function E(d,n,b){var B=[],c;for(c in d)B.push(encodeURIComponent(b?c.toUpperCase():c)+"\x3d"+encodeURIComponent(d[c]));return(n&&-1!==n.indexOf("?")?"\x26":"?")+B.join("\x26")}function z(d,n){return d.replace(wb,function(d,b){var B=n[b];if(void 0===B)throw Error("No value provided for variable "+d);return"function"==typeof B&&(B=B(n)),B})}function H(d,n){for(var b=0;b<d.length;b++)if(d[b]===n)return b;return-1}function F(d){return window["webkit"+d]||window["moz"+d]||window["ms"+d]}function I(d){var n=+new Date,b=Math.max(0,16-(n-kb));return kb=n+b,window.setTimeout(d,b)}function V(d,n,b){if(!b||cb!==I)return cb.call(window,k(d,n));d.call(n)}function aa(d){d&&db.call(window,d)}function fa(){}function Fa(d){if("undefined"!=typeof L&&L&&L.Mixin){d=sa(d)?d:[d];for(var n=0;n<d.length;n++)d[n]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",Error().stack)}}function C(d,n,b){this.x=b?Math.round(d):d;this.y=b?Math.round(n):n}function G(d,n,b){return d instanceof C?d:sa(d)?new C(d[0],d[1]):void 0===d||null===d?d:"object"==typeof d&&"x"in d&&"y"in d?new C(d.x,d.y):new C(d,n,b)}function R(d,n){if(d)for(var b=n?[d,n]:d,c=0,a=b.length;c<a;c++)this.extend(b[c])}function pa(d,n){return!d||d instanceof R?d:new R(d,n)}function ha(d,n){if(d)for(var b=n?[d,n]:d,c=0,a=b.length;c<a;c++)this.extend(b[c])}function X(d,n){return d instanceof ha?d:new ha(d,n)}function Q(d,n,b){if(isNaN(d)||isNaN(n))throw Error("Invalid LatLng object: ("+d+", "+n+")");this.lat=+d;this.lng=+n;void 0!==b&&(this.alt=+b)}function O(d,n,b){return d instanceof Q?d:sa(d)&&"object"!=typeof d[0]?3===d.length?new Q(d[0],d[1],d[2]):2===d.length?new Q(d[0],d[1]):null:void 0===d||null===d?d:"object"==typeof d&&"lat"in d?new Q(d.lat,"lng"in d?d.lng:d.lon,d.alt):void 0===n?null:new Q(d,n,b)}function Ga(d,n,b,c){if(sa(d))return this._a=d[0],this._b=d[1],this._c=d[2],void(this._d=d[3]);this._a=d;this._b=n;this._c=b;this._d=c}function va(d,n,b,c){return new Ga(d,n,b,c)}function eb(d){return document.createElementNS("http://www.w3.org/2000/svg",d)}function wa(d,n){var b,c,a,l,r,f,e="";b=0;for(a=d.length;b<a;b++){c=0;for(l=(r=d[b]).length;c<l;c++)f=r[c],e+=(c?"L":"M")+f.x+" "+f.y;e+=n?sc?"z":"x":""}return e||"M0 0"}function ia(d){return 0<=navigator.userAgent.toLowerCase().indexOf(d)}function Jb(d,n,b,c){return"touchstart"===n?Ma(d,b,c):"touchmove"===n?A(d,b,c):"touchend"===n&&ea(d,b,c),this}function lb(d,n,b){b=d["_leaflet_"+n+b];return"touchstart"===n?d.removeEventListener(Ic,b,!1):"touchmove"===n?d.removeEventListener(Jc,b,!1):"touchend"===n&&(d.removeEventListener(Kc,b,!1),d.removeEventListener(Lc,b,!1)),this}function Ma(d,n,b){var c=k(function(d){if("mouse"!==d.pointerType&&d.MSPOINTER_TYPE_MOUSE&&d.pointerType!==d.MSPOINTER_TYPE_MOUSE){if(!(0>xd.indexOf(d.target.tagName)))return;Y(d)}Aa(d,n)});d["_leaflet_touchstart"+b]=c;d.addEventListener(Ic,c,!1);$c||(document.documentElement.addEventListener(Ic,y,!0),document.documentElement.addEventListener(Jc,Kb,!0),document.documentElement.addEventListener(Kc,Ba,!0),document.documentElement.addEventListener(Lc,Ba,!0),$c=!0)}function y(d){Lb[d.pointerId]=d;Mc++}function Kb(d){Lb[d.pointerId]&&(Lb[d.pointerId]=d)}function Ba(d){delete Lb[d.pointerId];Mc--}function Aa(d,n){d.touches=[];for(var b in Lb)d.touches.push(Lb[b]);d.changedTouches=[d];n(d)}function A(d,n,b){var c=function(d){(d.pointerType!==d.MSPOINTER_TYPE_MOUSE&&"mouse"!==d.pointerType||0!==d.buttons)&&Aa(d,n)};d["_leaflet_touchmove"+b]=c;d.addEventListener(Jc,c,!1)}function ea(d,n,b){var c=function(d){Aa(d,n)};d["_leaflet_touchend"+b]=c;d.addEventListener(Kc,c,!1);d.addEventListener(Lc,c,!1)}function Ca(d,n,b){function c(d){var n;if(Na){if(!xb||"mouse"===d.pointerType)return;n=Mc}else n=d.touches.length;if(!(1<n)){n=Date.now();var b=n-(a||n);l=d.touches?d.touches[0]:d;r=0<b&&b<=f;a=n}}function B(d){if(r&&!l.cancelBubble){if(Na){if(!xb||"mouse"===d.pointerType)return;var b,c={};for(b in l)d=l[b],c[b]=d&&d.bind?d.bind(l):d;l=c}l.type="dblclick";n(l);a=null}}var a,l,r=!1,f=250;return d[Mb+tc+b]=c,d[Mb+uc+b]=B,d[Mb+"dblclick"+b]=n,d.addEventListener(tc,c,!1),d.addEventListener(uc,B,!1),d.addEventListener("dblclick",n,!1),this}function P(d,n){var b=d[Mb+uc+n],c=d[Mb+"dblclick"+n];return d.removeEventListener(tc,d[Mb+tc+n],!1),d.removeEventListener(uc,b,!1),xb||d.removeEventListener("dblclick",c,!1),this}function Oa(d){return"string"==typeof d?document.getElementById(d):d}function T(d,n){var b=d.style[n]||d.currentStyle&&d.currentStyle[n];b&&"auto"!==b||!document.defaultView||(b=(b=document.defaultView.getComputedStyle(d,null))?b[n]:null);return"auto"===b?null:b}function M(d,n,b){d=document.createElement(d);return d.className=n||"",b&&b.appendChild(d),d}function ba(d){var n=d.parentNode;n&&n.removeChild(d)}function Ha(d){for(;d.firstChild;)d.removeChild(d.firstChild)}function Ea(d){var n=d.parentNode;n.lastChild!==d&&n.appendChild(d)}function xa(d){var n=d.parentNode;n.firstChild!==d&&n.insertBefore(d,n.firstChild)}function Va(d,n){if(void 0!==d.classList)return d.classList.contains(n);var b=Wa(d);return 0<b.length&&(new RegExp("(^|\\s)"+n+"(\\s|$)")).test(b)}function K(d,n){if(void 0!==d.classList)for(var b=v(n),c=0,a=b.length;c<a;c++)d.classList.add(b[c]);else Va(d,n)||(b=Wa(d),Da(d,(b?b+" ":"")+n))}function ca(d,n){void 0!==d.classList?d.classList.remove(n):Da(d,p((" "+Wa(d)+" ").replace(" "+n+" "," ")))}function Da(d,n){void 0===d.className.baseVal?d.className=n:d.className.baseVal=n}function Wa(d){return void 0===d.className.baseVal?d.className:d.className.baseVal}function ka(d,n){if("opacity"in d.style)d.style.opacity=n;else if("filter"in d.style)a:{var b=n,c=!1;try{c=d.filters.item("DXImageTransform.Microsoft.Alpha")}catch(Nd){if(1===b)break a}b=Math.round(100*b);c?(c.Enabled=100!==b,c.Opacity=b):d.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity\x3d"+b+")"}}function Xa(d){for(var n=document.documentElement.style,b=0;b<d.length;b++)if(d[b]in n)return d[b];return!1}function W(d,n,b){n=n||new C(0,0);d.style[Nc]=(l?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(b?" scale("+b+")":"")}function da(d,n){d._leaflet_pos=n;Ia?W(d,n):(d.style.left=n.x+"px",d.style.top=n.y+"px")}function ya(d){return d._leaflet_pos||new C(0,0)}function ta(){c(window,"dragstart",Y)}function D(){q(window,"dragstart",Y)}function la(d){for(;-1===d.tabIndex;)d=d.parentNode;d.style&&(za(),vc=d,Oc=d.style.outline,d.style.outline="none",c(window,"keydown",za))}function za(){vc&&(vc.style.outline=Oc,vc=void 0,Oc=void 0,q(window,"keydown",za))}function fb(d){do d=d.parentNode;while(!(d.offsetWidth&&d.offsetHeight||d===document.body));return d}function Pa(d){var n=d.getBoundingClientRect();return{x:n.width/d.offsetWidth||1,y:n.height/d.offsetHeight||1,boundingClientRect:n}}function c(d,n,b,c){if("object"==typeof n)for(var a in n)w(d,a,n[a],b);else{a=0;for(var B=(n=v(n)).length;a<B;a++)w(d,n[a],b,c)}return this}function q(d,n,b,c){if("object"==typeof n)for(var a in n)J(d,a,n[a],b);else if(n){a=0;for(var B=(n=v(n)).length;a<B;a++)J(d,n[a],b,c)}else{for(B in d[Qa])J(d,B,d[Qa][B]);delete d[Qa]}return this}function w(d,n,b,c){var a=n+f(b)+(c?"_"+f(c):"");if(d[Qa]&&d[Qa][a])return this;var B=function(n){return b.call(c||d,n||window.event)},l=B;Na&&0===n.indexOf("touch")?Jb(d,n,B,a):!Ya||"dblclick"!==n||!Ca||Na&&Ra?"addEventListener"in d?"mousewheel"===n?d.addEventListener("onwheel"in d?"wheel":"mousewheel",B,!1):"mouseenter"===n||"mouseleave"===n?(B=function(n){n=n||window.event;qa(d,n)&&l(n)},d.addEventListener("mouseenter"===n?"mouseover":"mouseout",B,!1)):("click"===n&&mb&&(B=function(d){var n=d.timeStamp||d.originalEvent&&d.originalEvent.timeStamp,b=Pc&&n-Pc;b&&100<b&&500>b||d.target._simulatedClick&&!d._simulated?ma(d):(Pc=n,l(d))}),d.addEventListener(n,B,!1)):"attachEvent"in d&&d.attachEvent("on"+n,B):Ca(d,B,a);d[Qa]=d[Qa]||{};d[Qa][a]=B}function J(d,n,b,c){b=n+f(b)+(c?"_"+f(c):"");c=d[Qa]&&d[Qa][b];if(!c)return this;Na&&0===n.indexOf("touch")?lb(d,n,b):!Ya||"dblclick"!==n||!P||Na&&Ra?"removeEventListener"in d?"mousewheel"===n?d.removeEventListener("onwheel"in d?"wheel":"mousewheel",c,!1):d.removeEventListener("mouseenter"===n?"mouseover":"mouseleave"===n?"mouseout":n,c,!1):"detachEvent"in d&&d.detachEvent("on"+n,c):P(d,b);d[Qa][b]=null}function N(d){return d.stopPropagation?d.stopPropagation():d.originalEvent?d.originalEvent._stopped=!0:d.cancelBubble=!0,na(d),this}function ua(d){return w(d,"mousewheel",N),this}function ga(d){return c(d,"mousedown touchstart dblclick",N),w(d,"click",Za),this}function Y(d){return d.preventDefault?d.preventDefault():d.returnValue=!1,this}function ma(d){return Y(d),N(d),this}function bc(d,n){if(!n)return new C(d.clientX,d.clientY);var b=Pa(n),c=b.boundingClientRect;return new C((d.clientX-c.left)/b.x-n.clientLeft,(d.clientY-c.top)/b.y-n.clientTop)}function cc(d){return xb?d.wheelDeltaY/2:d.deltaY&&0===d.deltaMode?-d.deltaY/yd:d.deltaY&&1===d.deltaMode?20*-d.deltaY:d.deltaY&&2===d.deltaMode?60*-d.deltaY:d.deltaX||d.deltaZ?0:d.wheelDelta?(d.wheelDeltaY||d.wheelDelta)/2:d.detail&&32765>Math.abs(d.detail)?20*-d.detail:d.detail?d.detail/-32765*60:0}function Za(d){Qc[d.type]=!0}function na(d){var n=Qc[d.type];return Qc[d.type]=!1,n}function qa(d,n){var b=n.relatedTarget;if(!b)return!0;try{for(;b&&b!==d;)b=b.parentNode}catch(Md){return!1}return b!==d}function nb(d,n){if(!n||!d.length)return d.slice();for(var b=n*n,c=d,a=[c[0]],l=1,r=0,f=c.length;l<f;l++){var e=c[l],g=c[r],m=g.x-e.x,e=g.y-e.y;m*m+e*e>b&&(a.push(c[l]),r=l)}c=d=(r<f-1&&a.push(c[f-1]),a);a=c.length;l=new ("undefined"!=typeof Uint8Array?Uint8Array:Array)(a);l[0]=l[a-1]=1;dc(c,l,b,0,a-1);r=[];for(b=0;b<a;b++)l[b]&&r.push(c[b]);return r}function ob(d,n,b){return Math.sqrt(yb(d,n,b,!0))}function dc(d,n,b,c,a){var B,l,r,f=0;for(l=c+1;l<=a-1;l++)(r=yb(d[l],d[c],d[a],!0))>f&&(B=l,f=r);f>b&&(n[B]=1,dc(d,n,b,c,B),dc(d,n,b,B,a))}function ec(d,n,b,c,a){var B,l,r=c?ad:$a(d,b),f=$a(n,b);for(ad=f;;){if(!(r|f))return[d,n];if(r&f)return!1;l=$a(B=gb(d,n,c=r||f,b,a),b);c===r?(d=B,r=l):(n=B,f=l)}}function gb(d,n,b,c,a){var B,l,r=n.x-d.x;n=n.y-d.y;var f=c.min;c=c.max;return 8&b?(B=d.x+r*(c.y-d.y)/n,l=c.y):4&b?(B=d.x+r*(f.y-d.y)/n,l=f.y):2&b?(B=c.x,l=d.y+n*(c.x-d.x)/r):1&b&&(B=f.x,l=d.y+n*(f.x-d.x)/r),new C(B,l,a)}function $a(d,n){var b=0;return d.x<n.min.x?b|=1:d.x>n.max.x&&(b|=2),d.y<n.min.y?b|=4:d.y>n.max.y&&(b|=8),b}function yb(d,b,c,a){var n,l=b.x;b=b.y;var B=c.x-l,r=c.y-b,f=B*B+r*r;return 0<f&&(1<(n=((d.x-l)*B+(d.y-b)*r)/f)?(l=c.x,b=c.y):0<n&&(l+=B*n,b+=r*n)),B=d.x-l,r=d.y-b,a?B*B+r*r:new C(l,b)}function Ja(d){return!sa(d[0])||"object"!=typeof d[0][0]&&void 0!==d[0][0]}function Nb(d){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ja(d)}function Ob(d,b,c){var n,a,l,B,r,f,e,g,m=[1,4,2,8];a=0;for(f=d.length;a<f;a++)d[a]._code=$a(d[a],b);for(B=0;4>B;B++){e=m[B];n=[];a=0;for(l=(f=d.length)-1;a<f;l=a++)r=d[a],l=d[l],r._code&e?l._code&e||((g=gb(l,r,e,b,c))._code=$a(g,b),n.push(g)):(l._code&e&&((g=gb(l,r,e,b,c))._code=$a(g,b),n.push(g)),n.push(r));d=n}return d}function Pb(d,b){var n,c,a,l="Feature"===d.type?d.geometry:d,r=l?l.coordinates:null,f=[],e=b&&b.pointToLayer,g=b&&b.coordsToLatLng||pb;if(!r&&!l)return null;switch(l.type){case "Point":return n=g(r),e?e(d,n):new fc(n);case "MultiPoint":c=0;for(a=r.length;c<a;c++)n=g(r[c]),f.push(e?e(d,n):new fc(n));return new zb(f);case "LineString":case "MultiLineString":return c=Qb(r,"LineString"===l.type?0:1,g),new hb(c,b);case "Polygon":case "MultiPolygon":return c=Qb(r,"Polygon"===l.type?1:2,g),new Rb(c,b);case "GeometryCollection":c=0;for(a=l.geometries.length;c<a;c++)(n=Pb({geometry:l.geometries[c],type:"Feature",properties:d.properties},b))&&f.push(n);return new zb(f);default:throw Error("Invalid GeoJSON object.");}}function pb(d){return new Q(d[1],d[0],d[2])}function Qb(d,b,c){for(var n,a=[],l=0,B=d.length;l<B;l++)n=b?Qb(d[l],b-1,c):(c||pb)(d[l]),a.push(n);return a}function Ab(d,b){return b="number"==typeof b?b:6,void 0!==d.alt?[u(d.lng,b),u(d.lat,b),u(d.alt,b)]:[u(d.lng,b),u(d.lat,b)]}function Sb(d,b,c,a){for(var n=[],l=0,B=d.length;l<B;l++)n.push(b?Sb(d[l],b-1,c,a):Ab(d[l],a));return!b&&c&&n.push(n[0]),n}function qb(d,b){return d.feature?e({},d.feature,{geometry:b}):Tb(b)}function Tb(d){return"Feature"===d.type||"FeatureCollection"===d.type?d:{type:"Feature",properties:{},geometry:d}}function wc(d,b){return new ib(d,b)}function xc(d,b){return new Ub(d,b)}function yc(d){return bd?new cd(d):null}function zc(d){return sc||Ac?new gc(d):null}var Bc=Object.freeze;Object.freeze=function(d){return d};var Ib=Object.create||function(){function d(){}return function(b){return d.prototype=b,new d}}(),ja=0,wb=/\{ *([\w_-]+) *\}/g,sa=Array.isArray||function(d){return"[object Array]"===Object.prototype.toString.call(d)},kb=0,cb=window.requestAnimationFrame||F("RequestAnimationFrame")||I,db=window.cancelAnimationFrame||F("CancelAnimationFrame")||F("CancelRequestAnimationFrame")||function(d){window.clearTimeout(d)},rb=(Object.freeze||Object)({freeze:Bc,extend:e,create:Ib,bind:k,lastId:ja,stamp:f,throttle:h,wrapNum:m,falseFn:g,formatNum:u,trim:p,splitWords:v,setOptions:x,getParamString:E,template:z,isArray:sa,indexOf:H,emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d",requestFn:cb,cancelFn:db,requestAnimFrame:V,cancelAnimFrame:aa});fa.extend=function(d){var b=function(){this.initialize&&this.initialize.apply(this,arguments);this.callInitHooks()},c=b.__super__=this.prototype,a=Ib(c);a.constructor=b;b.prototype=a;for(var l in this)this.hasOwnProperty(l)&&"prototype"!==l&&"__super__"!==l&&(b[l]=this[l]);return d.statics&&(e(b,d.statics),delete d.statics),d.includes&&(Fa(d.includes),e.apply(null,[a].concat(d.includes)),delete d.includes),a.options&&(d.options=e(Ib(a.options),d.options)),e(a,d),a._initHooks=[],a.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this);this._initHooksCalled=!0;for(var d=0,b=a._initHooks.length;d<b;d++)a._initHooks[d].call(this)}},b};fa.include=function(d){return e(this.prototype,d),this};fa.mergeOptions=function(d){return e(this.prototype.options,d),this};fa.addInitHook=function(d){var b=Array.prototype.slice.call(arguments,1);return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push("function"==typeof d?d:function(){this[d].apply(this,b)}),this};var oa={on:function(d,b,c){if("object"==typeof d)for(var n in d)this._on(n,d[n],b);else{n=0;for(var a=(d=v(d)).length;n<a;n++)this._on(d[n],b,c)}return this},off:function(d,b,c){if(d)if("object"==typeof d)for(var n in d)this._off(n,d[n],b);else{n=0;for(var a=(d=v(d)).length;n<a;n++)this._off(d[n],b,c)}else delete this._events;return this},_on:function(d,b,c){this._events=this._events||{};var n=this._events[d];n||(n=[],this._events[d]=n);c===this&&(c=void 0);d={fn:b,ctx:c};for(var a=0,l=n.length;a<l;a++)if(n[a].fn===b&&n[a].ctx===c)return;n.push(d)},_off:function(d,b,c){var n,a,l;if(this._events&&(n=this._events[d]))if(b){if(c===this&&(c=void 0),n)for(a=0,l=n.length;a<l;a++){var B=n[a];if(B.ctx===c&&B.fn===b)return B.fn=g,this._firingCount&&(this._events[d]=n=n.slice()),void n.splice(a,1)}}else{a=0;for(l=n.length;a<l;a++)n[a].fn=g;delete this._events[d]}},fire:function(d,b,c){if(!this.listens(d,c))return this;b=e({},b,{type:d,target:this,sourceTarget:b&&b.sourceTarget||this});if(this._events&&(d=this._events[d])){this._firingCount=this._firingCount+1||1;for(var n=0,a=d.length;n<a;n++){var l=d[n];l.fn.call(l.ctx||this,b)}this._firingCount--}return c&&this._propagateEvent(b),this},listens:function(d,b){var n=this._events&&this._events[d];if(n&&n.length)return!0;if(b)for(var c in this._eventParents)if(this._eventParents[c].listens(d,b))return!0;return!1},once:function(d,b,c){if("object"==typeof d){for(var n in d)this.once(n,d[n],b);return this}var a=k(function(){this.off(d,b,c).off(d,a,c)},this);return this.on(d,b,c).on(d,a,c)},addEventParent:function(d){return this._eventParents=this._eventParents||{},this._eventParents[f(d)]=d,this},removeEventParent:function(d){return this._eventParents&&delete this._eventParents[f(d)],this},_propagateEvent:function(d){for(var b in this._eventParents)this._eventParents[b].fire(d.type,e({layer:d.target,propagatedFrom:d.target},d),!0)}};oa.addEventListener=oa.on;oa.removeEventListener=oa.clearAllEventListeners=oa.off;oa.addOneTimeEventListener=oa.once;oa.fireEvent=oa.fire;oa.hasEventListeners=oa.listens;var Bb=fa.extend(oa),Sa=Math.trunc||function(d){return 0<d?Math.floor(d):Math.ceil(d)};C.prototype={clone:function(){return new C(this.x,this.y)},add:function(d){return this.clone()._add(G(d))},_add:function(d){return this.x+=d.x,this.y+=d.y,this},subtract:function(d){return this.clone()._subtract(G(d))},_subtract:function(d){return this.x-=d.x,this.y-=d.y,this},divideBy:function(d){return this.clone()._divideBy(d)},_divideBy:function(d){return this.x/=d,this.y/=d,this},multiplyBy:function(d){return this.clone()._multiplyBy(d)},_multiplyBy:function(d){return this.x*=d,this.y*=d,this},scaleBy:function(d){return new C(this.x*d.x,this.y*d.y)},unscaleBy:function(d){return new C(this.x/d.x,this.y/d.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Sa(this.x),this.y=Sa(this.y),this},distanceTo:function(d){var b=(d=G(d)).x-this.x;d=d.y-this.y;return Math.sqrt(b*b+d*d)},equals:function(d){return(d=G(d)).x===this.x&&d.y===this.y},contains:function(d){return d=G(d),Math.abs(d.x)<=Math.abs(this.x)&&Math.abs(d.y)<=Math.abs(this.y)},toString:function(){return"Point("+u(this.x)+", "+u(this.y)+")"}};R.prototype={extend:function(d){return d=G(d),this.min||this.max?(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(d.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(d.y,this.max.y)):(this.min=d.clone(),this.max=d.clone()),this},getCenter:function(d){return new C((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,d)},getBottomLeft:function(){return new C(this.min.x,this.max.y)},getTopRight:function(){return new C(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(d){var b,c;return(d="number"==typeof d[0]||d instanceof C?G(d):pa(d))instanceof R?(b=d.min,c=d.max):b=c=d,b.x>=this.min.x&&c.x<=this.max.x&&b.y>=this.min.y&&c.y<=this.max.y},intersects:function(d){d=pa(d);var b=this.min,c=this.max,a=d.min;d=d.max;var l=d.y>=b.y&&a.y<=c.y;return d.x>=b.x&&a.x<=c.x&&l},overlaps:function(d){d=pa(d);var b=this.min,c=this.max,a=d.min;d=d.max;var l=d.y>b.y&&a.y<c.y;return d.x>b.x&&a.x<c.x&&l},isValid:function(){return!(!this.min||!this.max)}};ha.prototype={extend:function(d){var b,c,a=this._southWest,l=this._northEast;if(d instanceof Q)c=b=d;else{if(!(d instanceof ha))return d?this.extend(O(d)||X(d)):this;if(b=d._southWest,c=d._northEast,!b||!c)return this}return a||l?(a.lat=Math.min(b.lat,a.lat),a.lng=Math.min(b.lng,a.lng),l.lat=Math.max(c.lat,l.lat),l.lng=Math.max(c.lng,l.lng)):(this._southWest=new Q(b.lat,b.lng),this._northEast=new Q(c.lat,c.lng)),this},pad:function(d){var b=this._southWest,c=this._northEast,a=Math.abs(b.lat-c.lat)*d;d*=Math.abs(b.lng-c.lng);return new ha(new Q(b.lat-a,b.lng-d),new Q(c.lat+a,c.lng+d))},getCenter:function(){return new Q((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Q(this.getNorth(),this.getWest())},getSouthEast:function(){return new Q(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(d){d="number"==typeof d[0]||d instanceof Q||"lat"in d?O(d):X(d);var b,c,a=this._southWest,l=this._northEast;return d instanceof ha?(b=d.getSouthWest(),c=d.getNorthEast()):b=c=d,b.lat>=a.lat&&c.lat<=l.lat&&b.lng>=a.lng&&c.lng<=l.lng},intersects:function(d){d=X(d);var b=this._southWest,c=this._northEast,a=d.getSouthWest();d=d.getNorthEast();var l=d.lng>=b.lng&&a.lng<=c.lng;return d.lat>=b.lat&&a.lat<=c.lat&&l},overlaps:function(d){d=X(d);var b=this._southWest,c=this._northEast,a=d.getSouthWest();d=d.getNorthEast();var l=d.lng>b.lng&&a.lng<c.lng;return d.lat>b.lat&&a.lat<c.lat&&l},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join()},equals:function(d,b){return!!d&&(d=X(d),this._southWest.equals(d.getSouthWest(),b)&&this._northEast.equals(d.getNorthEast(),b))},isValid:function(){return!(!this._southWest||!this._northEast)}};Q.prototype={equals:function(d,b){return!!d&&(d=O(d),Math.max(Math.abs(this.lat-d.lat),Math.abs(this.lng-d.lng))<=(void 0===b?1E-9:b))},toString:function(d){return"LatLng("+u(this.lat,d)+", "+u(this.lng,d)+")"},distanceTo:function(d){return ra.distance(this,O(d))},wrap:function(){return ra.wrapLatLng(this)},toBounds:function(d){d=180*d/40075017;var b=d/Math.cos(Math.PI/180*this.lat);return X([this.lat-d,this.lng-b],[this.lat+d,this.lng+b])},clone:function(){return new Q(this.lat,this.lng,this.alt)}};var Ta={latLngToPoint:function(d,b){var n=this.projection.project(d),c=this.scale(b);return this.transformation._transform(n,c)},pointToLatLng:function(d,b){var n=this.scale(b),n=this.transformation.untransform(d,n);return this.projection.unproject(n)},project:function(d){return this.projection.project(d)},unproject:function(d){return this.projection.unproject(d)},scale:function(d){return 256*Math.pow(2,d)},zoom:function(d){return Math.log(d/256)/Math.LN2},getProjectedBounds:function(d){if(this.infinite)return null;var b=this.projection.bounds;d=this.scale(d);return new R(this.transformation.transform(b.min,d),this.transformation.transform(b.max,d))},infinite:!1,wrapLatLng:function(d){var b=this.wrapLng?m(d.lng,this.wrapLng,!0):d.lng;return new Q(this.wrapLat?m(d.lat,this.wrapLat,!0):d.lat,b,d.alt)},wrapLatLngBounds:function(d){var b=d.getCenter(),c=this.wrapLatLng(b),a=b.lat-c.lat,b=b.lng-c.lng;if(0===a&&0===b)return d;c=d.getSouthWest();d=d.getNorthEast();return new ha(new Q(c.lat-a,c.lng-b),new Q(d.lat-a,d.lng-b))}},ra=e({},Ta,{wrapLng:[-180,180],R:6371E3,distance:function(d,b){var n=Math.PI/180,c=Math.sin((b.lat-d.lat)*n/2),a=Math.sin((b.lng-d.lng)*n/2),n=c*c+Math.cos(d.lat*n)*Math.cos(b.lat*n)*a*a;return 2*this.R*Math.atan2(Math.sqrt(n),Math.sqrt(1-n))}}),hc={R:6378137,MAX_LATITUDE:85.0511287798,project:function(d){var b=Math.PI/180,c=this.MAX_LATITUDE,c=Math.sin(Math.max(Math.min(c,d.lat),-c)*b);return new C(this.R*d.lng*b,this.R*Math.log((1+c)/(1-c))/2)},unproject:function(d){var b=180/Math.PI;return new Q((2*Math.atan(Math.exp(d.y/this.R))-Math.PI/2)*b,d.x*b/this.R)},bounds:function(){var d=6378137*Math.PI;return new R([-d,-d],[d,d])}()};Ga.prototype={transform:function(d,b){return this._transform(d.clone(),b)},_transform:function(d,b){return b=b||1,d.x=b*(this._a*d.x+this._b),d.y=b*(this._c*d.y+this._d),d},untransform:function(d,b){return b=b||1,new C((d.x/b-this._b)/this._a,(d.y/b-this._d)/this._c)}};var Cb,Db,ic,jc=e({},ra,{code:"EPSG:3857",projection:hc,transformation:function(){var d=.5/(Math.PI*hc.R);return va(d,.5,-d,.5)}()}),Rc=e({},jc,{code:"EPSG:900913"}),kc=document.documentElement.style,Vb="ActiveXObject"in window,sb=Vb&&!document.addEventListener,xb="msLaunchUri"in navigator&&!("documentMode"in document),lc=ia("webkit"),mb=ia("android"),Eb=ia("android 2")||ia("android 3"),U=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Cc=mb&&ia("Google")&&537>U&&!("AudioNode"in window),Fb=!!window.opera,Ra=ia("chrome"),Wb=ia("gecko")&&!lc&&!Fb&&!Vb,Dc=!Ra&&ia("safari"),Gb=ia("phantom"),Ec="OTransition"in kc,b=0===navigator.platform.indexOf("Win"),l=Vb&&"transition"in kc,r="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Eb,Ka="MozPerspective"in kc,Ia=!window.L_DISABLE_3D&&(l||r||Ka)&&!Ec&&!Gb,Xb="undefined"!=typeof orientation||ia("mobile"),Fc=Xb&&lc,zd=Xb&&r,tb=!window.PointerEvent&&window.MSPointerEvent,Na=!(!window.PointerEvent&&!tb),Ya=!window.L_NO_TOUCH&&(Na||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),dd=Xb&&Fb,Ad=Xb&&Wb,ub=1<(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI),bd=!!document.createElement("canvas").getContext,sc=!(!document.createElementNS||!eb("svg").createSVGRect),Ac=!sc&&function(){try{var d=document.createElement("div");d.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';var b=d.firstChild;return b.style.behavior="url(#default#VML)",b&&"object"==typeof b.adj}catch(B){return!1}}(),Bd=(Object.freeze||Object)({ie:Vb,ielt9:sb,edge:xb,webkit:lc,android:mb,android23:Eb,androidStock:Cc,opera:Fb,chrome:Ra,gecko:Wb,safari:Dc,phantom:Gb,opera12:Ec,win:b,ie3d:l,webkit3d:r,gecko3d:Ka,any3d:Ia,mobile:Xb,mobileWebkit:Fc,mobileWebkit3d:zd,msPointer:tb,pointer:Na,touch:Ya,mobileOpera:dd,mobileGecko:Ad,retina:ub,canvas:bd,svg:sc,vml:Ac}),Ic=tb?"MSPointerDown":"pointerdown",Jc=tb?"MSPointerMove":"pointermove",Kc=tb?"MSPointerUp":"pointerup",Lc=tb?"MSPointerCancel":"pointercancel",xd=["INPUT","SELECT","OPTION"],Lb={},$c=!1,Mc=0,tc=tb?"MSPointerDown":Na?"pointerdown":"touchstart",uc=tb?"MSPointerUp":Na?"pointerup":"touchend",Mb="_leaflet_",Nc=Xa(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),mc=Xa(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ed="webkitTransition"===mc||"OTransition"===mc?mc+"End":"transitionend";if("onselectstart"in document)Cb=function(){c(window,"selectstart",Y)},Db=function(){q(window,"selectstart",Y)};else{var nc=Xa(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Cb=function(){if(nc){var d=document.documentElement.style;ic=d[nc];d[nc]="none"}};Db=function(){nc&&(document.documentElement.style[nc]=ic,ic=void 0)}}var vc,Oc,Pc,Cd=(Object.freeze||Object)({TRANSFORM:Nc,TRANSITION:mc,TRANSITION_END:ed,get:Oa,getStyle:T,create:M,remove:ba,empty:Ha,toFront:Ea,toBack:xa,hasClass:Va,addClass:K,removeClass:ca,setClass:Da,getClass:Wa,setOpacity:ka,testProp:Xa,setTransform:W,setPosition:da,getPosition:ya,disableTextSelection:Cb,enableTextSelection:Db,disableImageDrag:ta,enableImageDrag:D,preventOutline:la,restoreOutline:za,getSizedParentNode:fb,getScale:Pa}),Qa="_leaflet_events",yd=b&&Ra?2*window.devicePixelRatio:Wb?window.devicePixelRatio:1,Qc={},Dd=(Object.freeze||Object)({on:c,off:q,stopPropagation:N,disableScrollPropagation:ua,disableClickPropagation:ga,preventDefault:Y,stop:ma,getMousePosition:bc,getWheelDelta:cc,fakeStop:Za,skipped:na,isExternalTarget:qa,addListener:c,removeListener:q}),fd=Bb.extend({run:function(d,b,c,a){this.stop();this._el=d;this._inProgress=!0;this._duration=c||.25;this._easeOutPower=1/Math.max(a||.5,.2);this._startPos=ya(d);this._offset=b.subtract(this._startPos);this._startTime=+new Date;this.fire("start");this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=V(this._animate,this);this._step()},_step:function(d){var b=+new Date-this._startTime,c=1E3*this._duration;b<c?this._runFrame(this._easeOut(b/c),d):(this._runFrame(1),this._complete())},_runFrame:function(d,b){var n=this._startPos.add(this._offset.multiplyBy(d));b&&n._round();da(this._el,n);this.fire("step")},_complete:function(){aa(this._animId);this._inProgress=!1;this.fire("end")},_easeOut:function(d){return 1-Math.pow(1-d,this._easeOutPower)}}),S=Bb.extend({options:{crs:jc,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(d,b){b=x(this,b);this._initContainer(d);this._initLayout();this._onResize=k(this._onResize,this);this._initEvents();b.maxBounds&&this.setMaxBounds(b.maxBounds);void 0!==b.zoom&&(this._zoom=this._limitZoom(b.zoom));b.center&&void 0!==b.zoom&&this.setView(O(b.center),b.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._sizeChanged=!0;this.callInitHooks();(this._zoomAnimated=mc&&Ia&&!dd&&this.options.zoomAnimation)&&(this._createAnimProxy(),c(this._proxy,ed,this._catchTransitionEnd,this));this._addLayers(this.options.layers)},setView:function(d,b,c){return b=void 0===b?this._zoom:this._limitZoom(b),d=this._limitCenter(O(d),b,this.options.maxBounds),c=c||{},this._stop(),this._loaded&&!c.reset&&!0!==c&&(void 0!==c.animate&&(c.zoom=e({animate:c.animate},c.zoom),c.pan=e({animate:c.animate,duration:c.duration},c.pan)),this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(d,b,c.zoom):this._tryAnimatedPan(d,c.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(d,b),this)},setZoom:function(d,b){return this._loaded?this.setView(this.getCenter(),d,{zoom:b}):(this._zoom=d,this)},zoomIn:function(d,b){return d=d||(Ia?this.options.zoomDelta:1),this.setZoom(this._zoom+d,b)},zoomOut:function(d,b){return d=d||(Ia?this.options.zoomDelta:1),this.setZoom(this._zoom-d,b)},setZoomAround:function(d,b,c){var n=this.getZoomScale(b),a=this.getSize().divideBy(2);d=(d instanceof C?d:this.latLngToContainerPoint(d)).subtract(a).multiplyBy(1-1/n);a=this.containerPointToLatLng(a.add(d));return this.setView(a,b,{zoom:c})},_getBoundsCenterZoom:function(d,b){b=b||{};d=d.getBounds?d.getBounds():X(d);var n=G(b.paddingTopLeft||b.padding||[0,0]),c=G(b.paddingBottomRight||b.padding||[0,0]),a=this.getBoundsZoom(d,!1,n.add(c));if((a="number"==typeof b.maxZoom?Math.min(b.maxZoom,a):a)===1/0)return{center:d.getCenter(),zoom:a};var n=c.subtract(n).divideBy(2),c=this.project(d.getSouthWest(),a),l=this.project(d.getNorthEast(),a);return{center:this.unproject(c.add(l).divideBy(2).add(n),a),zoom:a}},fitBounds:function(d,b){if(!(d=X(d)).isValid())throw Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(d,b);return this.setView(n.center,n.zoom,b)},fitWorld:function(d){return this.fitBounds([[-90,-180],[90,180]],d)},panTo:function(d,b){return this.setView(d,this._zoom,{pan:b})},panBy:function(d,b){if(d=G(d).round(),b=b||{},!d.x&&!d.y)return this.fire("moveend");if(!0!==b.animate&&!this.getSize().contains(d))return this._resetView(this.unproject(this.project(this.getCenter()).add(d)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new fd,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),!1!==b.animate){K(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(d).round();this._panAnim.run(this._mapPane,n,b.duration||.25,b.easeLinearity)}else this._rawPanBy(d),this.fire("move").fire("moveend");return this},flyTo:function(d,b,c){function n(d){d=(h*h-Ka*Ka+(d?-1:1)*p*p*q*q)/(2*(d?h:Ka)*p*q);d=Math.sqrt(d*d+1)-d;return 1E-9>d?-18:Math.log(d)}function a(d){return(Math.exp(d)+Math.exp(-d))/2}function l(d){return Ka*(a(w)/a(w+k*d))}function r(d){var b=Ka,n=a(w);d=w+k*d;d=(Math.exp(d)-Math.exp(-d))/2/a(d);return b*(n*d-(Math.exp(w)-Math.exp(-w))/2)/p}function f(){var n=(Date.now()-u)/J,c=(1-Math.pow(1-n,1.5))*Fc;1>=n?(this._flyToFrame=V(f,this),this._move(this.unproject(B.add(e.subtract(B).multiplyBy(r(c)/q)),m),this.getScaleZoom(Ka/l(c),m),{flyTo:!0})):this._move(d,b)._moveEnd(!0)}if(!1===(c=c||{}).animate||!Ia)return this.setView(d,b,c);this._stop();var B=this.project(this.getCenter()),e=this.project(d),g=this.getSize(),m=this._zoom;d=O(d);b=void 0===b?m:b;var Ka=Math.max(g.x,g.y),h=Ka*this.getZoomScale(m,b),q=e.distanceTo(B)||1,k=1.42,p=k*k,w=n(0),u=Date.now(),Fc=(n(1)-w)/k,J=c.duration?1E3*c.duration:800*Fc;return this._moveStart(!0,c.noMoveStart),f.call(this),this},flyToBounds:function(d,b){var n=this._getBoundsCenterZoom(d,b);return this.flyTo(n.center,n.zoom,b)},setMaxBounds:function(d){return(d=X(d)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=d,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(d){var b=this.options.minZoom;return this.options.minZoom=d,this._loaded&&b!==d&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(d):this},setMaxZoom:function(d){var b=this.options.maxZoom;return this.options.maxZoom=d,this._loaded&&b!==d&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(d):this},panInsideBounds:function(d,b){this._enforcingBounds=!0;var n=this.getCenter(),c=this._limitCenter(n,this._zoom,X(d));return n.equals(c)||this.panTo(c,b),this._enforcingBounds=!1,this},invalidateSize:function(d){if(!this._loaded)return this;d=e({animate:!1,pan:!0},!0===d?{animate:!0}:d);var b=this.getSize();this._sizeChanged=!0;this._lastCenter=null;var c=this.getSize(),a=b.divideBy(2).round(),l=c.divideBy(2).round(),a=a.subtract(l);return a.x||a.y?(d.animate&&d.pan?this.panBy(a):(d.pan&&this._rawPanBy(a),this.fire("move"),d.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(k(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:c})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(d){if(d=this._locateOptions=e({timeout:1E4,watch:!1},d),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=k(this._handleGeolocationResponse,this),c=k(this._handleGeolocationError,this);return d.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,c,d):navigator.geolocation.getCurrentPosition(b,c,d),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(d){var b=d.code;d=d.message||(1===b?"permission denied":2===b?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:b,message:"Geolocation error: "+d+"."})},_handleGeolocationResponse:function(d){var b=new Q(d.coords.latitude,d.coords.longitude),c=b.toBounds(2*d.coords.accuracy),a=this._locateOptions;if(a.setView){var l=this.getBoundsZoom(c);this.setView(b,a.maxZoom?Math.min(l,a.maxZoom):l)}var b={latlng:b,bounds:c,timestamp:d.timestamp},r;for(r in d.coords)"number"==typeof d.coords[r]&&(b[r]=d.coords[r]);this.fire("locationfound",b)},addHandler:function(d,b){if(!b)return this;var n=this[d]=new b(this);return this._handlers.push(n),this.options[d]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(n){this._containerId=this._container._leaflet_id=void 0}void 0!==this._locationWatchId&&this.stopLocate();this._stop();ba(this._mapPane);this._clearControlPos&&this._clearControlPos();this._resizeRequest&&(aa(this._resizeRequest),this._resizeRequest=null);this._clearHandlers();this._loaded&&this.fire("unload");for(var d in this._layers)this._layers[d].remove();for(d in this._panes)ba(this._panes[d]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(d,b){var n=M("div","leaflet-pane"+(d?" leaflet-"+d.replace("Pane","")+"-pane":""),b||this._mapPane);return d&&(this._panes[d]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var d=this.getPixelBounds();return new ha(this.unproject(d.getBottomLeft()),this.unproject(d.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(d,b,c){d=X(d);c=G(c||[0,0]);var n=this.getZoom()||0,a=this.getMinZoom(),l=this.getMaxZoom(),r=d.getNorthWest();d=d.getSouthEast();c=this.getSize().subtract(c);var f=pa(this.project(d,n),this.project(r,n)).getSize(),r=Ia?this.options.zoomSnap:1;d=c.x/f.x;c=c.y/f.y;return n=this.getScaleZoom(b?Math.max(d,c):Math.min(d,c),n),r&&(n=r/100*Math.round(n/(r/100)),n=b?Math.ceil(n/r)*r:Math.floor(n/r)*r),Math.max(a,Math.min(l,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new C(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(d,b){var n=this._getTopLeftPoint(d,b);return new R(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(d){return this.options.crs.getProjectedBounds(void 0===d?this.getZoom():d)},getPane:function(d){return"string"==typeof d?this._panes[d]:d},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(d,b){var n=this.options.crs;return b=void 0===b?this._zoom:b,n.scale(d)/n.scale(b)},getScaleZoom:function(d,b){var n=this.options.crs;b=void 0===b?this._zoom:b;n=n.zoom(d*n.scale(b));return isNaN(n)?1/0:n},project:function(d,b){return b=void 0===b?this._zoom:b,this.options.crs.latLngToPoint(O(d),b)},unproject:function(d,b){return b=void 0===b?this._zoom:b,this.options.crs.pointToLatLng(G(d),b)},layerPointToLatLng:function(d){d=G(d).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(d){return this.project(O(d))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(d){return this.options.crs.wrapLatLng(O(d))},wrapLatLngBounds:function(d){return this.options.crs.wrapLatLngBounds(X(d))},distance:function(d,b){return this.options.crs.distance(O(d),O(b))},containerPointToLayerPoint:function(d){return G(d).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(d){return G(d).add(this._getMapPanePos())},containerPointToLatLng:function(d){d=this.containerPointToLayerPoint(G(d));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(d){return this.layerPointToContainerPoint(this.latLngToLayerPoint(O(d)))},mouseEventToContainerPoint:function(d){return bc(d,this._container)},mouseEventToLayerPoint:function(d){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(d))},mouseEventToLatLng:function(d){return this.layerPointToLatLng(this.mouseEventToLayerPoint(d))},_initContainer:function(d){d=this._container=Oa(d);if(!d)throw Error("Map container not found.");if(d._leaflet_id)throw Error("Map container is already initialized.");c(d,"scroll",this._onScroll,this);this._containerId=f(d)},_initLayout:function(){var d=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ia;K(d,"leaflet-container"+(Ya?" leaflet-touch":"")+(ub?" leaflet-retina":"")+(sb?" leaflet-oldie":"")+(Dc?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var b=T(d,"position");"absolute"!==b&&"relative"!==b&&"fixed"!==b&&(d.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var d=this._panes={};this._paneRenderers={};this._mapPane=this.createPane("mapPane",this._container);da(this._mapPane,new C(0,0));this.createPane("tilePane");this.createPane("shadowPane");this.createPane("overlayPane");this.createPane("markerPane");this.createPane("tooltipPane");this.createPane("popupPane");this.options.markerZoomAnimation||(K(d.markerPane,"leaflet-zoom-hide"),K(d.shadowPane,"leaflet-zoom-hide"))},_resetView:function(d,b){da(this._mapPane,new C(0,0));var n=!this._loaded;this._loaded=!0;b=this._limitZoom(b);this.fire("viewprereset");var c=this._zoom!==b;this._moveStart(c,!1)._move(d,b)._moveEnd(c);this.fire("viewreset");n&&this.fire("load")},_moveStart:function(d,b){return d&&this.fire("zoomstart"),b||this.fire("movestart"),this},_move:function(d,b,c){void 0===b&&(b=this._zoom);var n=this._zoom!==b;return this._zoom=b,this._lastCenter=d,this._pixelOrigin=this._getNewPixelOrigin(d),(n||c&&c.pinch)&&this.fire("zoom",c),this.fire("move",c)},_moveEnd:function(d){return d&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return aa(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(d){da(this._mapPane,this._getMapPanePos().subtract(d))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.");},_initEvents:function(d){this._targets={};this._targets[f(this._container)]=this;var b=d?q:c;b(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this);this.options.trackResize&&b(window,"resize",this._onResize,this);Ia&&this.options.transform3DLimit&&(d?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){aa(this._resizeRequest);this._resizeRequest=V(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0;this._container.scrollLeft=0},_onMoveEnd:function(){var d=this._getMapPanePos();Math.max(Math.abs(d.x),Math.abs(d.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(d,b){for(var n,c=[],a="mouseout"===b||"mouseover"===b,l=d.target||d.srcElement,r=!1;l;){if((n=this._targets[f(l)])&&("click"===b||"preclick"===b)&&!d._simulated&&this._draggableMoved(n)){r=!0;break}if(n&&n.listens(b,!0)){if(a&&!qa(l,d))break;if(c.push(n),a)break}if(l===this._container)break;l=l.parentNode}return c.length||r||a||!qa(l,d)||(c=[this]),c},_handleDOMEvent:function(d){if(this._loaded&&!na(d)){var b=d.type;"mousedown"!==b&&"keypress"!==b||la(d.target||d.srcElement);this._fireDOMEvent(d,b)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(d,b,c){if("click"===d.type){var n=e({},d);n.type="preclick";this._fireDOMEvent(n,n.type,c)}if(!d._stopped&&(c=(c||[]).concat(this._findEventTargets(d,b))).length){var a=c[0];"contextmenu"===b&&a.listens(b,!0)&&Y(d);n={originalEvent:d};if("keypress"!==d.type){var l=a.getLatLng&&(!a._radius||10>=a._radius);n.containerPoint=l?this.latLngToContainerPoint(a.getLatLng()):this.mouseEventToContainerPoint(d);n.layerPoint=this.containerPointToLayerPoint(n.containerPoint);n.latlng=l?a.getLatLng():this.layerPointToLatLng(n.layerPoint)}for(d=0;d<c.length&&!(c[d].fire(b,n,!0),n.originalEvent._stopped||!1===c[d].options.bubblingMouseEvents&&-1!==H(this._mouseEvents,b));d++);}},_draggableMoved:function(d){return(d=d.dragging&&d.dragging.enabled()?d:this).dragging&&d.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var d=0,b=this._handlers.length;d<b;d++)this._handlers[d].disable()},whenReady:function(d,b){return this._loaded?d.call(b||this,{target:this}):this.on("load",d,b),this},_getMapPanePos:function(){return ya(this._mapPane)||new C(0,0)},_moved:function(){var d=this._getMapPanePos();return d&&!d.equals([0,0])},_getTopLeftPoint:function(d,b){return(d&&void 0!==b?this._getNewPixelOrigin(d,b):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(d,b){var n=this.getSize()._divideBy(2);return this.project(d,b)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(d,b,c){c=this._getNewPixelOrigin(c,b);return this.project(d,b)._subtract(c)},_latLngBoundsToNewLayerBounds:function(d,b,c){c=this._getNewPixelOrigin(c,b);return pa([this.project(d.getSouthWest(),b)._subtract(c),this.project(d.getNorthWest(),b)._subtract(c),this.project(d.getSouthEast(),b)._subtract(c),this.project(d.getNorthEast(),b)._subtract(c)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(d){return this.latLngToLayerPoint(d).subtract(this._getCenterLayerPoint())},_limitCenter:function(d,b,c){if(!c)return d;var n=this.project(d,b),a=this.getSize().divideBy(2),a=new R(n.subtract(a),n.add(a));c=this._getBoundsOffset(a,c,b);return c.round().equals([0,0])?d:this.unproject(n.add(c),b)},_limitOffset:function(d,b){if(!b)return d;var n=this.getPixelBounds(),n=new R(n.min.add(d),n.max.add(d));return d.add(this._getBoundsOffset(n,b))},_getBoundsOffset:function(d,b,c){c=pa(this.project(b.getNorthEast(),c),this.project(b.getSouthWest(),c));b=c.min.subtract(d.min);d=c.max.subtract(d.max);return new C(this._rebound(b.x,-d.x),this._rebound(b.y,-d.y))},_rebound:function(d,b){return 0<d+b?Math.round(d-b)/2:Math.max(0,Math.ceil(d))-Math.max(0,Math.floor(b))},_limitZoom:function(d){var b=this.getMinZoom(),c=this.getMaxZoom(),a=Ia?this.options.zoomSnap:1;return a&&(d=Math.round(d/a)*a),Math.max(b,Math.min(c,d))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ca(this._mapPane,"leaflet-pan-anim");this.fire("moveend")},_tryAnimatedPan:function(d,b){var n=this._getCenterOffset(d)._trunc();return!(!0!==(b&&b.animate)&&!this.getSize().contains(n))&&(this.panBy(n,b),!0)},_createAnimProxy:function(){var d=this._proxy=M("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(d);this.on("zoomanim",function(d){var b=Nc,n=this._proxy.style[b];W(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1));n===this._proxy.style[b]&&this._animatingZoom&&this._onZoomTransitionEnd()},this);this.on("load moveend",function(){var d=this.getCenter(),b=this.getZoom();W(this._proxy,this.project(d,b),this.getZoomScale(b,1))},this);this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ba(this._proxy);delete this._proxy},_catchTransitionEnd:function(d){this._animatingZoom&&0<=d.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(d,b,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||!1===c.animate||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(b),n=this._getCenterOffset(d)._divideBy(1-1/n);return!(!0!==c.animate&&!this.getSize().contains(n))&&(V(function(){this._moveStart(!0,!1)._animateZoom(d,b,!0)},this),!0)},_animateZoom:function(d,b,c,a){this._mapPane&&(c&&(this._animatingZoom=!0,this._animateToCenter=d,this._animateToZoom=b,K(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:d,zoom:b,noUpdate:a}),setTimeout(k(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ca(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),V(function(){this._moveEnd(!0)},this))}}),Ua=fa.extend({options:{position:"topright"},initialize:function(d){x(this,d)},getPosition:function(){return this.options.position},setPosition:function(d){var b=this._map;return b&&b.removeControl(this),this.options.position=d,b&&b.addControl(this),this},getContainer:function(){return this._container},addTo:function(d){this.remove();this._map=d;var b=this._container=this.onAdd(d),c=this.getPosition();d=d._controlCorners[c];return K(b,"leaflet-control"),-1!==c.indexOf("bottom")?d.insertBefore(b,d.firstChild):d.appendChild(b),this},remove:function(){return this._map?(ba(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(d){this._map&&d&&0<d.screenX&&0<d.screenY&&this._map.getContainer().focus()}}),oc=function(d){return new Ua(d)};S.include({addControl:function(d){return d.addTo(this),this},removeControl:function(d){return d.remove(),this},_initControlPos:function(){function d(d,n){b[d+n]=M("div",c+d+" "+c+n,a)}var b=this._controlCorners={},c="leaflet-",a=this._controlContainer=M("div",c+"control-container",this._container);d("top","left");d("top","right");d("bottom","left");d("bottom","right")},_clearControlPos:function(){for(var d in this._controlCorners)ba(this._controlCorners[d]);ba(this._controlContainer);delete this._controlCorners;delete this._controlContainer}});var gd=Ua.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(d,b,c,a){return c<a?-1:a<c?1:0}},initialize:function(d,b,c){x(this,c);this._layerControlInputs=[];this._layers=[];this._lastZIndex=0;this._handlingClick=!1;for(var n in d)this._addLayer(d[n],n);for(n in b)this._addLayer(b[n],n,!0)},onAdd:function(d){this._initLayout();this._update();this._map=d;d.on("zoomend",this._checkDisabledLayers,this);for(d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(d){return Ua.prototype.addTo.call(this,d),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(d,b){return this._addLayer(d,b),this._map?this._update():this},addOverlay:function(d,b){return this._addLayer(d,b,!0),this._map?this._update():this},removeLayer:function(d){d.off("add remove",this._onLayerChange,this);d=this._getLayer(f(d));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){K(this._container,"leaflet-control-layers-expanded");this._form.style.height=null;var d=this._map.getSize().y-(this._container.offsetTop+50);return d<this._form.clientHeight?(K(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=d+"px"):ca(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ca(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var d=this._container=M("div","leaflet-control-layers"),b=this.options.collapsed;d.setAttribute("aria-haspopup",!0);ga(d);ua(d);var a=this._form=M("form","leaflet-control-layers-list");b&&(this._map.on("click",this.collapse,this),mb||c(d,{mouseenter:this.expand,mouseleave:this.collapse},this));var l=this._layersLink=M("a","leaflet-control-layers-toggle",d);l.href="#";l.title="Layers";Ya?(c(l,"click",ma),c(l,"click",this.expand,this)):c(l,"focus",this.expand,this);b||this.expand();this._baseLayersList=M("div","leaflet-control-layers-base",a);this._separator=M("div","leaflet-control-layers-separator",a);this._overlaysList=M("div","leaflet-control-layers-overlays",a);d.appendChild(a)},_getLayer:function(d){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&f(this._layers[b].layer)===d)return this._layers[b]},_addLayer:function(d,b,c){this._map&&d.on("add remove",this._onLayerChange,this);this._layers.push({layer:d,name:b,overlay:c});this.options.sortLayers&&this._layers.sort(k(function(d,b){return this.options.sortFunction(d.layer,b.layer,d.name,b.name)},this));this.options.autoZIndex&&d.setZIndex&&(this._lastZIndex++,d.setZIndex(this._lastZIndex));this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ha(this._baseLayersList);Ha(this._overlaysList);this._layerControlInputs=[];var d,b,c,a,l=0;for(c=0;c<this._layers.length;c++)a=this._layers[c],this._addItem(a),b=b||a.overlay,d=d||!a.overlay,l+=a.overlay?0:1;return this.options.hideSingleBase&&(d=d&&1<l,this._baseLayersList.style.display=d?"":"none"),this._separator.style.display=b&&d?"":"none",this},_onLayerChange:function(d){this._handlingClick||this._update();var b=this._getLayer(f(d.target));(d=b.overlay?"add"===d.type?"overlayadd":"overlayremove":"add"===d.type?"baselayerchange":null)&&this._map.fire(d,b)},_createRadioElement:function(d,b){var c='\x3cinput type\x3d"radio" class\x3d"leaflet-control-layers-selector" name\x3d"'+d+'"'+(b?' checked\x3d"checked"':"")+"/\x3e",n=document.createElement("div");return n.innerHTML=c,n.firstChild},_addItem:function(d){var b,a=document.createElement("label"),l=this._map.hasLayer(d.layer);d.overlay?((b=document.createElement("input")).type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=l):b=this._createRadioElement("leaflet-base-layers",l);this._layerControlInputs.push(b);b.layerId=f(d.layer);c(b,"click",this._onInputClick,this);l=document.createElement("span");l.innerHTML=" "+d.name;var r=document.createElement("div");return a.appendChild(r),r.appendChild(b),r.appendChild(l),(d.overlay?this._overlaysList:this._baseLayersList).appendChild(a),this._checkDisabledLayers(),a},_onInputClick:function(){var d,b,c=this._layerControlInputs,a=[],l=[];this._handlingClick=!0;for(var r=c.length-1;0<=r;r--)d=c[r],b=this._getLayer(d.layerId).layer,d.checked?a.push(b):d.checked||l.push(b);for(r=0;r<l.length;r++)this._map.hasLayer(l[r])&&this._map.removeLayer(l[r]);for(r=0;r<a.length;r++)this._map.hasLayer(a[r])||this._map.addLayer(a[r]);this._handlingClick=!1;this._refocusOnMap()},_checkDisabledLayers:function(){for(var d,b,c=this._layerControlInputs,a=this._map.getZoom(),l=c.length-1;0<=l;l--)d=c[l],b=this._getLayer(d.layerId).layer,d.disabled=void 0!==b.options.minZoom&&a<b.options.minZoom||void 0!==b.options.maxZoom&&a>b.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Sc=Ua.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"\x26#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(d){var b=M("div","leaflet-control-zoom leaflet-bar"),c=this.options;return this._zoomInButton=this._createButton(c.zoomInText,c.zoomInTitle,"leaflet-control-zoom-in",b,this._zoomIn),this._zoomOutButton=this._createButton(c.zoomOutText,c.zoomOutTitle,"leaflet-control-zoom-out",b,this._zoomOut),this._updateDisabled(),d.on("zoomend zoomlevelschange",this._updateDisabled,this),b},onRemove:function(d){d.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(d){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(d.shiftKey?3:1))},_zoomOut:function(d){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(d.shiftKey?3:1))},_createButton:function(d,b,a,l,r){a=M("a",a,l);return a.innerHTML=d,a.href="#",a.title=b,a.setAttribute("role","button"),a.setAttribute("aria-label",b),ga(a),c(a,"click",ma),c(a,"click",r,this),c(a,"click",this._refocusOnMap,this),a},_updateDisabled:function(){var d=this._map;ca(this._zoomInButton,"leaflet-disabled");ca(this._zoomOutButton,"leaflet-disabled");(this._disabled||d._zoom===d.getMinZoom())&&K(this._zoomOutButton,"leaflet-disabled");(this._disabled||d._zoom===d.getMaxZoom())&&K(this._zoomInButton,"leaflet-disabled")}});S.mergeOptions({zoomControl:!0});S.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Sc,this.addControl(this.zoomControl))});var hd=Ua.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(d){var b=M("div","leaflet-control-scale"),c=this.options;return this._addScales(c,"leaflet-control-scale-line",b),d.on(c.updateWhenIdle?"moveend":"move",this._update,this),d.whenReady(this._update,this),b},onRemove:function(d){d.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(d,b,c){d.metric&&(this._mScale=M("div",b,c));d.imperial&&(this._iScale=M("div",b,c))},_update:function(){var d=this._map,b=d.getSize().y/2,d=d.distance(d.containerPointToLatLng([0,b]),d.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(d)},_updateScales:function(d){this.options.metric&&d&&this._updateMetric(d);this.options.imperial&&d&&this._updateImperial(d)},_updateMetric:function(d){var b=this._getRoundNum(d);this._updateScale(this._mScale,1E3>b?b+" m":b/1E3+" km",b/d)},_updateImperial:function(d){var b,c,a;d*=3.2808399;5280<d?(b=d/5280,c=this._getRoundNum(b),this._updateScale(this._iScale,c+" mi",c/b)):(a=this._getRoundNum(d),this._updateScale(this._iScale,a+" ft",a/d))},_updateScale:function(d,b,c){d.style.width=Math.round(this.options.maxWidth*c)+"px";d.innerHTML=b},_getRoundNum:function(d){var b=Math.pow(10,(Math.floor(d)+"").length-1);d/=b;return d=10<=d?10:5<=d?5:3<=d?3:2<=d?2:1,b*d}}),Tc=Ua.extend({options:{position:"bottomright",prefix:'\x3ca href\x3d"http://leafletjs.com" title\x3d"A JS library for interactive maps"\x3eLeaflet\x3c/a\x3e'},initialize:function(d){x(this,d);this._attributions={}},onAdd:function(d){d.attributionControl=this;this._container=M("div","leaflet-control-attribution");ga(this._container);for(var b in d._layers)d._layers[b].getAttribution&&this.addAttribution(d._layers[b].getAttribution());return this._update(),this._container},setPrefix:function(d){return this.options.prefix=d,this._update(),this},addAttribution:function(d){return d?(this._attributions[d]||(this._attributions[d]=0),this._attributions[d]++,this._update(),this):this},removeAttribution:function(d){return d?(this._attributions[d]&&(this._attributions[d]--,this._update()),this):this},_update:function(){if(this._map){var d=[],b;for(b in this._attributions)this._attributions[b]&&d.push(b);b=[];this.options.prefix&&b.push(this.options.prefix);d.length&&b.push(d.join(", "));this._container.innerHTML=b.join(" | ")}}});S.mergeOptions({attributionControl:!0});S.addInitHook(function(){this.options.attributionControl&&(new Tc).addTo(this)});Ua.Layers=gd;Ua.Zoom=Sc;Ua.Scale=hd;Ua.Attribution=Tc;oc.layers=function(d,b,c){return new gd(d,b,c)};oc.zoom=function(d){return new Sc(d)};oc.scale=function(d){return new hd(d)};oc.attribution=function(d){return new Tc(d)};var ab=fa.extend({initialize:function(d){this._map=d},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ab.addTo=function(d,b){return d.addHandler(b,this),this};var ad,Ed={Events:oa},id=Ya?"touchstart mousedown":"mousedown",jd={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Uc={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},Hb=Bb.extend({options:{clickTolerance:3},initialize:function(d,b,c,a){x(this,a);this._element=d;this._dragStartTarget=b||d;this._preventOutline=c},enable:function(){this._enabled||(c(this._dragStartTarget,id,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Hb._dragging===this&&this.finishDrag(),q(this._dragStartTarget,id,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(d){if(!d._simulated&&this._enabled&&(this._moved=!1,!(Va(this._element,"leaflet-zoom-anim")||Hb._dragging||d.shiftKey||1!==d.which&&1!==d.button&&!d.touches||(Hb._dragging=this,this._preventOutline&&la(this._element),ta(),Cb(),this._moving)))){this.fire("down");var b=d.touches?d.touches[0]:d,a=fb(this._element);this._startPoint=new C(b.clientX,b.clientY);this._parentScale=Pa(a);c(document,Uc[d.type],this._onMove,this);c(document,jd[d.type],this._onUp,this)}},_onMove:function(d){if(!d._simulated&&this._enabled)if(d.touches&&1<d.touches.length)this._moved=!0;else{var b=d.touches&&1===d.touches.length?d.touches[0]:d,b=(new C(b.clientX,b.clientY))._subtract(this._startPoint);(b.x||b.y)&&(Math.abs(b.x)+Math.abs(b.y)<this.options.clickTolerance||(b.x/=this._parentScale.x,b.y/=this._parentScale.y,Y(d),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=ya(this._element).subtract(b),K(document.body,"leaflet-dragging"),this._lastTarget=d.target||d.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),K(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(b),this._moving=!0,aa(this._animRequest),this._lastEvent=d,this._animRequest=V(this._updatePosition,this,!0)))}},_updatePosition:function(){var d={originalEvent:this._lastEvent};this.fire("predrag",d);da(this._element,this._newPos);this.fire("drag",d)},_onUp:function(d){!d._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){ca(document.body,"leaflet-dragging");this._lastTarget&&(ca(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var d in Uc)q(document,Uc[d],this._onMove,this),q(document,jd[d],this._onUp,this);D();Db();this._moved&&this._moving&&(aa(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1;Hb._dragging=!1}}),Fd=(Object.freeze||Object)({simplify:nb,pointToSegmentDistance:ob,closestPointOnSegment:function(d,b,c){return yb(d,b,c)},clipSegment:ec,_getEdgeIntersection:gb,_getBitCode:$a,_sqClosestPointOnSegment:yb,isFlat:Ja,_flat:Nb}),Gd=(Object.freeze||Object)({clipPolygon:Ob}),Vc={project:function(d){return new C(d.lng,d.lat)},unproject:function(d){return new Q(d.y,d.x)},bounds:new R([-180,-90],[180,90])},Wc={R:6378137,R_MINOR:6356752.314245179,bounds:new R([-2.003750834279E7,-1.549657073972E7],[2.003750834279E7,1.876465623138E7]),project:function(d){var b=Math.PI/180,c=this.R,a=d.lat*b,l=this.R_MINOR/c,l=Math.sqrt(1-l*l),r=l*Math.sin(a);return a=-c*Math.log(Math.max(Math.tan(Math.PI/4-a/2)/Math.pow((1-r)/(1+r),l/2),1E-10)),new C(d.lng*b*c,a)},unproject:function(d){var b,c=180/Math.PI,a=this.R,l=this.R_MINOR/a,l=Math.sqrt(1-l*l),r=Math.exp(-d.y/a),f=Math.PI/2-2*Math.atan(r),e=0;for(b=.1;15>e&&1E-7<Math.abs(b);e++)b=l*Math.sin(f),b=Math.pow((1-b)/(1+b),l/2),f+=b=Math.PI/2-2*Math.atan(r*b)-f;return new Q(f*c,d.x*c/a)}},Hd=(Object.freeze||Object)({LonLat:Vc,Mercator:Wc,SphericalMercator:hc}),Id=e({},ra,{code:"EPSG:3395",projection:Wc,transformation:function(){var d=.5/(Math.PI*Wc.R);return va(d,.5,-d,.5)}()}),kd=e({},ra,{code:"EPSG:4326",projection:Vc,transformation:va(1/180,1,-1/180,.5)}),Jd=e({},Ta,{projection:Vc,transformation:va(1,0,-1,0),scale:function(d){return Math.pow(2,d)},zoom:function(d){return Math.log(d)/Math.LN2},distance:function(d,b){var c=b.lng-d.lng,n=b.lat-d.lat;return Math.sqrt(c*c+n*n)},infinite:!0});Ta.Earth=ra;Ta.EPSG3395=Id;Ta.EPSG3857=jc;Ta.EPSG900913=Rc;Ta.EPSG4326=kd;Ta.Simple=Jd;var La=Bb.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(d){return d.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(d){return d&&d.removeLayer(this),this},getPane:function(d){return this._map.getPane(d?this.options[d]||d:this.options.pane)},addInteractiveTarget:function(d){return this._map._targets[f(d)]=this,this},removeInteractiveTarget:function(d){return delete this._map._targets[f(d)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(d){var b=d.target;if(b.hasLayer(this)){if(this._map=b,this._zoomAnimated=b._zoomAnimated,this.getEvents){var c=this.getEvents();b.on(c,this);this.once("remove",function(){b.off(c,this)},this)}this.onAdd(b);this.getAttribution&&b.attributionControl&&b.attributionControl.addAttribution(this.getAttribution());this.fire("add");b.fire("layeradd",{layer:this})}}});S.include({addLayer:function(d){if(!d._layerAdd)throw Error("The provided object is not a Layer.");var b=f(d);return this._layers[b]?this:(this._layers[b]=d,d._mapToAdd=this,d.beforeAdd&&d.beforeAdd(this),this.whenReady(d._layerAdd,d),this)},removeLayer:function(d){var b=f(d);return this._layers[b]?(this._loaded&&d.onRemove(this),d.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(d.getAttribution()),delete this._layers[b],this._loaded&&(this.fire("layerremove",{layer:d}),d.fire("remove")),d._map=d._mapToAdd=null,this):this},hasLayer:function(d){return!!d&&f(d)in this._layers},eachLayer:function(d,b){for(var c in this._layers)d.call(b,this._layers[c]);return this},_addLayers:function(d){for(var b=0,c=(d=d?sa(d)?d:[d]:[]).length;b<c;b++)this.addLayer(d[b])},_addZoomLimit:function(d){!isNaN(d.options.maxZoom)&&isNaN(d.options.minZoom)||(this._zoomBoundLayers[f(d)]=d,this._updateZoomLevels())},_removeZoomLimit:function(d){d=f(d);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var d=1/0,b=-1/0,c=this._getZoomSpan(),a;for(a in this._zoomBoundLayers)var l=this._zoomBoundLayers[a].options,d=void 0===l.minZoom?d:Math.min(d,l.minZoom),b=void 0===l.maxZoom?b:Math.max(b,l.maxZoom);this._layersMaxZoom=b===-1/0?void 0:b;this._layersMinZoom=d===1/0?void 0:d;c!==this._getZoomSpan()&&this.fire("zoomlevelschange");void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom);void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Yb=La.extend({initialize:function(d,b){x(this,b);this._layers={};var c,n;if(d)for(c=0,n=d.length;c<n;c++)this.addLayer(d[c])},addLayer:function(d){var b=this.getLayerId(d);return this._layers[b]=d,this._map&&this._map.addLayer(d),this},removeLayer:function(d){d=d in this._layers?d:this.getLayerId(d);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(d){return!!d&&(d in this._layers||this.getLayerId(d)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(d){var b,c,a=Array.prototype.slice.call(arguments,1);for(b in this._layers)(c=this._layers[b])[d]&&c[d].apply(c,a);return this},onAdd:function(d){this.eachLayer(d.addLayer,d)},onRemove:function(d){this.eachLayer(d.removeLayer,d)},eachLayer:function(d,b){for(var c in this._layers)d.call(b,this._layers[c]);return this},getLayer:function(d){return this._layers[d]},getLayers:function(){var d=[];return this.eachLayer(d.push,d),d},setZIndex:function(d){return this.invoke("setZIndex",d)},getLayerId:function(d){return f(d)}}),zb=Yb.extend({addLayer:function(d){return this.hasLayer(d)?this:(d.addEventParent(this),Yb.prototype.addLayer.call(this,d),this.fire("layeradd",{layer:d}))},removeLayer:function(d){return this.hasLayer(d)?(d in this._layers&&(d=this._layers[d]),d.removeEventParent(this),Yb.prototype.removeLayer.call(this,d),this.fire("layerremove",{layer:d})):this},setStyle:function(d){return this.invoke("setStyle",d)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var d=new ha,b;for(b in this._layers){var c=this._layers[b];d.extend(c.getBounds?c.getBounds():c.getLatLng())}return d}}),Zb=fa.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(d){x(this,d)},createIcon:function(d){return this._createIcon("icon",d)},createShadow:function(d){return this._createIcon("shadow",d)},_createIcon:function(d,b){var c=this._getIconUrl(d);if(!c){if("icon"===d)throw Error("iconUrl not set in Icon options (see the docs).");return null}c=this._createImg(c,b&&"IMG"===b.tagName?b:null);return this._setIconStyles(c,d),c},_setIconStyles:function(d,b){var c=this.options,a=c[b+"Size"];"number"==typeof a&&(a=[a,a]);var a=G(a),n=G("shadow"===b&&c.shadowAnchor||c.iconAnchor||a&&a.divideBy(2,!0));d.className="leaflet-marker-"+b+" "+(c.className||"");n&&(d.style.marginLeft=-n.x+"px",d.style.marginTop=-n.y+"px");a&&(d.style.width=a.x+"px",d.style.height=a.y+"px")},_createImg:function(d,b){return b=b||document.createElement("img"),b.src=d,b},_getIconUrl:function(d){return ub&&this.options[d+"RetinaUrl"]||this.options[d+"Url"]}}),pc=Zb.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(d){return pc.imagePath||(pc.imagePath=this._detectIconPath()),(this.options.imagePath||pc.imagePath)+Zb.prototype._getIconUrl.call(this,d)},_detectIconPath:function(){var d=M("div","leaflet-default-icon-path",document.body),b=T(d,"background-image")||T(d,"backgroundImage");return document.body.removeChild(d),null===b||0!==b.indexOf("url")?"":b.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),ld=ab.extend({initialize:function(d){this._marker=d},addHooks:function(){var d=this._marker._icon;this._draggable||(this._draggable=new Hb(d,d,!0));this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable();K(d,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable();this._marker._icon&&ca(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(d){var b=this._marker,c=b._map,a=this._marker.options.autoPanSpeed,l=this._marker.options.autoPanPadding,r=ya(b._icon),f=c.getPixelBounds(),e=c.getPixelOrigin(),l=pa(f.min._subtract(e).add(l),f.max._subtract(e).subtract(l));l.contains(r)||(a=G((Math.max(l.max.x,r.x)-l.max.x)/(f.max.x-l.max.x)-(Math.min(l.min.x,r.x)-l.min.x)/(f.min.x-l.min.x),(Math.max(l.max.y,r.y)-l.max.y)/(f.max.y-l.max.y)-(Math.min(l.min.y,r.y)-l.min.y)/(f.min.y-l.min.y)).multiplyBy(a),c.panBy(a,{animate:!1}),this._draggable._newPos._add(a),this._draggable._startPos._add(a),da(b._icon,this._draggable._newPos),this._onDrag(d),this._panRequest=V(this._adjustPan.bind(this,d)))},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng();this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(d){this._marker.options.autoPan&&(aa(this._panRequest),this._panRequest=V(this._adjustPan.bind(this,d)))},_onDrag:function(d){var b=this._marker,c=b._shadow,a=ya(b._icon),l=b._map.layerPointToLatLng(a);c&&da(c,a);b._latlng=l;d.latlng=l;d.oldLatLng=this._oldLatLng;b.fire("move",d).fire("drag",d)},_onDragEnd:function(d){aa(this._panRequest);delete this._oldLatLng;this._marker.fire("moveend").fire("dragend",d)}}),fc=La.extend({options:{icon:new pc,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(d,b){x(this,b);this._latlng=O(d)},onAdd:function(d){(this._zoomAnimated=this._zoomAnimated&&d.options.markerZoomAnimation)&&d.on("zoomanim",this._animateZoom,this);this._initIcon();this.update()},onRemove:function(d){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks());delete this.dragging;this._zoomAnimated&&d.off("zoomanim",this._animateZoom,this);this._removeIcon();this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(d){var b=this._latlng;return this._latlng=O(d),this.update(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(d){return this.options.zIndexOffset=d,this.update()},setIcon:function(d){return this.options.icon=d,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var d=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(d)}return this},_initIcon:function(){var d=this.options,b="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),c=d.icon.createIcon(this._icon),a=!1;c!==this._icon&&(this._icon&&this._removeIcon(),a=!0,d.title&&(c.title=d.title),"IMG"===c.tagName&&(c.alt=d.alt||""));K(c,b);d.keyboard&&(c.tabIndex="0");this._icon=c;d.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var c=d.icon.createShadow(this._shadow),l=!1;c!==this._shadow&&(this._removeShadow(),l=!0);c&&(K(c,b),c.alt="");this._shadow=c;1>d.opacity&&this._updateOpacity();a&&this.getPane().appendChild(this._icon);this._initInteraction();c&&l&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex});ba(this._icon);this.removeInteractiveTarget(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&ba(this._shadow);this._shadow=null},_setPos:function(d){da(this._icon,d);this._shadow&&da(this._shadow,d);this._zIndex=d.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(d){this._icon.style.zIndex=this._zIndex+d},_animateZoom:function(d){null!=this._map&&(d=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center).round(),this._setPos(d))},_initInteraction:function(){if(this.options.interactive&&(K(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ld)){var d=this.options.draggable;this.dragging&&(d=this.dragging.enabled(),this.dragging.disable());this.dragging=new ld(this);d&&this.dragging.enable()}},setOpacity:function(d){return this.options.opacity=d,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var d=this.options.opacity;ka(this._icon,d);this._shadow&&ka(this._shadow,d)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),vb=La.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(d){this._renderer=d.getRenderer(this)},onAdd:function(){this._renderer._initPath(this);this._reset();this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(d){return x(this,d),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project();this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),Gc=vb.extend({options:{fill:!0,radius:10},initialize:function(d,b){x(this,b);this._latlng=O(d);this._radius=this.options.radius},setLatLng:function(d){return this._latlng=O(d),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(d){return this.options.radius=this._radius=d,this.redraw()},getRadius:function(){return this._radius},setStyle:function(d){var b=d&&d.radius||this._radius;return vb.prototype.setStyle.call(this,d),this.setRadius(b),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng);this._updateBounds()},_updateBounds:function(){var d=this._radius,b=this._radiusY||d,c=this._clickTolerance(),d=[d+c,b+c];this._pxBounds=new R(this._point.subtract(d),this._point.add(d))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(d){return d.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Xc=Gc.extend({initialize:function(d,b,c){if("number"==typeof b&&(b=e({},c,{radius:b})),x(this,b),this._latlng=O(d),isNaN(this.options.radius))throw Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(d){return this._mRadius=d,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var d=[this._radius,this._radiusY||this._radius];return new ha(this._map.layerPointToLatLng(this._point.subtract(d)),this._map.layerPointToLatLng(this._point.add(d)))},setStyle:vb.prototype.setStyle,_project:function(){var d=this._latlng.lng,b=this._latlng.lat,c=this._map,a=c.options.crs;if(a.distance===ra.distance){var l=Math.PI/180,a=this._mRadius/ra.R/l,r=c.project([b+a,d]),f=c.project([b-a,d]),f=r.add(f).divideBy(2),e=c.unproject(f).lat,l=Math.acos((Math.cos(a*l)-Math.sin(b*l)*Math.sin(e*l))/(Math.cos(b*l)*Math.cos(e*l)))/l;(isNaN(l)||0===l)&&(l=a/Math.cos(Math.PI/180*b));this._point=f.subtract(c.getPixelOrigin());this._radius=isNaN(l)?0:f.x-c.project([e,d-l]).x;this._radiusY=f.y-r.y}else d=a.unproject(a.project(this._latlng).subtract([this._mRadius,0])),this._point=c.latLngToLayerPoint(this._latlng),this._radius=this._point.x-c.latLngToLayerPoint(d).x;this._updateBounds()}}),hb=vb.extend({options:{smoothFactor:1,noClip:!1},initialize:function(d,b){x(this,b);this._setLatLngs(d)},getLatLngs:function(){return this._latlngs},setLatLngs:function(d){return this._setLatLngs(d),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(d){for(var b,c,a=1/0,l=null,r=yb,f=0,e=this._parts.length;f<e;f++)for(var g=this._parts[f],m=1,Ka=g.length;m<Ka;m++){var h=r(d,b=g[m-1],c=g[m],!0);h<a&&(a=h,l=r(d,b,c))}return l&&(l.distance=Math.sqrt(a)),l},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var d,b,c,a,l,r,f,e=this._rings[0],g=e.length;if(!g)return null;for(b=d=0;d<g-1;d++)b+=e[d].distanceTo(e[d+1])/2;if(0===b)return this._map.layerPointToLatLng(e[0]);for(a=d=0;d<g-1;d++)if(l=e[d],r=e[d+1],c=l.distanceTo(r),(a+=c)>b)return f=(a-b)/c,this._map.layerPointToLatLng([r.x-f*(r.x-l.x),r.y-f*(r.y-l.y)])},getBounds:function(){return this._bounds},addLatLng:function(d,b){return b=b||this._defaultShape(),d=O(d),b.push(d),this._bounds.extend(d),this.redraw()},_setLatLngs:function(d){this._bounds=new ha;this._latlngs=this._convertLatLngs(d)},_defaultShape:function(){return Ja(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(d){for(var b=[],c=Ja(d),a=0,l=d.length;a<l;a++)c?(b[a]=O(d[a]),this._bounds.extend(b[a])):b[a]=this._convertLatLngs(d[a]);return b},_project:function(){var d=new R;this._rings=[];this._projectLatlngs(this._latlngs,this._rings,d);var b=this._clickTolerance(),b=new C(b,b);this._bounds.isValid()&&d.isValid()&&(d.min._subtract(b),d.max._add(b),this._pxBounds=d)},_projectLatlngs:function(d,b,c){var a,n,l=d.length;if(d[0]instanceof Q){n=[];for(a=0;a<l;a++)n[a]=this._map.latLngToLayerPoint(d[a]),c.extend(n[a]);b.push(n)}else for(a=0;a<l;a++)this._projectLatlngs(d[a],b,c)},_clipPoints:function(){var d=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(d))if(this.options.noClip)this._parts=this._rings;else{var b,c,a,l,r,f,e,g=this._parts;a=b=0;for(l=this._rings.length;b<l;b++)for(c=0,r=(e=this._rings[b]).length;c<r-1;c++)(f=ec(e[c],e[c+1],d,c,!0))&&(g[a]=g[a]||[],g[a].push(f[0]),f[1]===e[c+1]&&c!==r-2||(g[a].push(f[1]),a++))}},_simplifyPoints:function(){for(var d=this._parts,b=this.options.smoothFactor,c=0,a=d.length;c<a;c++)d[c]=nb(d[c],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(d,b){var c,a,n,l,r,f,e=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(d))return!1;c=0;for(l=this._parts.length;c<l;c++)for(a=0,n=(r=(f=this._parts[c]).length)-1;a<r;n=a++)if((b||0!==a)&&ob(d,f[n],f[a])<=e)return!0;return!1}});hb._flat=Nb;var Rb=hb.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var d,b,c,a,l,r,f,e,g=this._rings[0],m=g.length;if(!m)return null;d=l=r=f=0;for(b=m-1;d<m;b=d++)c=g[d],b=g[b],a=c.y*b.x-b.y*c.x,r+=(c.x+b.x)*a,f+=(c.y+b.y)*a,l+=3*a;return e=0===l?g[0]:[r/l,f/l],this._map.layerPointToLatLng(e)},_convertLatLngs:function(d){d=hb.prototype._convertLatLngs.call(this,d);var b=d.length;return 2<=b&&d[0]instanceof Q&&d[0].equals(d[b-1])&&d.pop(),d},_setLatLngs:function(d){hb.prototype._setLatLngs.call(this,d);Ja(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ja(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var d=this._renderer._bounds,b=this.options.weight,b=new C(b,b);if(d=new R(d.min.subtract(b),d.max.add(b)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(d))if(this.options.noClip)this._parts=this._rings;else for(var c,b=0,a=this._rings.length;b<a;b++)(c=Ob(this._rings[b],d,!0)).length&&this._parts.push(c)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(d){var b,c,a,l,r,f,e,g=!1;if(!this._pxBounds||!this._pxBounds.contains(d))return!1;l=0;for(f=this._parts.length;l<f;l++)for(r=0,a=(e=(b=this._parts[l]).length)-1;r<e;a=r++)c=b[r],a=b[a],c.y>d.y!=a.y>d.y&&d.x<(a.x-c.x)*(d.y-c.y)/(a.y-c.y)+c.x&&(g=!g);return g||hb.prototype._containsPoint.call(this,d,!0)}}),ib=zb.extend({initialize:function(d,b){x(this,b);this._layers={};d&&this.addData(d)},addData:function(d){var b,c,a=sa(d)?d:d.features;if(a){d=0;for(b=a.length;d<b;d++)((c=a[d]).geometries||c.geometry||c.features||c.coordinates)&&this.addData(c);return this}c=this.options;return c.filter&&!c.filter(d)?this:(a=Pb(d,c))?(a.feature=Tb(d),a.defaultOptions=a.options,this.resetStyle(a),c.onEachFeature&&c.onEachFeature(d,a),this.addLayer(a)):this},resetStyle:function(d){return d.options=e({},d.defaultOptions),this._setLayerStyle(d,this.options.style),this},setStyle:function(d){return this.eachLayer(function(b){this._setLayerStyle(b,d)},this)},_setLayerStyle:function(d,b){"function"==typeof b&&(b=b(d.feature));d.setStyle&&d.setStyle(b)}}),Yc={toGeoJSON:function(d){return qb(this,{type:"Point",coordinates:Ab(this.getLatLng(),d)})}};fc.include(Yc);Xc.include(Yc);Gc.include(Yc);hb.include({toGeoJSON:function(d){var b=!Ja(this._latlngs);d=Sb(this._latlngs,b?1:0,!1,d);return qb(this,{type:(b?"Multi":"")+"LineString",coordinates:d})}});Rb.include({toGeoJSON:function(d){var b=!Ja(this._latlngs),c=b&&!Ja(this._latlngs[0]);d=Sb(this._latlngs,c?2:b?1:0,!0,d);return b||(d=[d]),qb(this,{type:(c?"Multi":"")+"Polygon",coordinates:d})}});Yb.include({toMultiPoint:function(d){var b=[];return this.eachLayer(function(c){b.push(c.toGeoJSON(d).geometry.coordinates)}),qb(this,{type:"MultiPoint",coordinates:b})},toGeoJSON:function(d){var b=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===b)return this.toMultiPoint(d);var c="GeometryCollection"===b,a=[];return this.eachLayer(function(b){b.toGeoJSON&&(b=b.toGeoJSON(d),c?a.push(b.geometry):(b=Tb(b),"FeatureCollection"===b.type?a.push.apply(a,b.features):a.push(b)))}),c?qb(this,{geometries:a,type:"GeometryCollection"}):{type:"FeatureCollection",features:a}}});var Zc=La.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(d,b,c){this._url=d;this._bounds=X(b);x(this,c)},onAdd:function(){this._image||(this._initImage(),1>this.options.opacity&&this._updateOpacity());this.options.interactive&&(K(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image));this.getPane().appendChild(this._image);this._reset()},onRemove:function(){ba(this._image);this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(d){return this.options.opacity=d,this._image&&this._updateOpacity(),this},setStyle:function(d){return d.opacity&&this.setOpacity(d.opacity),this},bringToFront:function(){return this._map&&Ea(this._image),this},bringToBack:function(){return this._map&&xa(this._image),this},setUrl:function(d){return this._url=d,this._image&&(this._image.src=d),this},setBounds:function(d){return this._bounds=X(d),this._map&&this._reset(),this},getEvents:function(){var d={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},setZIndex:function(d){return this.options.zIndex=d,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var d="IMG"===this._url.tagName,b=this._image=d?this._url:M("img");K(b,"leaflet-image-layer");this._zoomAnimated&&K(b,"leaflet-zoom-animated");this.options.className&&K(b,this.options.className);b.onselectstart=g;b.onmousemove=g;b.onload=k(this.fire,this,"load");b.onerror=k(this._overlayOnError,this,"error");(this.options.crossOrigin||""===this.options.crossOrigin)&&(b.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin);this.options.zIndex&&this._updateZIndex();d?this._url=b.src:(b.src=this._url,b.alt=this.options.alt)},_animateZoom:function(d){var b=this._map.getZoomScale(d.zoom);d=this._map._latLngBoundsToNewLayerBounds(this._bounds,d.zoom,d.center).min;W(this._image,d,b)},_reset:function(){var d=this._image,b=new R(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),c=b.getSize();da(d,b.min);d.style.width=c.x+"px";d.style.height=c.y+"px"},_updateOpacity:function(){ka(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var d=this.options.errorOverlayUrl;d&&this._url!==d&&(this._url=d,this._image.src=d)}}),md=Zc.extend({options:{autoplay:!0,loop:!0},_initImage:function(){var d="VIDEO"===this._url.tagName,b=this._image=d?this._url:M("video");if(K(b,"leaflet-image-layer"),this._zoomAnimated&&K(b,"leaflet-zoom-animated"),b.onselectstart=g,b.onmousemove=g,b.onloadeddata=k(this.fire,this,"load"),d){for(var d=b.getElementsByTagName("source"),c=[],a=0;a<d.length;a++)c.push(d[a].src);this._url=0<d.length?c:[b.src]}else for(sa(this._url)||(this._url=[this._url]),b.autoplay=!!this.options.autoplay,b.loop=!!this.options.loop,d=0;d<this._url.length;d++)c=M("source"),c.src=this._url[d],b.appendChild(c)}}),jb=La.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(d,b){x(this,d);this._source=b},onAdd:function(d){this._zoomAnimated=d._zoomAnimated;this._container||this._initLayout();d._fadeAnimated&&ka(this._container,0);clearTimeout(this._removeTimeout);this.getPane().appendChild(this._container);this.update();d._fadeAnimated&&ka(this._container,1);this.bringToFront()},onRemove:function(d){d._fadeAnimated?(ka(this._container,0),this._removeTimeout=setTimeout(k(ba,void 0,this._container),200)):ba(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(d){return this._latlng=O(d),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(d){return this._content=d,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var d={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ea(this._container),this},bringToBack:function(){return this._map&&xa(this._container),this},_updateContent:function(){if(this._content){var d=this._contentNode,b="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof b)d.innerHTML=b;else{for(;d.hasChildNodes();)d.removeChild(d.firstChild);d.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var d=this._map.latLngToLayerPoint(this._latlng),b=G(this.options.offset),c=this._getAnchor();this._zoomAnimated?da(this._container,d.add(c)):b=b.add(d).add(c);d=this._containerBottom=-b.y;b=this._containerLeft=-Math.round(this._containerWidth/2)+b.x;this._container.style.bottom=d+"px";this._container.style.left=b+"px"}},_getAnchor:function(){return[0,0]}}),$b=jb.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(d){return d.openPopup(this),this},onAdd:function(d){jb.prototype.onAdd.call(this,d);d.fire("popupopen",{popup:this});this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof vb||this._source.on("preclick",N))},onRemove:function(d){jb.prototype.onRemove.call(this,d);d.fire("popupclose",{popup:this});this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof vb||this._source.off("preclick",N))},getEvents:function(){var d=jb.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(d.preclick=this._close),this.options.keepInView&&(d.moveend=this._adjustPan),d},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var d=this._container=M("div","leaflet-popup "+(this.options.className||"")+" leaflet-zoom-animated"),b=this._wrapper=M("div","leaflet-popup-content-wrapper",d);if(this._contentNode=M("div","leaflet-popup-content",b),ga(b),ua(this._contentNode),c(b,"contextmenu",N),this._tipContainer=M("div","leaflet-popup-tip-container",d),this._tip=M("div","leaflet-popup-tip",this._tipContainer),this.options.closeButton)d=this._closeButton=M("a","leaflet-popup-close-button",d),d.href="#close",d.innerHTML="\x26#215;",c(d,"click",this._onCloseButtonClick,this)},_updateLayout:function(){var d=this._contentNode,b=d.style;b.width="";b.whiteSpace="nowrap";var c=d.offsetWidth,c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth);b.width=c+1+"px";b.whiteSpace="";b.height="";var c=d.offsetHeight,a=this.options.maxHeight;a&&c>a?(b.height=a+"px",K(d,"leaflet-popup-scrolled")):ca(d,"leaflet-popup-scrolled");this._containerWidth=this._container.offsetWidth},_animateZoom:function(d){d=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center);var b=this._getAnchor();da(this._container,d.add(b))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var d=this._map,b=parseInt(T(this._container,"marginBottom"),10)||0,b=this._container.offsetHeight+b,c=this._containerWidth,a=new C(this._containerLeft,-b-this._containerBottom);a._add(ya(this._container));var a=d.layerPointToContainerPoint(a),l=G(this.options.autoPanPadding),r=G(this.options.autoPanPaddingTopLeft||l),l=G(this.options.autoPanPaddingBottomRight||l),f=d.getSize(),e=0,g=0;a.x+c+l.x>f.x&&(e=a.x+c-f.x+l.x);0>a.x-e-r.x&&(e=a.x-r.x);a.y+b+l.y>f.y&&(g=a.y+b-f.y+l.y);0>a.y-g-r.y&&(g=a.y-r.y);(e||g)&&d.fire("autopanstart").panBy([e,g])}},_onCloseButtonClick:function(d){this._close();ma(d)},_getAnchor:function(){return G(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});S.mergeOptions({closePopupOnClick:!0});S.include({openPopup:function(d,b,c){return d instanceof $b||(d=(new $b(c)).setContent(d)),b&&d.setLatLng(b),this.hasLayer(d)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=d,this.addLayer(d))},closePopup:function(d){return d&&d!==this._popup||(d=this._popup,this._popup=null),d&&this.removeLayer(d),this}});La.include({bindPopup:function(d,b){return d instanceof $b?(x(d,b),this._popup=d,d._source=this):(this._popup&&!b||(this._popup=new $b(b,this)),this._popup.setContent(d)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(d,b){if(d instanceof La||(b=d,d=this),d instanceof zb)for(var c in this._layers){d=this._layers[c];break}return b||(b=d.getCenter?d.getCenter():d.getLatLng()),this._popup&&this._map&&(this._popup._source=d,this._popup.update(),this._map.openPopup(this._popup,b)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(d){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(d)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(d){return this._popup&&this._popup.setContent(d),this},getPopup:function(){return this._popup},_openPopup:function(d){var b=d.layer||d.target;this._popup&&this._map&&(ma(d),b instanceof vb?this.openPopup(d.layer||d.target,d.latlng):this._map.hasLayer(this._popup)&&this._popup._source===b?this.closePopup():this.openPopup(b,d.latlng))},_movePopup:function(d){this._popup.setLatLng(d.latlng)},_onKeyPress:function(d){13===d.originalEvent.keyCode&&this._openPopup(d)}});var ac=jb.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(d){jb.prototype.onAdd.call(this,d);this.setOpacity(this.options.opacity);d.fire("tooltipopen",{tooltip:this});this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(d){jb.prototype.onRemove.call(this,d);d.fire("tooltipclose",{tooltip:this});this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var d=jb.prototype.getEvents.call(this);return Ya&&!this.options.permanent&&(d.preclick=this._close),d},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){this._contentNode=this._container=M("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(d){var b=this._map,c=this._container,a=b.latLngToContainerPoint(b.getCenter()),b=b.layerPointToContainerPoint(d),l=this.options.direction,r=c.offsetWidth,f=c.offsetHeight,e=G(this.options.offset),g=this._getAnchor();"top"===l?d=d.add(G(-r/2+e.x,-f+e.y+g.y,!0)):"bottom"===l?d=d.subtract(G(r/2-e.x,-e.y,!0)):"center"===l?d=d.subtract(G(r/2+e.x,f/2-g.y+e.y,!0)):"right"===l||"auto"===l&&b.x<a.x?(l="right",d=d.add(G(e.x+g.x,g.y-f/2+e.y,!0))):(l="left",d=d.subtract(G(r+g.x-e.x,f/2-g.y-e.y,!0)));ca(c,"leaflet-tooltip-right");ca(c,"leaflet-tooltip-left");ca(c,"leaflet-tooltip-top");ca(c,"leaflet-tooltip-bottom");K(c,"leaflet-tooltip-"+l);da(c,d)},_updatePosition:function(){var d=this._map.latLngToLayerPoint(this._latlng);this._setPosition(d)},setOpacity:function(d){this.options.opacity=d;this._container&&ka(this._container,d)},_animateZoom:function(d){d=this._map._latLngToNewLayerPoint(this._latlng,d.zoom,d.center);this._setPosition(d)},_getAnchor:function(){return G(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});S.include({openTooltip:function(d,b,c){return d instanceof ac||(d=(new ac(c)).setContent(d)),b&&d.setLatLng(b),this.hasLayer(d)?this:this.addLayer(d)},closeTooltip:function(d){return d&&this.removeLayer(d),this}});La.include({bindTooltip:function(d,b){return d instanceof ac?(x(d,b),this._tooltip=d,d._source=this):(this._tooltip&&!b||(this._tooltip=new ac(b,this)),this._tooltip.setContent(d)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(d){if(d||!this._tooltipHandlersAdded){var b={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?b.add=this._openTooltip:(b.mouseover=this._openTooltip,b.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(b.mousemove=this._moveTooltip),Ya&&(b.click=this._openTooltip));this[d?"off":"on"](b);this._tooltipHandlersAdded=!d}},openTooltip:function(d,b){if(d instanceof La||(b=d,d=this),d instanceof zb)for(var c in this._layers){d=this._layers[c];break}return b||(b=d.getCenter?d.getCenter():d.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=d,this._tooltip.update(),this._map.openTooltip(this._tooltip,b),this._tooltip.options.interactive&&this._tooltip._container&&(K(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(ca(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(d){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(d)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(d){return this._tooltip&&this._tooltip.setContent(d),this},getTooltip:function(){return this._tooltip},_openTooltip:function(d){var b=d.layer||d.target;this._tooltip&&this._map&&this.openTooltip(b,this._tooltip.options.sticky?d.latlng:void 0)},_moveTooltip:function(d){var b,c,a=d.latlng;this._tooltip.options.sticky&&d.originalEvent&&(b=this._map.mouseEventToContainerPoint(d.originalEvent),c=this._map.containerPointToLayerPoint(b),a=this._map.layerPointToLatLng(c));this._tooltip.setLatLng(a)}});var nd=Zb.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(d){d=d&&"DIV"===d.tagName?d:document.createElement("div");var b=this.options;if(d.innerHTML=!1!==b.html?b.html:"",b.bgPos)b=G(b.bgPos),d.style.backgroundPosition=-b.x+"px "+-b.y+"px";return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});Zb.Default=pc;var qc=La.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Xb,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(d){x(this,d)},onAdd:function(){this._initContainer();this._levels={};this._tiles={};this._resetView();this._update()},beforeAdd:function(d){d._addZoomLimit(this)},onRemove:function(d){this._removeAllTiles();ba(this._container);d._removeZoomLimit(this);this._container=null;this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ea(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(xa(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(d){return this.options.opacity=d,this._updateOpacity(),this},setZIndex:function(d){return this.options.zIndex=d,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var d={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),d.move=this._onMove),this._zoomAnimated&&(d.zoomanim=this._animateZoom),d},createTile:function(){return document.createElement("div")},getTileSize:function(){var d=this.options.tileSize;return d instanceof C?d:new C(d,d)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(d){for(var b,c=this.getPane().children,a=-d(-1/0,1/0),l=0,r=c.length;l<r;l++)b=c[l].style.zIndex,c[l]!==this._container&&b&&(a=d(a,+b));isFinite(a)&&(this.options.zIndex=a+d(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!sb){ka(this._container,this.options.opacity);var d=+new Date,b=!1,c=!1,a;for(a in this._tiles){var l=this._tiles[a];if(l.current&&l.loaded){var r=Math.min(1,(d-l.loaded)/200);ka(l.el,r);1>r?b=!0:(l.active?c=!0:this._onOpaqueTile(l),l.active=!0)}}c&&!this._noPrune&&this._pruneTiles();b&&(aa(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=M("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),1>this.options.opacity&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var d=this._tileZoom,b=this.options.maxZoom;if(void 0!==d){for(var c in this._levels)this._levels[c].el.children.length||c===d?(this._levels[c].el.style.zIndex=b-Math.abs(d-c),this._onUpdateLevel(c)):(ba(this._levels[c].el),this._removeTilesAtZoom(c),this._onRemoveLevel(c),delete this._levels[c]);c=this._levels[d];var a=this._map;return c||((c=this._levels[d]={}).el=M("div","leaflet-tile-container leaflet-zoom-animated",this._container),c.el.style.zIndex=b,c.origin=a.project(a.unproject(a.getPixelOrigin()),d).round(),c.zoom=d,this._setZoomTransform(c,a.getCenter(),a.getZoom()),c.el.offsetWidth,this._onCreateLevel(c)),this._level=c,c}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var d,b,c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom)this._removeAllTiles();else{for(d in this._tiles)(b=this._tiles[d]).retain=b.current;for(d in this._tiles)(b=this._tiles[d]).current&&!b.active&&(c=b.coords,this._retainParent(c.x,c.y,c.z,c.z-5)||this._retainChildren(c.x,c.y,c.z,c.z+2));for(d in this._tiles)this._tiles[d].retain||this._removeTile(d)}}},_removeTilesAtZoom:function(d){for(var b in this._tiles)this._tiles[b].coords.z===d&&this._removeTile(b)},_removeAllTiles:function(){for(var d in this._tiles)this._removeTile(d)},_invalidateAll:function(){for(var d in this._levels)ba(this._levels[d].el),this._onRemoveLevel(d),delete this._levels[d];this._removeAllTiles();this._tileZoom=void 0},_retainParent:function(d,b,c,a){d=Math.floor(d/2);b=Math.floor(b/2);--c;var l=new C(+d,+b);l.z=+c;l=this._tileCoordsToKey(l);return(l=this._tiles[l])&&l.active?(l.retain=!0,!0):(l&&l.loaded&&(l.retain=!0),c>a&&this._retainParent(d,b,c,a))},_retainChildren:function(d,b,c,a){for(var l=2*d;l<2*d+2;l++)for(var r=2*b;r<2*b+2;r++){var n=new C(l,r);n.z=c+1;n=this._tileCoordsToKey(n);(n=this._tiles[n])&&n.active?n.retain=!0:(n&&n.loaded&&(n.retain=!0),c+1<a&&this._retainChildren(l,r,c+1,a))}},_resetView:function(d){d=d&&(d.pinch||d.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(d){this._setView(d.center,d.zoom,!0,d.noUpdate)},_clampZoom:function(d){var b=this.options;return void 0!==b.minNativeZoom&&d<b.minNativeZoom?b.minNativeZoom:void 0!==b.maxNativeZoom&&b.maxNativeZoom<d?b.maxNativeZoom:d},_setView:function(d,b,c,a){var l=this._clampZoom(Math.round(b));(void 0!==this.options.maxZoom&&l>this.options.maxZoom||void 0!==this.options.minZoom&&l<this.options.minZoom)&&(l=void 0);var r=this.options.updateWhenZooming&&l!==this._tileZoom;a&&!r||(this._tileZoom=l,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==l&&this._update(d),c||this._pruneTiles(),this._noPrune=!!c);this._setZoomTransforms(d,b)},_setZoomTransforms:function(d,b){for(var c in this._levels)this._setZoomTransform(this._levels[c],d,b)},_setZoomTransform:function(d,b,c){var a=this._map.getZoomScale(c,d.zoom);b=d.origin.multiplyBy(a).subtract(this._map._getNewPixelOrigin(b,c)).round();Ia?W(d.el,b,a):da(d.el,b)},_resetGrid:function(){var d=this._map,b=d.options.crs,c=this._tileSize=this.getTileSize(),a=this._tileZoom,l=this._map.getPixelWorldBounds(this._tileZoom);l&&(this._globalTileRange=this._pxBoundsToTileRange(l));this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(d.project([0,b.wrapLng[0]],a).x/c.x),Math.ceil(d.project([0,b.wrapLng[1]],a).x/c.y)];this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(d.project([b.wrapLat[0],0],a).y/c.x),Math.ceil(d.project([b.wrapLat[1],0],a).y/c.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(d){var b=this._map,c=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),c=b.getZoomScale(c,this._tileZoom);d=b.project(d,this._tileZoom).floor();b=b.getSize().divideBy(2*c);return new R(d.subtract(b),d.add(b))},_update:function(d){var b=this._map;if(b){var c=this._clampZoom(b.getZoom());if(void 0===d&&(d=b.getCenter()),void 0!==this._tileZoom){var b=this._getTiledPixelBounds(d),a=this._pxBoundsToTileRange(b),l=a.getCenter(),b=[],r=this.options.keepBuffer,r=new R(a.getBottomLeft().subtract([r,-r]),a.getTopRight().add([r,-r]));if(!(isFinite(a.min.x)&&isFinite(a.min.y)&&isFinite(a.max.x)&&isFinite(a.max.y)))throw Error("Attempted to load an infinite number of tiles");for(var f in this._tiles){var e=this._tiles[f].coords;e.z===this._tileZoom&&r.contains(new C(e.x,e.y))||(this._tiles[f].current=!1)}if(1<Math.abs(c-this._tileZoom))this._setView(d,c);else{for(c=a.min.y;c<=a.max.y;c++)for(d=a.min.x;d<=a.max.x;d++)if(f=new C(d,c),f.z=this._tileZoom,this._isValidTile(f))(r=this._tiles[this._tileCoordsToKey(f)])?r.current=!0:b.push(f);if(b.sort(function(d,b){return d.distanceTo(l)-b.distanceTo(l)}),0!==b.length){this._loading||(this._loading=!0,this.fire("loading"));a=document.createDocumentFragment();for(d=0;d<b.length;d++)this._addTile(b[d],a);this._level.el.appendChild(a)}}}}},_isValidTile:function(d){var b=this._map.options.crs;if(!b.infinite){var c=this._globalTileRange;if(!b.wrapLng&&(d.x<c.min.x||d.x>c.max.x)||!b.wrapLat&&(d.y<c.min.y||d.y>c.max.y))return!1}if(!this.options.bounds)return!0;d=this._tileCoordsToBounds(d);return X(this.options.bounds).overlaps(d)},_keyToBounds:function(d){return this._tileCoordsToBounds(this._keyToTileCoords(d))},_tileCoordsToNwSe:function(d){var b=this._map,c=this.getTileSize(),a=d.scaleBy(c),c=a.add(c);return[b.unproject(a,d.z),b.unproject(c,d.z)]},_tileCoordsToBounds:function(d){d=this._tileCoordsToNwSe(d);d=new ha(d[0],d[1]);return this.options.noWrap||(d=this._map.wrapLatLngBounds(d)),d},_tileCoordsToKey:function(d){return d.x+":"+d.y+":"+d.z},_keyToTileCoords:function(d){d=d.split(":");var b=new C(+d[0],+d[1]);return b.z=+d[2],b},_removeTile:function(d){var b=this._tiles[d];b&&(ba(b.el),delete this._tiles[d],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(d)}))},_initTile:function(d){K(d,"leaflet-tile");var b=this.getTileSize();d.style.width=b.x+"px";d.style.height=b.y+"px";d.onselectstart=g;d.onmousemove=g;sb&&1>this.options.opacity&&ka(d,this.options.opacity);mb&&!Eb&&(d.style.WebkitBackfaceVisibility="hidden")},_addTile:function(d,b){var c=this._getTilePos(d),a=this._tileCoordsToKey(d),l=this.createTile(this._wrapCoords(d),k(this._tileReady,this,d));this._initTile(l);2>this.createTile.length&&V(k(this._tileReady,this,d,null,l));da(l,c);this._tiles[a]={el:l,coords:d,current:!0};b.appendChild(l);this.fire("tileloadstart",{tile:l,coords:d})},_tileReady:function(d,b,c){b&&this.fire("tileerror",{error:b,tile:c,coords:d});var a=this._tileCoordsToKey(d);(c=this._tiles[a])&&(c.loaded=+new Date,this._map._fadeAnimated?(ka(c.el,0),aa(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this)):(c.active=!0,this._pruneTiles()),b||(K(c.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:c.el,coords:d})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),sb||!this._map._fadeAnimated?V(this._pruneTiles,this):setTimeout(k(this._pruneTiles,this),250)))},_getTilePos:function(d){return d.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(d){var b=new C(this._wrapX?m(d.x,this._wrapX):d.x,this._wrapY?m(d.y,this._wrapY):d.y);return b.z=d.z,b},_pxBoundsToTileRange:function(d){var b=this.getTileSize();return new R(d.min.unscaleBy(b).floor(),d.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var d in this._tiles)if(!this._tiles[d].loaded)return!1;return!0}}),Ub=qc.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(d,b){this._url=d;(b=x(this,b)).detectRetina&&ub&&0<b.maxZoom&&(b.tileSize=Math.floor(b.tileSize/2),b.zoomReverse?(b.zoomOffset--,b.minZoom++):(b.zoomOffset++,b.maxZoom--),b.minZoom=Math.max(0,b.minZoom));"string"==typeof b.subdomains&&(b.subdomains=b.subdomains.split(""));mb||this.on("tileunload",this._onTileRemove)},setUrl:function(d,b){return this._url=d,b||this.redraw(),this},createTile:function(d,b){var a=document.createElement("img");return c(a,"load",k(this._tileOnLoad,this,b,a)),c(a,"error",k(this._tileOnError,this,b,a)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(a.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),a.alt="",a.setAttribute("role","presentation"),a.src=this.getTileUrl(d),a},getTileUrl:function(d){var b={r:ub?"@2x":"",s:this._getSubdomain(d),x:d.x,y:d.y,z:this._getZoomForUrl()};this._map&&!this._map.options.crs.infinite&&(d=this._globalTileRange.max.y-d.y,this.options.tms&&(b.y=d),b["-y"]=d);return z(this._url,e(b,this.options))},_tileOnLoad:function(d,b){sb?setTimeout(k(d,this,null,b),0):d(null,b)},_tileOnError:function(d,b,c){var a=this.options.errorTileUrl;a&&b.getAttribute("src")!==a&&(b.src=a);d(c,b)},_onTileRemove:function(d){d.tile.onload=null},_getZoomForUrl:function(){var d=this._tileZoom,b=this.options.maxZoom,c=this.options.zoomOffset;return this.options.zoomReverse&&(d=b-d),d+c},_getSubdomain:function(d){return this.options.subdomains[Math.abs(d.x+d.y)%this.options.subdomains.length]},_abortLoading:function(){var d,b;for(d in this._tiles)this._tiles[d].coords.z!==this._tileZoom&&((b=this._tiles[d].el).onload=g,b.onerror=g,b.complete||(b.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d",ba(b),delete this._tiles[d]))},_removeTile:function(d){var b=this._tiles[d];if(b)return Cc||b.el.setAttribute("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d"),qc.prototype._removeTile.call(this,d)},_tileReady:function(d,b,c){if(this._map&&(!c||"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d"!==c.getAttribute("src")))return qc.prototype._tileReady.call(this,d,b,c)}}),od=Ub.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(d,b){this._url=d;var c=e({},this.defaultWmsParams),a;for(a in b)a in this.options||(c[a]=b[a]);a=x(this,b).detectRetina&&ub?2:1;var l=this.getTileSize();c.width=l.x*a;c.height=l.y*a;this.wmsParams=c},onAdd:function(d){this._crs=this.options.crs||d.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code;Ub.prototype.onAdd.call(this,d)},getTileUrl:function(d){var b=this._tileCoordsToNwSe(d),c=this._crs,c=pa(c.project(b[0]),c.project(b[1])),b=c.min,c=c.max,b=(1.3<=this._wmsVersion&&this._crs===kd?[b.y,b.x,c.y,c.x]:[b.x,b.y,c.x,c.y]).join(",");d=Ub.prototype.getTileUrl.call(this,d);return d+E(this.wmsParams,d,this.options.uppercase)+(this.options.uppercase?"\x26BBOX\x3d":"\x26bbox\x3d")+b},setParams:function(d,b){return e(this.wmsParams,d),b||this.redraw(),this}});Ub.WMS=od;xc.wms=function(d,b){return new od(d,b)};var bb=La.extend({options:{padding:.1,tolerance:0},initialize:function(d){x(this,d);f(this);this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&K(this._container,"leaflet-zoom-animated"));this.getPane().appendChild(this._container);this._update();this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this);this._destroyContainer()},getEvents:function(){var d={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(d.zoomanim=this._onAnimZoom),d},_onAnimZoom:function(d){this._updateTransform(d.center,d.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(d,b){var c=this._map.getZoomScale(b,this._zoom),a=ya(this._container),l=this._map.getSize().multiplyBy(.5+this.options.padding),r=this._map.project(this._center,b),r=this._map.project(d,b).subtract(r),a=l.multiplyBy(-c).add(a).add(l).subtract(r);Ia?W(this._container,a,c):da(this._container,a)},_reset:function(){this._update();this._updateTransform(this._center,this._zoom);for(var d in this._layers)this._layers[d]._reset()},_onZoomEnd:function(){for(var d in this._layers)this._layers[d]._project()},_updatePaths:function(){for(var d in this._layers)this._layers[d]._update()},_update:function(){var d=this.options.padding,b=this._map.getSize(),c=this._map.containerPointToLayerPoint(b.multiplyBy(-d)).round();this._bounds=new R(c,c.add(b.multiplyBy(1+2*d)).round());this._center=this._map.getCenter();this._zoom=this._map.getZoom()}}),cd=bb.extend({getEvents:function(){var d=bb.prototype.getEvents.call(this);return d.viewprereset=this._onViewPreReset,d},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){bb.prototype.onAdd.call(this);this._draw()},_initContainer:function(){var d=this._container=document.createElement("canvas");c(d,"mousemove",h(this._onMouseMove,32,this),this);c(d,"click dblclick mousedown mouseup contextmenu",this._onClick,this);c(d,"mouseout",this._handleMouseOut,this);this._ctx=d.getContext("2d")},_destroyContainer:function(){aa(this._redrawRequest);delete this._ctx;ba(this._container);q(this._container);delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){this._redrawBounds=null;for(var d in this._layers)this._layers[d]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={};bb.prototype._update.call(this);var d=this._bounds,b=this._container,c=d.getSize(),a=ub?2:1;da(b,d.min);b.width=a*c.x;b.height=a*c.y;b.style.width=c.x+"px";b.style.height=c.y+"px";ub&&this._ctx.scale(2,2);this._ctx.translate(-d.min.x,-d.min.y);this.fire("update")}},_reset:function(){bb.prototype._reset.call(this);this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(d){this._updateDashArray(d);this._layers[f(d)]=d;d=d._order={layer:d,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d);this._drawLast=d;this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(d){this._requestRedraw(d)},_removePath:function(d){var b=d._order,c=b.next,b=b.prev;c?c.prev=b:this._drawLast=b;b?b.next=c:this._drawFirst=c;delete this._drawnLayers[d._leaflet_id];delete d._order;delete this._layers[f(d)];this._requestRedraw(d)},_updatePath:function(d){this._extendRedrawBounds(d);d._project();d._update();this._requestRedraw(d)},_updateStyle:function(d){this._updateDashArray(d);this._requestRedraw(d)},_updateDashArray:function(d){if("string"==typeof d.options.dashArray){var b,c=d.options.dashArray.split(/[, ]+/),a=[];for(b=0;b<c.length;b++)a.push(Number(c[b]));d.options._dashArray=a}else d.options._dashArray=d.options.dashArray},_requestRedraw:function(d){this._map&&(this._extendRedrawBounds(d),this._redrawRequest=this._redrawRequest||V(this._redraw,this))},_extendRedrawBounds:function(d){if(d._pxBounds){var b=(d.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new R;this._redrawBounds.extend(d._pxBounds.min.subtract([b,b]));this._redrawBounds.extend(d._pxBounds.max.add([b,b]))}},_redraw:function(){this._redrawRequest=null;this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil());this._clear();this._draw();this._redrawBounds=null},_clear:function(){var d=this._redrawBounds;if(d){var b=d.getSize();this._ctx.clearRect(d.min.x,d.min.y,b.x,b.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var d,b=this._redrawBounds;if(this._ctx.save(),b)d=b.getSize(),this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,d.x,d.y),this._ctx.clip();this._drawing=!0;for(var c=this._drawFirst;c;c=c.next)d=c.layer,(!b||d._pxBounds&&d._pxBounds.intersects(b))&&d._updatePath();this._drawing=!1;this._ctx.restore()},_updatePoly:function(d,b){if(this._drawing){var c,a,l,r,f=d._parts,e=f.length,n=this._ctx;if(e){this._drawnLayers[d._leaflet_id]=d;n.beginPath();for(c=0;c<e;c++){a=0;for(l=f[c].length;a<l;a++)r=f[c][a],n[a?"lineTo":"moveTo"](r.x,r.y);b&&n.closePath()}this._fillStroke(n,d)}}},_updateCircle:function(d){if(this._drawing&&!d._empty()){var b=d._point,c=this._ctx,a=Math.max(Math.round(d._radius),1),l=(Math.max(Math.round(d._radiusY),1)||a)/a;this._drawnLayers[d._leaflet_id]=d;1!==l&&(c.save(),c.scale(1,l));c.beginPath();c.arc(b.x,b.y/l,a,0,2*Math.PI,!1);1!==l&&c.restore();this._fillStroke(c,d)}},_fillStroke:function(d,b){var c=b.options;c.fill&&(d.globalAlpha=c.fillOpacity,d.fillStyle=c.fillColor||c.color,d.fill(c.fillRule||"evenodd"));c.stroke&&0!==c.weight&&(d.setLineDash&&d.setLineDash(b.options&&b.options._dashArray||[]),d.globalAlpha=c.opacity,d.lineWidth=c.weight,d.strokeStyle=c.color,d.lineCap=c.lineCap,d.lineJoin=c.lineJoin,d.stroke())},_onClick:function(d){for(var b,c,a=this._map.mouseEventToLayerPoint(d),l=this._drawFirst;l;l=l.next)(b=l.layer).options.interactive&&b._containsPoint(a)&&!this._map._draggableMoved(b)&&(c=b);c&&(Za(d),this._fireEvent([c],d))},_onMouseMove:function(d){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var b=this._map.mouseEventToLayerPoint(d);this._handleMouseHover(d,b)}},_handleMouseOut:function(d){var b=this._hoveredLayer;b&&(ca(this._container,"leaflet-interactive"),this._fireEvent([b],d,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(d,b){for(var c,a,l=this._drawFirst;l;l=l.next)(c=l.layer).options.interactive&&c._containsPoint(b)&&(a=c);a!==this._hoveredLayer&&(this._handleMouseOut(d),a&&(K(this._container,"leaflet-interactive"),this._fireEvent([a],d,"mouseover"),this._hoveredLayer=a));this._hoveredLayer&&this._fireEvent([this._hoveredLayer],d)},_fireEvent:function(d,b,c){this._map._fireDOMEvent(b,c||b.type,d)},_bringToFront:function(d){var b=d._order,c=b.next,a=b.prev;c&&(c.prev=a,a?a.next=c:c&&(this._drawFirst=c),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(d))},_bringToBack:function(d){var b=d._order,c=b.next,a=b.prev;a&&(a.next=c,c?c.prev=a:a&&(this._drawLast=a),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(d))}}),rc=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(d){return document.createElement("\x3clvml:"+d+' class\x3d"lvml"\x3e')}}catch(d){return function(d){return document.createElement("\x3c"+d+' xmlns\x3d"urn:schemas-microsoft.com:vml" class\x3d"lvml"\x3e')}}}(),Kd={_initContainer:function(){this._container=M("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(bb.prototype._update.call(this),this.fire("update"))},_initPath:function(d){var b=d._container=rc("shape");K(b,"leaflet-vml-shape "+(this.options.className||""));b.coordsize="1 1";d._path=rc("path");b.appendChild(d._path);this._updateStyle(d);this._layers[f(d)]=d},_addPath:function(d){var b=d._container;this._container.appendChild(b);d.options.interactive&&d.addInteractiveTarget(b)},_removePath:function(d){var b=d._container;ba(b);d.removeInteractiveTarget(b);delete this._layers[f(d)]},_updateStyle:function(d){var b=d._stroke,c=d._fill,a=d.options,l=d._container;l.stroked=!!a.stroke;l.filled=!!a.fill;a.stroke?(b||(b=d._stroke=rc("stroke")),l.appendChild(b),b.weight=a.weight+"px",b.color=a.color,b.opacity=a.opacity,a.dashArray?b.dashStyle=sa(a.dashArray)?a.dashArray.join(" "):a.dashArray.replace(/( *, *)/g," "):b.dashStyle="",b.endcap=a.lineCap.replace("butt","flat"),b.joinstyle=a.lineJoin):b&&(l.removeChild(b),d._stroke=null);a.fill?(c||(c=d._fill=rc("fill")),l.appendChild(c),c.color=a.fillColor||a.color,c.opacity=a.fillOpacity):c&&(l.removeChild(c),d._fill=null)},_updateCircle:function(d){var b=d._point.round(),c=Math.round(d._radius),a=Math.round(d._radiusY||c);this._setPath(d,d._empty()?"M0 0":"AL "+b.x+","+b.y+" "+c+","+a+" 0,23592600")},_setPath:function(d,b){d._path.v=b},_bringToFront:function(d){Ea(d._container)},_bringToBack:function(d){xa(d._container)}},Hc=Ac?rc:eb,gc=bb.extend({getEvents:function(){var d=bb.prototype.getEvents.call(this);return d.zoomstart=this._onZoomStart,d},_initContainer:function(){this._container=Hc("svg");this._container.setAttribute("pointer-events","none");this._rootGroup=Hc("g");this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ba(this._container);q(this._container);delete this._container;delete this._rootGroup;delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){bb.prototype._update.call(this);var d=this._bounds,b=d.getSize(),c=this._container;this._svgSize&&this._svgSize.equals(b)||(this._svgSize=b,c.setAttribute("width",b.x),c.setAttribute("height",b.y));da(c,d.min);c.setAttribute("viewBox",[d.min.x,d.min.y,b.x,b.y].join(" "));this.fire("update")}},_initPath:function(d){var b=d._path=Hc("path");d.options.className&&K(b,d.options.className);d.options.interactive&&K(b,"leaflet-interactive");this._updateStyle(d);this._layers[f(d)]=d},_addPath:function(d){this._rootGroup||this._initContainer();this._rootGroup.appendChild(d._path);d.addInteractiveTarget(d._path)},_removePath:function(d){ba(d._path);d.removeInteractiveTarget(d._path);delete this._layers[f(d)]},_updatePath:function(d){d._project();d._update()},_updateStyle:function(d){var b=d._path;d=d.options;b&&(d.stroke?(b.setAttribute("stroke",d.color),b.setAttribute("stroke-opacity",d.opacity),b.setAttribute("stroke-width",d.weight),b.setAttribute("stroke-linecap",d.lineCap),b.setAttribute("stroke-linejoin",d.lineJoin),d.dashArray?b.setAttribute("stroke-dasharray",d.dashArray):b.removeAttribute("stroke-dasharray"),d.dashOffset?b.setAttribute("stroke-dashoffset",d.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),d.fill?(b.setAttribute("fill",d.fillColor||d.color),b.setAttribute("fill-opacity",d.fillOpacity),b.setAttribute("fill-rule",d.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(d,b){this._setPath(d,wa(d._parts,b))},_updateCircle:function(b){var d=b._point,c=Math.max(Math.round(b._radius),1),a="a"+c+","+(Math.max(Math.round(b._radiusY),1)||c)+" 0 1,0 ",d=b._empty()?"M0 0":"M"+(d.x-c)+","+d.y+a+2*c+",0 "+a+2*-c+",0 ";this._setPath(b,d)},_setPath:function(b,c){b._path.setAttribute("d",c)},_bringToFront:function(b){Ea(b._path)},_bringToBack:function(b){xa(b._path)}});Ac&&gc.include(Kd);S.include({getRenderer:function(b){b=b.options.renderer||this._getPaneRenderer(b.options.pane)||this.options.renderer||this._renderer;return b||(b=this._renderer=this._createRenderer()),this.hasLayer(b)||this.addLayer(b),b},_getPaneRenderer:function(b){if("overlayPane"===b||void 0===b)return!1;var d=this._paneRenderers[b];return void 0===d&&(d=this._createRenderer({pane:b}),this._paneRenderers[b]=d),d},_createRenderer:function(b){return this.options.preferCanvas&&yc(b)||zc(b)}});var pd=Rb.extend({initialize:function(b,c){Rb.prototype.initialize.call(this,this._boundsToLatLngs(b),c)},setBounds:function(b){return this.setLatLngs(this._boundsToLatLngs(b))},_boundsToLatLngs:function(b){return b=X(b),[b.getSouthWest(),b.getNorthWest(),b.getNorthEast(),b.getSouthEast()]}});gc.create=Hc;gc.pointsToPath=wa;ib.geometryToLayer=Pb;ib.coordsToLatLng=pb;ib.coordsToLatLngs=Qb;ib.latLngToCoords=Ab;ib.latLngsToCoords=Sb;ib.getFeature=qb;ib.asFeature=Tb;S.mergeOptions({boxZoom:!0});var qd=ab.extend({initialize:function(b){this._map=b;this._container=b._container;this._pane=b._panes.overlayPane;this._resetStateTimeout=0;b.on("unload",this._destroy,this)},addHooks:function(){c(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){q(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ba(this._pane);delete this._pane},_resetState:function(){this._resetStateTimeout=0;this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(b){if(!b.shiftKey||1!==b.which&&1!==b.button)return!1;this._clearDeferredResetState();this._resetState();Cb();ta();this._startPoint=this._map.mouseEventToContainerPoint(b);c(document,{contextmenu:ma,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(b){this._moved||(this._moved=!0,this._box=M("div","leaflet-zoom-box",this._container),K(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart"));this._point=this._map.mouseEventToContainerPoint(b);b=new R(this._point,this._startPoint);var d=b.getSize();da(this._box,b.min);this._box.style.width=d.x+"px";this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(ba(this._box),ca(this._container,"leaflet-crosshair"));Db();D();q(document,{contextmenu:ma,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(b){1!==b.which&&1!==b.button||(this._finish(),!this._moved)||(this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(k(this._resetState,this),0),b=new ha(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(b).fire("boxzoomend",{boxZoomBounds:b}))},_onKeyDown:function(b){27===b.keyCode&&this._finish()}});S.addInitHook("addHandler","boxZoom",qd);S.mergeOptions({doubleClickZoom:!0});var rd=ab.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(b){var d=this._map,c=d.getZoom(),a=d.options.zoomDelta,c=b.originalEvent.shiftKey?c-a:c+a;"center"===d.options.doubleClickZoom?d.setZoom(c):d.setZoomAround(b.containerPoint,c)}});S.addInitHook("addHandler","doubleClickZoom",rd);S.mergeOptions({dragging:!0,inertia:!Eb,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var sd=ab.extend({addHooks:function(){if(!this._draggable){var b=this._map;this._draggable=new Hb(b._mapPane,b._container);this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);this._draggable.on("predrag",this._onPreDragLimit,this);b.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),b.on("zoomend",this._onZoomEnd,this),b.whenReady(this._onZoomEnd,this))}K(this._map._container,"leaflet-grab leaflet-touch-drag");this._draggable.enable();this._positions=[];this._times=[]},removeHooks:function(){ca(this._map._container,"leaflet-grab");ca(this._map._container,"leaflet-touch-drag");this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var b=this._map;if(b._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=X(this._map.options.maxBounds);this._offsetLimit=pa(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize()));this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;b.fire("movestart").fire("dragstart");b.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(b){if(this._map.options.inertia){var d=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c);this._times.push(d);this._prunePositions(d)}this._map.fire("move",b).fire("drag",b)},_prunePositions:function(b){for(;1<this._positions.length&&50<b-this._times[0];)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var b=this._map.getSize().divideBy(2);this._initialWorldOffset=this._map.latLngToLayerPoint([0,0]).subtract(b).x;this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(b,c){return b-(b-c)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var b=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;b.x<c.min.x&&(b.x=this._viscousLimit(b.x,c.min.x));b.y<c.min.y&&(b.y=this._viscousLimit(b.y,c.min.y));b.x>c.max.x&&(b.x=this._viscousLimit(b.x,c.max.x));b.y>c.max.y&&(b.y=this._viscousLimit(b.y,c.max.y));this._draggable._newPos=this._draggable._startPos.add(b)}},_onPreDragWrap:function(){var b=this._worldWidth,c=Math.round(b/2),a=this._initialWorldOffset,l=this._draggable._newPos.x,r=(l-c+a)%b+c-a,b=(l+c+a)%b-c-a,a=Math.abs(r+a)<Math.abs(b+a)?r:b;this._draggable._absPos=this._draggable._newPos.clone();this._draggable._newPos.x=a},_onDragEnd:function(b){var d=this._map,c=d.options,a=!c.inertia||2>this._times.length;if(d.fire("dragend",b),a)d.fire("moveend");else{this._prunePositions(+new Date);b=this._lastPos.subtract(this._positions[0]);var l=c.easeLinearity,a=b.multiplyBy(l/((this._lastTime-this._times[0])/1E3)),r=a.distanceTo([0,0]);b=Math.min(c.inertiaMaxSpeed,r);var a=a.multiplyBy(b/r),f=b/(c.inertiaDeceleration*l),e=a.multiplyBy(-f/2).round();e.x||e.y?(e=d._limitOffset(e,d.options.maxBounds),V(function(){d.panBy(e,{duration:f,easeLinearity:l,noMoveStart:!0,animate:!0})})):d.fire("moveend")}}});S.addInitHook("addHandler","dragging",sd);S.mergeOptions({keyboard:!0,keyboardPanDelta:80});var td=ab.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(b){this._map=b;this._setPanDelta(b.options.keyboardPanDelta);this._setZoomDelta(b.options.zoomDelta)},addHooks:function(){var b=this._map._container;0>=b.tabIndex&&(b.tabIndex="0");c(b,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks();q(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var b=document.body,c=document.documentElement,a=b.scrollTop||c.scrollTop,b=b.scrollLeft||c.scrollLeft;this._map._container.focus();window.scrollTo(b,a)}},_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanDelta:function(b){var d,c,a=this._panKeys={},l=this.keyCodes;d=0;for(c=l.left.length;d<c;d++)a[l.left[d]]=[-1*b,0];d=0;for(c=l.right.length;d<c;d++)a[l.right[d]]=[b,0];d=0;for(c=l.down.length;d<c;d++)a[l.down[d]]=[0,b];d=0;for(c=l.up.length;d<c;d++)a[l.up[d]]=[0,-1*b]},_setZoomDelta:function(b){var d,c,a=this._zoomKeys={},l=this.keyCodes;d=0;for(c=l.zoomIn.length;d<c;d++)a[l.zoomIn[d]]=b;d=0;for(c=l.zoomOut.length;d<c;d++)a[l.zoomOut[d]]=-b},_addHooks:function(){c(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){q(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(b){if(!(b.altKey||b.ctrlKey||b.metaKey)){var d,c=b.keyCode,a=this._map;if(c in this._panKeys)a._panAnim&&a._panAnim._inProgress||(d=this._panKeys[c],b.shiftKey&&(d=G(d).multiplyBy(3)),a.panBy(d),a.options.maxBounds&&a.panInsideBounds(a.options.maxBounds));else if(c in this._zoomKeys)a.setZoom(a.getZoom()+(b.shiftKey?3:1)*this._zoomKeys[c]);else{if(27!==c||!a._popup||!a._popup.options.closeOnEscapeKey)return;a.closePopup()}ma(b)}}});S.addInitHook("addHandler","keyboard",td);S.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ud=ab.extend({addHooks:function(){c(this._map._container,"mousewheel",this._onWheelScroll,this);this._delta=0},removeHooks:function(){q(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(b){var d=cc(b),c=this._map.options.wheelDebounceTime;this._delta+=d;this._lastMousePos=this._map.mouseEventToContainerPoint(b);this._startTime||(this._startTime=+new Date);d=Math.max(c-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(k(this._performZoom,this),d);ma(b)},_performZoom:function(){var b=this._map,c=b.getZoom(),a=this._map.options.zoomSnap||0;b._stop();var l=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,a=a?Math.ceil(l/a)*a:l,a=b._limitZoom(c+(0<this._delta?a:-a))-c;this._delta=0;this._startTime=null;a&&("center"===b.options.scrollWheelZoom?b.setZoom(c+a):b.setZoomAround(this._lastMousePos,c+a))}});S.addInitHook("addHandler","scrollWheelZoom",ud);S.mergeOptions({tap:!0,tapTolerance:15});var vd=ab.extend({addHooks:function(){c(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){q(this._map._container,"touchstart",this._onDown,this)},_onDown:function(b){if(b.touches){if(Y(b),this._fireClick=!0,1<b.touches.length)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var d=b.touches[0];b=d.target;this._startPos=this._newPos=new C(d.clientX,d.clientY);b.tagName&&"a"===b.tagName.toLowerCase()&&K(b,"leaflet-active");this._holdTimeout=setTimeout(k(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",d))},this),1E3);this._simulateEvent("mousedown",d);c(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(b){if(clearTimeout(this._holdTimeout),q(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&b&&b.changedTouches){b=b.changedTouches[0];var d=b.target;d&&d.tagName&&"a"===d.tagName.toLowerCase()&&ca(d,"leaflet-active");this._simulateEvent("mouseup",b);this._isTapValid()&&this._simulateEvent("click",b)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(b){b=b.touches[0];this._newPos=new C(b.clientX,b.clientY);this._simulateEvent("mousemove",b)},_simulateEvent:function(b,c){var d=document.createEvent("MouseEvents");d._simulated=!0;c.target._simulatedClick=!0;d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null);c.target.dispatchEvent(d)}});Ya&&!Na&&S.addInitHook("addHandler","tap",vd);S.mergeOptions({touchZoom:Ya&&!Eb,bounceAtZoomLimits:!0});var wd=ab.extend({addHooks:function(){K(this._map._container,"leaflet-touch-zoom");c(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ca(this._map._container,"leaflet-touch-zoom");q(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(b){var d=this._map;if(b.touches&&2===b.touches.length&&!d._animatingZoom&&!this._zooming){var a=d.mouseEventToContainerPoint(b.touches[0]),l=d.mouseEventToContainerPoint(b.touches[1]);this._centerPoint=d.getSize()._divideBy(2);this._startLatLng=d.containerPointToLatLng(this._centerPoint);"center"!==d.options.touchZoom&&(this._pinchStartLatLng=d.containerPointToLatLng(a.add(l)._divideBy(2)));this._startDist=a.distanceTo(l);this._startZoom=d.getZoom();this._moved=!1;this._zooming=!0;d._stop();c(document,"touchmove",this._onTouchMove,this);c(document,"touchend",this._onTouchEnd,this);Y(b)}},_onTouchMove:function(b){if(b.touches&&2===b.touches.length&&this._zooming){var d=this._map,c=d.mouseEventToContainerPoint(b.touches[0]),a=d.mouseEventToContainerPoint(b.touches[1]),l=c.distanceTo(a)/this._startDist;if(this._zoom=d.getScaleZoom(l,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&1>l||this._zoom>d.getMaxZoom()&&1<l)&&(this._zoom=d._limitZoom(this._zoom)),"center"===d.options.touchZoom){if(this._center=this._startLatLng,1===l)return}else{c=c._add(a)._divideBy(2)._subtract(this._centerPoint);if(1===l&&0===c.x&&0===c.y)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(c),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0);aa(this._animRequest);d=k(d._move,d,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=V(d,this,!0);Y(b)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,aa(this._animRequest),q(document,"touchmove",this._onTouchMove),q(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});S.addInitHook("addHandler","touchZoom",wd);S.BoxZoom=qd;S.DoubleClickZoom=rd;S.Drag=sd;S.Keyboard=td;S.ScrollWheelZoom=ud;S.Tap=vd;S.TouchZoom=wd;Object.freeze=Bc;a.version="1.3.4";a.Control=Ua;a.control=oc;a.Browser=Bd;a.Evented=Bb;a.Mixin=Ed;a.Util=rb;a.Class=fa;a.Handler=ab;a.extend=e;a.bind=k;a.stamp=f;a.setOptions=x;a.DomEvent=Dd;a.DomUtil=Cd;a.PosAnimation=fd;a.Draggable=Hb;a.LineUtil=Fd;a.PolyUtil=Gd;a.Point=C;a.point=G;a.Bounds=R;a.bounds=pa;a.Transformation=Ga;a.transformation=va;a.Projection=Hd;a.LatLng=Q;a.latLng=O;a.LatLngBounds=ha;a.latLngBounds=X;a.CRS=Ta;a.GeoJSON=ib;a.geoJSON=wc;a.geoJson=wc;a.Layer=La;a.LayerGroup=Yb;a.layerGroup=function(b,c){return new Yb(b,c)};a.FeatureGroup=zb;a.featureGroup=function(b){return new zb(b)};a.ImageOverlay=Zc;a.imageOverlay=function(b,c,a){return new Zc(b,c,a)};a.VideoOverlay=md;a.videoOverlay=function(b,c,a){return new md(b,c,a)};a.DivOverlay=jb;a.Popup=$b;a.popup=function(b,c){return new $b(b,c)};a.Tooltip=ac;a.tooltip=function(b,c){return new ac(b,c)};a.Icon=Zb;a.icon=function(b){return new Zb(b)};a.DivIcon=nd;a.divIcon=function(b){return new nd(b)};a.Marker=fc;a.marker=function(b,c){return new fc(b,c)};a.TileLayer=Ub;a.tileLayer=xc;a.GridLayer=qc;a.gridLayer=function(b){return new qc(b)};a.SVG=gc;a.svg=zc;a.Renderer=bb;a.Canvas=cd;a.canvas=yc;a.Path=vb;a.CircleMarker=Gc;a.circleMarker=function(b,c){return new Gc(b,c)};a.Circle=Xc;a.circle=function(b,c,a){return new Xc(b,c,a)};a.Polyline=hb;a.polyline=function(b,c){return new hb(b,c)};a.Polygon=Rb;a.polygon=function(b,c){return new Rb(b,c)};a.Rectangle=pd;a.rectangle=function(b,c){return new pd(b,c)};a.Map=S;a.map=function(b,c){return new S(b,c)};var Ld=window.L;a.noConflict=function(){return window.L=Ld,this};window.L=a});!function(a,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):a.proj4=e()}(this,function(){function a(b,c){if(b[c])return b[c];for(var a,l=Object.keys(b),f=c.toLowerCase().replace(Ha,""),e=-1;++e<l.length;)if(a=l[e],a.toLowerCase().replace(Ha,"")===f)return b[a]}function e(b){if("string"!=typeof b)throw Error("not a string");this.text=b.trim();this.place=this.level=0;this.root=null;this.stack=[];this.currentObject=null;this.state=xa}function k(b,c,a){Array.isArray(c)&&(a.unshift(c),c=null);a=a.reduce(function(b,c){return f(c,b),b},c?{}:b);c&&(b[c]=a)}function f(b,c){if(Array.isArray(b)){var a=b.shift();if("PARAMETER"===a&&(a=b.shift()),1===b.length)return Array.isArray(b[0])?(c[a]={},void f(b[0],c[a])):void(c[a]=b[0]);if(b.length)if("TOWGS84"!==a){Array.isArray(a)||(c[a]={});var l;switch(a){case "UNIT":case "PRIMEM":case "VERT_DATUM":return c[a]={name:b[0].toLowerCase(),convert:b[1]},void(3===b.length&&f(b[2],c[a]));case "SPHEROID":case "ELLIPSOID":return c[a]={name:b[0],a:b[1],rf:b[2]},void(4===b.length&&f(b[3],c[a]));case "PROJECTEDCRS":case "PROJCRS":case "GEOGCS":case "GEOCCS":case "PROJCS":case "LOCAL_CS":case "GEODCRS":case "GEODETICCRS":case "GEODETICDATUM":case "EDATUM":case "ENGINEERINGDATUM":case "VERT_CS":case "VERTCRS":case "VERTICALCRS":case "COMPD_CS":case "COMPOUNDCRS":case "ENGINEERINGCRS":case "ENGCRS":case "FITTED_CS":case "LOCAL_DATUM":case "DATUM":return b[0]=["name",b[0]],void k(c,a,b);default:for(l=-1;++l<b.length;)if(!Array.isArray(b[l]))return f(b,c[a]);return k(c,a,b)}}else c[a]=b;else c[a]=!0}else c[b]=!0}function h(b){return b*ka}function m(b){function c(c){return c*(b.to_meter||1)}"GEOGCS"===b.type?b.projName="longlat":"LOCAL_CS"===b.type?(b.projName="identity",b.local=!0):"object"==typeof b.PROJECTION?b.projName=Object.keys(b.PROJECTION)[0]:b.projName=b.PROJECTION;b.UNIT&&(b.units=b.UNIT.name.toLowerCase(),"metre"===b.units&&(b.units="meter"),b.UNIT.convert&&("GEOGCS"===b.type?b.DATUM&&b.DATUM.SPHEROID&&(b.to_meter=b.UNIT.convert*b.DATUM.SPHEROID.a):b.to_meter=b.UNIT.convert));var a=b.GEOGCS;"GEOGCS"===b.type&&(a=b);a&&(a.DATUM?b.datumCode=a.DATUM.name.toLowerCase():b.datumCode=a.name.toLowerCase(),"d_"===b.datumCode.slice(0,2)&&(b.datumCode=b.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==b.datumCode&&"new_zealand_1949"!==b.datumCode||(b.datumCode="nzgd49"),"wgs_1984"===b.datumCode&&("Mercator_Auxiliary_Sphere"===b.PROJECTION&&(b.sphere=!0),b.datumCode="wgs84"),"_ferro"===b.datumCode.slice(-6)&&(b.datumCode=b.datumCode.slice(0,-6)),"_jakarta"===b.datumCode.slice(-8)&&(b.datumCode=b.datumCode.slice(0,-8)),~b.datumCode.indexOf("belge")&&(b.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(b.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===b.ellps.toLowerCase().slice(0,13)&&(b.ellps="intl"),b.a=a.DATUM.SPHEROID.a,b.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(b.datum_params=a.DATUM.TOWGS84),~b.datumCode.indexOf("osgb_1936")&&(b.datumCode="osgb36"),~b.datumCode.indexOf("osni_1952")&&(b.datumCode="osni52"),(~b.datumCode.indexOf("tm65")||~b.datumCode.indexOf("geodetic_datum_of_1965"))&&(b.datumCode="ire65"),"ch1903+"===b.datumCode&&(b.datumCode="ch1903"),~b.datumCode.indexOf("israel")&&(b.datumCode="isr93"));b.b&&!isFinite(b.b)&&(b.b=b.a);[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",h],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",h],["x0","false_easting",c],["y0","false_northing",c],["long0","central_meridian",h],["lat0","latitude_of_origin",h],["lat0","standard_parallel_1",h],["lat1","standard_parallel_1",h],["lat2","standard_parallel_2",h],["azimuth","Azimuth"],["alpha","azimuth",h],["srsCode","name"]].forEach(function(c){var a=c[0],l=c[1];!(a in b)&&l in b&&(b[a]=b[l],3===c.length&&(b[a]=c[2](b[a])))});b.long0||!b.longc||"Albers_Conic_Equal_Area"!==b.projName&&"Lambert_Azimuthal_Equal_Area"!==b.projName||(b.long0=b.longc);b.lat_ts||!b.lat1||"Stereographic_South_Pole"!==b.projName&&"Polar Stereographic (variant B)"!==b.projName||(b.lat0=(0<b.lat1?90:-90)*ka,b.lat_ts=b.lat1)}function g(b){var c=this;if(2===arguments.length){var a=arguments[1];"string"==typeof a?"+"===a.charAt(0)?g[b]=Ea(arguments[1]):g[b]=Xa(arguments[1]):g[b]=a}else if(1===arguments.length){if(Array.isArray(b))return b.map(function(b){Array.isArray(b)?g.apply(c,b):g(b)});if("string"==typeof b){if(b in g)return g[b]}else"EPSG"in b?g["EPSG:"+b.EPSG]=b:"ESRI"in b?g["ESRI:"+b.ESRI]=b:"IAU2000"in b?g["IAU2000:"+b.IAU2000]=b:console.log(b)}}function u(b){return W.some(function(c){return-1<b.indexOf(c)})}function p(b){if("string"!=typeof b)return b;if(b in g)return g[b];if(u(b)){b=Xa(b);var c;c=(c=a(b,"authority"))?(c=a(c,"epsg"))&&-1<da.indexOf(c):void 0;if(c)return g["EPSG:3857"];c=(c=a(b,"extension"))?a(c,"proj4"):void 0;return c?Ea(c):b}return"+"===b[0]?Ea(b):void 0}function v(b){return b}function x(b,a){var l=c.length;return b.names?(c[l]=b,b.names.forEach(function(b){Pa[b.toLowerCase()]=l}),this):(console.log(a),!0)}function E(b,c,a,f){a=b*b;c*=c;var l=(a-c)/a,r=0;return f?(a=(b*=1-l*(Kb+l*(Ba+l*Aa)))*b,l=0):r=Math.sqrt(l),{es:l,e:r,ep2:(a-c)/c}}function z(b,c,r,f,e){b||((r=a(w,f))||(r=J),b=r.a,c=r.b,r=r.rf);return r&&!c&&(c=(1-1/r)*b),(0===r||Math.abs(b-c)<A)&&(e=!0,c=b),{a:b,b:c,rf:r,sphere:e}}function H(b,c,a,f,e,g){var l={};return l.datum_type=void 0===b||"none"===b?lb:Jb,c&&(l.datum_params=c.map(parseFloat),0===l.datum_params[0]&&0===l.datum_params[1]&&0===l.datum_params[2]||(l.datum_type=wa),3<l.datum_params.length&&(0===l.datum_params[3]&&0===l.datum_params[4]&&0===l.datum_params[5]&&0===l.datum_params[6]||(l.datum_type=ia,l.datum_params[3]*=Ma,l.datum_params[4]*=Ma,l.datum_params[5]*=Ma,l.datum_params[6]=l.datum_params[6]/1E6+1))),l.a=a,l.b=f,l.es=e,l.ep2=g,l}function F(b,c){if(!(this instanceof F))return new F(b);c=c||function(b){if(b)throw b;};var l=p(b);if("object"==typeof l){var f=F.projections.get(l.projName);if(f){if(l.datumCode&&"none"!==l.datumCode){var e=a(N,l.datumCode);e&&(l.datum_params=e.towgs84?e.towgs84.split(","):null,l.ellps=e.ellipse,l.datumName=e.datumName?e.datumName:l.datumCode)}l.k0=l.k0||1;l.axis=l.axis||"enu";l.ellps=l.ellps||"wgs84";var e=z(l.a,l.b,l.rf,l.ellps,l.sphere),g=E(e.a,e.b,e.rf,l.R_A),m=l.datum||H(l.datumCode,l.datum_params,e.a,e.b,g.es,g.ep2);ya(this,l);ya(this,f);this.a=e.a;this.b=e.b;this.rf=e.rf;this.sphere=e.sphere;this.es=g.es;this.e=g.e;this.ep2=g.ep2;this.datum=m;this.init();c(null,this)}else c(b)}else c(b)}function I(b){return b===wa||b===ia}function V(b){if("function"==typeof Number.isFinite){if(Number.isFinite(b))return;throw new TypeError("coordinates must be finite numbers");}if("number"!=typeof b||b!==b||!isFinite(b))throw new TypeError("coordinates must be finite numbers");}function aa(b,c,a){var l;Array.isArray(a)&&(a=ga(a));var f=a;V(f.x);V(f.y);b.datum&&c.datum&&((b.datum.datum_type===wa||b.datum.datum_type===ia)&&"WGS84"!==c.datumCode||(c.datum.datum_type===wa||c.datum.datum_type===ia)&&"WGS84"!==b.datumCode)&&(a=aa(b,l=new F("WGS84"),a),b=l);"enu"!==b.axis&&(a=ua(b,!1,a));"longlat"===b.projName?a={x:a.x*ea,y:a.y*ea}:(b.to_meter&&(a={x:a.x*b.to_meter,y:a.y*b.to_meter}),a=b.inverse(a));b.from_greenwich&&(a.x+=b.from_greenwich);f=b.datum;l=c.datum;b=a;var r;if(f.datum_type!==l.datum_type||f.a!==l.a||5E-11<Math.abs(f.es-l.es)||(f.datum_type===wa?f.datum_params[0]!==l.datum_params[0]||f.datum_params[1]!==l.datum_params[1]||f.datum_params[2]!==l.datum_params[2]:f.datum_type===ia&&(f.datum_params[0]!==l.datum_params[0]||f.datum_params[1]!==l.datum_params[1]||f.datum_params[2]!==l.datum_params[2]||f.datum_params[3]!==l.datum_params[3]||f.datum_params[4]!==l.datum_params[4]||f.datum_params[5]!==l.datum_params[5]||f.datum_params[6]!==l.datum_params[6])))if(f.datum_type===lb||l.datum_type===lb)r=b;else if(f.es!==l.es||f.a!==l.a||I(f.datum_type)||I(l.datum_type)){a:{var e=f.es,g,m,h,q,k=b.x,p=b.y,w=b.z?b.z:0;if(p<-y&&p>-1.001*y)p=-y;else if(p>y&&p<1.001*y)p=y;else{if(p<-y){b={x:-1/0,y:-1/0,z:b.z};break a}if(p>y){b={x:1/0,y:1/0,z:b.z};break a}}b=(k>Math.PI&&(k-=2*Math.PI),m=Math.sin(p),q=Math.cos(p),h=m*m,g=f.a/Math.sqrt(1-e*h),{x:(g+w)*q*Math.cos(k),y:(g+w)*q*Math.sin(k),z:(g*(1-e)+w)*m})}I(f.datum_type)&&(m=f.datum_type,g=f.datum_params,m===wa?b={x:b.x+g[0],y:b.y+g[1],z:b.z+g[2]}:m===ia?(m=g[3],h=g[4],q=g[5],f=g[6],b={x:f*(b.x-q*b.y+h*b.z)+g[0],y:f*(q*b.x+b.y-m*b.z)+g[1],z:f*(-h*b.x+m*b.y+b.z)+g[2]}):b=void 0);I(l.datum_type)&&(m=l.datum_type,g=l.datum_params,m===wa?b={x:b.x-g[0],y:b.y-g[1],z:b.z-g[2]}:m===ia?(m=g[3],h=g[4],q=g[5],e=g[6],f=(b.x-g[0])/e,k=(b.y-g[1])/e,b=(b.z-g[2])/e,b={x:f+q*k-h*b,y:-q*f+k+m*b,z:h*f-m*k+b}):b=void 0);var u;a:{g=l.es;l=l.a;var J,v,N,x;h=b.x;f=b.y;m=b.z?b.z:0;if(u=Math.sqrt(h*h+f*f),q=Math.sqrt(h*h+f*f+m*m),1E-12>u/l){if(h=0,1E-12>q/l){u={x:b.x,y:b.y,z:b.z};break a}}else h=Math.atan2(f,h);b=m/q;f=(J=u/q)*(1-g)*(q=1/Math.sqrt(1-g*(2-g)*J*J));k=b*q;p=0;do p++,v=g*(N=l/Math.sqrt(1-g*k*k))/(N+(w=u*f+m*k-N*(1-g*k*k))),x=(e=b*(q=1/Math.sqrt(1-v*(2-v)*J*J)))*f-(v=J*(1-v)*q)*k,f=v,k=e;while(1E-24<x*x&&30>p);u=(r=Math.atan(e/Math.abs(v)),{x:h,y:r,z:w})}r=u}else r=b;else r=b;return a=r,c.from_greenwich&&(a={x:a.x-c.from_greenwich,y:a.y}),"longlat"===c.projName?a={x:a.x*Ca,y:a.y*Ca}:(a=c.forward(a),c.to_meter&&(a={x:a.x/c.to_meter,y:a.y/c.to_meter})),"enu"!==c.axis?ua(c,!0,a):a}function fa(b,c,a){var l,f,r;return Array.isArray(a)?(l=aa(b,c,a),3===a.length?[l.x,l.y,l.z]:[l.x,l.y]):(f=aa(b,c,a),2===(r=Object.keys(a)).length?f:(r.forEach(function(b){"x"!==b&&"y"!==b&&(f[b]=a[b])}),f))}function Fa(b){return b instanceof F?b:b.oProj?b.oProj:F(b)}function C(b,c,a){b=Fa(b);var l,f=!1;return void 0===c?(c=b,b=Y,f=!0):(void 0!==c.x||Array.isArray(c))&&(a=c,c=b,b=Y,f=!0),c=Fa(c),a?fa(b,c,a):(l={forward:function(a){return fa(b,c,a)},inverse:function(a){return fa(c,b,a)}},f&&(l.oProj=c),l)}function G(b,c){var a,l,f,e,g,m,h=b[1];a=b[0];var q=Math.PI/180*h,k=Math.PI/180*a;m=Math.floor((a+180)/6)+1;180===a&&(m=60);56<=h&&64>h&&3<=a&&12>a&&(m=32);72<=h&&84>h&&(0<=a&&9>a?m=31:9<=a&&21>a?m=33:21<=a&&33>a?m=35:33<=a&&42>a&&(m=37));g=Math.PI/180*(6*(m-1)-180+3);a=6378137/Math.sqrt(1-.00669438*Math.sin(q)*Math.sin(q));l=Math.tan(q)*Math.tan(q);f=.006739496752268451*Math.cos(q)*Math.cos(q);k=.9996*a*((e=Math.cos(q)*(k-g))+(1-l+f)*e*e*e/6+(5-18*l+l*l+72*f-.39089081163157013)*e*e*e*e*e/120)+5E5;e=.9996*(6378137*(.9983242984503243*q-.002514607064228144*Math.sin(2*q)+2.639046602129982E-6*Math.sin(4*q)-3.418046101696858E-9*Math.sin(6*q))+a*Math.tan(q)*(e*e/2+(5-l+9*f+4*f*f)*e*e*e*e/24+(61-58*l+l*l+600*f-2.2240339282485886)*e*e*e*e*e*e/720));0>h&&(e+=1E7);a=Math.round(e);l=Math.round(k);f=m;m="Z";q=(84>=h&&72<=h?m="X":72>h&&64<=h?m="W":64>h&&56<=h?m="V":56>h&&48<=h?m="U":48>h&&40<=h?m="T":40>h&&32<=h?m="S":32>h&&24<=h?m="R":24>h&&16<=h?m="Q":16>h&&8<=h?m="P":8>h&&0<=h?m="N":0>h&&-8<=h?m="M":-8>h&&-16<=h?m="L":-16>h&&-24<=h?m="K":-24>h&&-32<=h?m="J":-32>h&&-40<=h?m="H":-40>h&&-48<=h?m="G":-48>h&&-56<=h?m="F":-56>h&&-64<=h?m="E":-64>h&&-72<=h?m="D":-72>h&&-80<=h&&(m="C"),m);h=c||5;m="00000"+l;e="00000"+a;q=f+q;k=ha(f);l=Math.floor(l/1E5);f=Math.floor(a/1E5)%20;--k;a=bc.charCodeAt(k);k=cc.charCodeAt(k);l=a+l-1;f=k+f;g=!1;a=(l>ob&&(l=l-ob+Za-1,g=!0),(l===na||a<na&&l>na||(l>na||a<na)&&g)&&l++,(l===qa||a<qa&&l>qa||(l>qa||a<qa)&&g)&&++l===na&&l++,l>ob&&(l=l-ob+Za-1),f>nb?(f=f-nb+Za-1,g=!0):g=!1,(f===na||k<na&&f>na||(f>na||k<na)&&g)&&f++,(f===qa||k<qa&&f>qa||(f>qa||k<qa)&&g)&&++f===na&&f++,f>nb&&(f=f-nb+Za-1),String.fromCharCode(l)+String.fromCharCode(f));return q+a+m.substr(m.length-5,h)+e.substr(e.length-5,h)}function R(b){b=pa(X(b.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat]:[(b.left+b.right)/2,(b.top+b.bottom)/2]}function pa(b){var c=b.easting,a=b.zoneNumber;if(0>a||60<a)return null;var f,e,g,m,h;h=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562));g=b.northing;"N">b.zoneLetter&&(g-=1E7);h=(e=g/.9996/6367449.145945056)+(3*h/2-27*h*h*h/32)*Math.sin(2*e)+(21*h*h/16-55*h*h*h*h/32)*Math.sin(4*e)+151*h*h*h/96*Math.sin(6*e);f=6378137/Math.sqrt(1-.00669438*Math.sin(h)*Math.sin(h));e=Math.tan(h)*Math.tan(h);g=.006739496752268451*Math.cos(h)*Math.cos(h);m=6335439.32722994/Math.pow(1-.00669438*Math.sin(h)*Math.sin(h),1.5);c=(c-5E5)/(.9996*f);f=h-f*Math.tan(h)/m*(c*c/2-(5+3*e+10*g-4*g*g-.06065547077041606)*c*c*c*c/24+(61+90*e+298*g+45*e*e-1.6983531815716497-3*g*g)*c*c*c*c*c*c/720);f=f/Math.PI*180;c=(c-(1+2*e+g)*c*c*c/6+(5-2*g+28*e-3*g*g+.05391597401814761+24*e*e)*c*c*c*c*c/120)/Math.cos(h);c=6*(a-1)-180+3+c/Math.PI*180;b.accuracy?(b=pa({northing:b.northing+b.accuracy,easting:b.easting+b.accuracy,zoneLetter:b.zoneLetter,zoneNumber:b.zoneNumber}),b={top:b.lat,right:b.lon,bottom:f,left:c}):b={lat:f,lon:c};return b}function ha(b){b%=ma;return 0===b&&(b=ma),b}function X(b){if(b&&0===b.length)throw"MGRSPoint coverting from nothing";for(var c,a=b.length,f,e="",g=0;!/[A-Z]/.test(c=b.charAt(g));){if(2<=g)throw"MGRSPoint bad conversion from: "+b;e+=c;g++}c=parseInt(e,10);if(0===g||g+3>a)throw"MGRSPoint bad conversion from: "+b;e=b.charAt(g++);if("A">=e||"B"===e||"Y"===e||"Z"<=e||"I"===e||"O"===e)throw"MGRSPoint zone letter "+e+" not handled: "+b;f=b.substring(g,g+=2);var h=ha(c),m;m=f.charAt(0);for(var q=bc.charCodeAt(h-1),k=1E5,p=!1;q!==m.charCodeAt(0);){if(++q===na&&q++,q===qa&&q++,q>ob){if(p)throw"Bad character: "+m;q=Za;p=!0}k+=1E5}m=k;f=f.charAt(1);if("V"<f)throw"MGRSPoint given invalid Northing "+f;h=cc.charCodeAt(h-1);q=0;for(k=!1;h!==f.charCodeAt(0);){if(++h===na&&h++,h===qa&&h++,h>nb){if(k)throw"Bad character: "+f;h=Za;k=!0}q+=1E5}for(h=q;h<Q(e);)h+=2E6;a-=g;if(0!=a%2)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+b;var w,u,J,v,N,a=a/2,q=f=0;return 0<a&&(w=1E5/Math.pow(10,a),u=b.substring(g,g+a),f=parseFloat(u)*w,J=b.substring(g+a),q=parseFloat(J)*w),v=f+m,N=q+h,{easting:v,northing:N,zoneLetter:e,zoneNumber:c,accuracy:w}}function Q(b){var c;switch(b){case "C":c=11E5;break;case "D":c=2E6;break;case "E":c=28E5;break;case "F":c=37E5;break;case "G":c=46E5;break;case "H":c=55E5;break;case "J":c=64E5;break;case "K":c=73E5;break;case "L":c=82E5;break;case "M":c=91E5;break;case "N":c=0;break;case "P":c=8E5;break;case "Q":c=17E5;break;case "R":c=26E5;break;case "S":c=35E5;break;case "T":c=44E5;break;case "U":c=53E5;break;case "V":c=62E5;break;case "W":c=7E6;break;case "X":c=79E5;break;default:c=-1}if(0<=c)return c;throw"Invalid zone letter: "+b;}function O(b,c,a){if(!(this instanceof O))return new O(b,c,a);Array.isArray(b)?(this.x=b[0],this.y=b[1],this.z=b[2]||0):"object"==typeof b?(this.x=b.x,this.y=b.y,this.z=b.z||0):"string"==typeof b&&void 0===c?(b=b.split(","),this.x=parseFloat(b[0],10),this.y=parseFloat(b[1],10),this.z=parseFloat(b[2],10)||0):(this.x=b,this.y=c,this.z=a||0);console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}function Ga(b,c,a,f){var l;return b<A?(f.value=U.AREA_0,l=0):(l=Math.atan2(c,a),Math.abs(l)<=P?f.value=U.AREA_0:l>P&&l<=y+P?(f.value=U.AREA_1,l-=y):l>y+P||l<=-(y+P)?(f.value=U.AREA_2,l=0<=l?l-T:l+T):(f.value=U.AREA_3,l+=y)),l}function va(b,c){var a=b+c;return a<-T?a+=Oa:a>+T&&(a-=Oa),a}function eb(b,c,a,f){for(;f;--f){var l=b(c);if(c-=l,Math.abs(l)<a)break}return c}var wa=1,ia=2,Jb=4,lb=5,Ma=4.84813681109536E-6,y=Math.PI/2,Kb=.16666666666666666,Ba=.04722222222222222,Aa=.022156084656084655,A=1E-10,ea=.017453292519943295,Ca=57.29577951308232,P=Math.PI/4,Oa=2*Math.PI,T=3.14159265359,M={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},ba={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},Ha=/[\s_\-\/\(\)]/g,Ea=function(b){var c,f,e={},g=b.split("+").map(function(b){return b.trim()}).filter(function(b){return b}).reduce(function(b,c){var a=c.split("\x3d");return a.push(!0),b[a[0].toLowerCase()]=a[1],b},{}),h={proj:"projName",datum:"datumCode",rf:function(b){e.rf=parseFloat(b)},lat_0:function(b){e.lat0=b*ea},lat_1:function(b){e.lat1=b*ea},lat_2:function(b){e.lat2=b*ea},lat_ts:function(b){e.lat_ts=b*ea},lon_0:function(b){e.long0=b*ea},lon_1:function(b){e.long1=b*ea},lon_2:function(b){e.long2=b*ea},alpha:function(b){e.alpha=parseFloat(b)*ea},lonc:function(b){e.longc=b*ea},x_0:function(b){e.x0=parseFloat(b)},y_0:function(b){e.y0=parseFloat(b)},k_0:function(b){e.k0=parseFloat(b)},k:function(b){e.k0=parseFloat(b)},a:function(b){e.a=parseFloat(b)},b:function(b){e.b=parseFloat(b)},r_a:function(){e.R_A=!0},zone:function(b){e.zone=parseInt(b,10)},south:function(){e.utmSouth=!0},towgs84:function(b){e.datum_params=b.split(",").map(function(b){return parseFloat(b)})},to_meter:function(b){e.to_meter=parseFloat(b)},units:function(b){e.units=b;(b=a(ba,b))&&(e.to_meter=b.to_meter)},from_greenwich:function(b){e.from_greenwich=b*ea},pm:function(b){var c=a(M,b);e.from_greenwich=(c||parseFloat(b))*ea},nadgrids:function(b){"@null"===b?e.datumCode="none":e.nadgrids=b},axis:function(b){3===b.length&&-1!=="ewnsud".indexOf(b.substr(0,1))&&-1!=="ewnsud".indexOf(b.substr(1,1))&&-1!=="ewnsud".indexOf(b.substr(2,1))&&(e.axis=b)}};for(c in g)b=g[c],c in h?"function"==typeof(f=h[c])?f(b):e[f]=b:e[c]=b;return"string"==typeof e.datumCode&&"WGS84"!==e.datumCode&&(e.datumCode=e.datumCode.toLowerCase()),e},xa=1,Va=/\s/,K=/[A-Za-z]/,ca=/[A-Za-z84]/,Da=/[,\]]/,Wa=/[\d\.E\-\+]/;e.prototype.readCharicter=function(){var b=this.text[this.place++];if(4!==this.state)for(;Va.test(b);){if(this.place>=this.text.length)return;b=this.text[this.place++]}switch(this.state){case xa:return this.neutral(b);case 2:return this.keyword(b);case 4:return this.quoted(b);case 5:return this.afterquote(b);case 3:return this.number(b)}};e.prototype.afterquote=function(b){if('"'===b)return this.word+='"',void(this.state=4);if(Da.test(b))return this.word=this.word.trim(),void this.afterItem(b);throw Error("havn't handled \""+b+'" in afterquote yet, index '+this.place);};e.prototype.afterItem=function(b){return","===b?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=xa)):"]"===b?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=xa,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0};e.prototype.number=function(b){if(!Wa.test(b)){if(Da.test(b))return this.word=parseFloat(this.word),void this.afterItem(b);throw Error("havn't handled \""+b+'" in number yet, index '+this.place);}this.word+=b};e.prototype.quoted=function(b){'"'!==b?this.word+=b:this.state=5};e.prototype.keyword=function(b){if(ca.test(b))this.word+=b;else{if("["===b)return b=[],b.push(this.word),this.level++,null===this.root?this.root=b:this.currentObject.push(b),this.stack.push(this.currentObject),this.currentObject=b,void(this.state=xa);if(!Da.test(b))throw Error("havn't handled \""+b+'" in keyword yet, index '+this.place);this.afterItem(b)}};e.prototype.neutral=function(b){if(K.test(b))return this.word=b,void(this.state=2);if('"'===b)return this.word="",void(this.state=4);if(Wa.test(b))return this.word=b,void(this.state=3);if(!Da.test(b))throw Error("havn't handled \""+b+'" in neutral yet, index '+this.place);this.afterItem(b)};e.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw Error('unable to parse string "'+this.text+'". State is '+this.state);};var ka=.017453292519943295,Xa=function(b){b=(new e(b)).output();var c=b.shift(),a=b.shift();b.unshift(["name",a]);b.unshift(["type",c]);c={};return f(b,c),m(c),c};!function(b){b("EPSG:4326","+title\x3dWGS 84 (long/lat) +proj\x3dlonglat +ellps\x3dWGS84 +datum\x3dWGS84 +units\x3ddegrees");b("EPSG:4269","+title\x3dNAD83 (long/lat) +proj\x3dlonglat +a\x3d6378137.0 +b\x3d6356752.31414036 +ellps\x3dGRS80 +datum\x3dNAD83 +units\x3ddegrees");b("EPSG:3857","+title\x3dWGS 84 / Pseudo-Mercator +proj\x3dmerc +a\x3d6378137 +b\x3d6378137 +lat_ts\x3d0.0 +lon_0\x3d0.0 +x_0\x3d0.0 +y_0\x3d0 +k\x3d1.0 +units\x3dm +nadgrids\x3d@null +no_defs");b.WGS84=b["EPSG:4326"];b["EPSG:3785"]=b["EPSG:3857"];b.GOOGLE=b["EPSG:3857"];b["EPSG:900913"]=b["EPSG:3857"];b["EPSG:102113"]=b["EPSG:3857"]}(g);var W="PROJECTEDCRS PROJCRS GEOGCS GEOCCS PROJCS LOCAL_CS GEODCRS GEODETICCRS GEODETICDATUM ENGCRS ENGINEERINGCRS".split(" "),da=["3857","900913","3785","102113"],ya=function(b,c){b=b||{};var a,l;if(!c)return b;for(l in c)void 0!==(a=c[l])&&(b[l]=a);return b},ta=function(b,c,a){b*=c;return a/Math.sqrt(1-b*b)},D=function(b){return Math.abs(b)<=T?b:b-(0>b?-1:1)*Oa},la=function(b,c,a){a*=b;return a=Math.pow((1-a)/(1+a),.5*b),Math.tan(.5*(y-c))/a},za=function(b,c){for(var a,l,f=.5*b,e=y-2*Math.atan(c),g=0;15>=g;g++)if(a=b*Math.sin(e),l=y-2*Math.atan(c*Math.pow((1-a)/(1+a),f))-e,e+=l,1E-10>=Math.abs(l))return e;return-9999},fb=[{init:function(){var b=this.b/this.a;this.es=1-b*b;"x0"in this||(this.x0=0);"y0"in this||(this.y0=0);this.e=Math.sqrt(this.es);this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=ta(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(b){var c=b.x,a=b.y;if(90<a*Ca&&-90>a*Ca&&180<c*Ca&&-180>c*Ca||Math.abs(Math.abs(a)-y)<=A)return null;this.sphere?(c=this.x0+this.a*this.k0*D(c-this.long0),a=this.y0+this.a*this.k0*Math.log(Math.tan(P+.5*a))):(a=la(this.e,a,Math.sin(a)),c=this.x0+this.a*this.k0*D(c-this.long0),a=this.y0-this.a*this.k0*Math.log(a));return b.x=c,b.y=a,b},inverse:function(b){var c,a,f=b.x-this.x0;a=b.y-this.y0;if(this.sphere)a=y-2*Math.atan(Math.exp(-a/(this.a*this.k0)));else if(-9999===(a=za(this.e,Math.exp(-a/(this.a*this.k0)))))return null;return c=D(this.long0+f/(this.a*this.k0)),b.x=c,b.y=a,b},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:v,inverse:v,names:["longlat","identity"]}],Pa={},c=[],q={start:function(){fb.forEach(x)},add:x,get:function(b){if(!b)return!1;b=b.toLowerCase();return void 0!==Pa[b]&&c[Pa[b]]?c[Pa[b]]:void 0}},w={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl \x26 S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah \x26 Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},J=w.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};w.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r\x3d6370997)"};var N={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};F.projections=q;F.projections.start();var ua=function(b,c,a){var l,f,e,g=a.x,r=a.y,h=a.z||0,m={};for(e=0;3>e;e++)if(!c||2!==e||void 0!==a.z)switch(0===e?(l=g,f="x"):1===e?(l=r,f="y"):(l=h,f="z"),b.axis[e]){case "e":m[f]=l;break;case "w":m[f]=-l;break;case "n":m[f]=l;break;case "s":m[f]=-l;break;case "u":void 0!==a[f]&&(m.z=l);break;case "d":void 0!==a[f]&&(m.z=-l);break;default:return null}return m},ga=function(b){var c={x:b[0],y:b[1]};return 2<b.length&&(c.z=b[2]),3<b.length&&(c.m=b[3]),c},Y=F("WGS84"),ma=6,bc="AJSAJS",cc="AFAFAF",Za=65,na=73,qa=79,nb=86,ob=90,dc={forward:G,inverse:function(b){b=pa(X(b.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat,b.lon,b.lat]:[b.left,b.bottom,b.right,b.top]},toPoint:R};O.fromMGRS=function(b){return new O(R(b))};O.prototype.toMGRS=function(b){return G([this.x,this.y],b)};var ec=function(b){var c=[];c[0]=1-b*(.25+b*(.046875+b*(.01953125+.01068115234375*b)));c[1]=b*(.75-b*(.046875+b*(.01953125+.01068115234375*b)));var a=b*b;return c[2]=a*(.46875-b*(.013020833333333334+.007120768229166667*b)),a*=b,c[3]=a*(.3645833333333333-.005696614583333333*b),c[4]=a*b*.3076171875,c},gb=function(b,c,a,f){return a*=c,c*=c,f[0]*b-a*(f[1]+c*(f[2]+c*(f[3]+c*f[4])))},$a=function(b,c,a){for(var l=1/(1-c),f=b,e=20;e;--e){var g=Math.sin(f),r=1-c*g*g;if(r=(gb(f,g,Math.cos(f),a)-b)*r*Math.sqrt(r)*l,f-=r,Math.abs(r)<A)break}return f},yb={init:function(){this.x0=void 0!==this.x0?this.x0:0;this.y0=void 0!==this.y0?this.y0:0;this.long0=void 0!==this.long0?this.long0:0;this.lat0=void 0!==this.lat0?this.lat0:0;this.es&&(this.en=ec(this.es),this.ml0=gb(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(b){var c,a,f=b.y,e=D(b.x-this.long0),g=Math.sin(f),h=Math.cos(f);if(this.es){a=h*e;var m=Math.pow(a,2),q=this.ep2*Math.pow(h,2),k=Math.pow(q,2),p=Math.pow(Math.abs(h)>A?Math.tan(f):0,2),w=Math.pow(p,2);c=1-this.es*Math.pow(g,2);a/=Math.sqrt(c);f=gb(f,g,h,this.en);c=this.a*this.k0*a*(1+m/6*(1-p+q+m/20*(5-18*p+w+14*q-58*p*q+m/42*(61+179*w-w*p-479*p))))+this.x0;a=this.a*this.k0*(f-this.ml0+g*e*a/2*(1+m/12*(5-p+9*q+4*k+m/30*(61+w-58*p+270*q-330*p*q+m/56*(1385+543*w-w*p-3111*p)))))+this.y0}else{g=h*Math.sin(e);if(Math.abs(Math.abs(g)-1)<A)return 93;if(c=.5*this.a*this.k0*Math.log((1+g)/(1-g))+this.x0,a=h*Math.cos(e)/Math.sqrt(1-Math.pow(g,2)),1<=(g=Math.abs(a))){if(g-1>A)return 93;a=0}else a=Math.acos(a);0>f&&(a=-a);a=this.a*this.k0*(a-this.lat0)+this.y0}return b.x=c,b.y=a,b},inverse:function(b){var c,a,f=1/this.a*(b.x-this.x0),e=1/this.a*(b.y-this.y0);if(this.es)if(c=this.ml0+e/this.k0,a=$a(c,this.es,this.en),Math.abs(a)<y){var e=Math.cos(a),g=Math.abs(e)>A?Math.tan(a):0,h=this.ep2*Math.pow(e,2),m=Math.pow(h,2),q=Math.pow(g,2),k=Math.pow(q,2);c=1-this.es*Math.pow(Math.sin(a),2);var f=f*Math.sqrt(c)/this.k0,p=Math.pow(f,2);c=a-c*g*p/(1-this.es)*.5*(1-p/12*(5+3*q-9*h*q+h-4*m-p/30*(61+90*q-252*h*q+45*k+46*h-p/56*(1385+3633*q+4095*k+1574*k*q))));a=D(this.long0+f*(1-p/6*(1+2*q+h-p/20*(5+28*q+24*k+8*h*q+6*h-p/42*(61+662*q+1320*k+720*k*q))))/e)}else c=y*(0>e?-1:1),a=0;else c=Math.exp(f/this.k0),a=.5*(c-1/c),h=Math.cos(this.lat0+e/this.k0),c=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(a,2))),c=Math.asin(c),0>e&&(c=-c),a=0===a&&0===h?0:D(Math.atan2(a,h)+this.long0);return b.x=a,b.y=c,b},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},Ja=function(b){b=Math.exp(b);return(b-1/b)/2},Nb=function(b,c){b=Math.abs(b);c=Math.abs(c);var a=Math.max(b,c);return a*Math.sqrt(1+Math.pow(Math.min(b,c)/(a||1),2))},Ob=function(b,c){for(var a,l=2*Math.cos(2*c),f=b.length-1,e=b[f],g=0;0<=--f;)a=l*e-g+b[f],g=e,e=a;return c+a*Math.sin(2*c)},Pb=function(b,c,a){var l,f=Math.sin(c);c=Math.cos(c);var e=Ja(a),g;a=Math.exp(a);g=(a+1/a)/2;for(var h=2*c*g,r=-2*f*e,m=b.length-1,q=b[m],k=0,p=0,w=0;0<=--m;)a=p,l=k,q=h*(p=q)-a-r*(k=w)+b[m],w=r*p-l+h*k;return h=f*g,r=c*e,[h*q-r*w,h*w+r*q]},pb={init:function(){if(void 0===this.es||0>=this.es)throw Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0;this.y0=void 0!==this.y0?this.y0:0;this.long0=void 0!==this.long0?this.long0:0;this.lat0=void 0!==this.lat0?this.lat0:0;this.cgb=[];this.cbg=[];this.utg=[];this.gtu=[];var b=this.es/(1+Math.sqrt(1-this.es)),b=b/(2-b),c;this.cgb[0]=b*(2+b*(-2/3+b*(b*(116/45+b*(26/45+-2854/675*b))-2)));this.cbg[0]=b*(b*(2/3+b*(4/3+b*(-82/45+b*(32/45+4642/4725*b))))-2);c=b*b;this.cgb[1]=c*(7/3+b*(b*(-227/45+b*(2704/315+2323/945*b))-1.6));this.cbg[1]=c*(5/3+b*(-16/15+b*(-13/9+b*(904/315+-1522/945*b))));c*=b;this.cgb[2]=c*(56/15+b*(-136/35+b*(-1262/105+73814/2835*b)));this.cbg[2]=c*(-26/15+b*(34/21+b*(1.6+-12686/2835*b)));c*=b;this.cgb[3]=c*(4279/630+b*(-332/35+-399572/14175*b));this.cbg[3]=c*(1237/630+b*(-24832/14175*b-2.4));c*=b;this.cgb[4]=c*(4174/315+-144838/6237*b);this.cbg[4]=c*(-734/315+109598/31185*b);c*=b;this.cgb[5]=601676/22275*c;this.cbg[5]=444337/155925*c;c=Math.pow(b,2);this.Qn=this.k0/(1+b)*(1+c*(.25+c*(.015625+c/256)));this.utg[0]=b*(b*(2/3+b*(-37/96+b*(1/360+b*(81/512+-96199/604800*b))))-.5);this.gtu[0]=b*(.5+b*(-2/3+b*(.3125+b*(41/180+b*(-127/288+7891/37800*b)))));this.utg[1]=c*(-1/48+b*(-1/15+b*(437/1440+b*(-46/105+.2890188388723545*b))));this.gtu[1]=c*(13/48+b*(b*(557/1440+b*(281/630+-1.0248393063822752*b))-.6));c*=b;this.utg[2]=c*(-17/480+b*(37/840+b*(209/4480+-5569/90720*b)));this.gtu[2]=c*(61/240+b*(-103/140+b*(15061/26880+167603/181440*b)));c*=b;this.utg[3]=c*(-4397/161280+b*(11/504+830251/7257600*b));this.gtu[3]=c*(49561/161280+b*(-179/168+.9096203979276896*b));c*=b;this.utg[4]=c*(-4583/161280+108847/3991680*b);this.gtu[4]=c*(34729/80640+-1.713007555715889*b);c*=b;this.utg[5]=-.03233083094085698*c;this.gtu[5]=.6650675310896665*c;b=Ob(this.cbg,this.lat0);c=-this.Qn;for(var a=this.gtu,f=2*b,e,g=2*Math.cos(f),h=a.length-1,m=a[h],q=0;0<=--h;)e=g*m-q+a[h],q=m,m=e;this.Zb=c*(b+Math.sin(f)*e)},forward:function(b){var c=D(b.x-this.long0),a=b.y,a=Ob(this.cbg,a),f=Math.sin(a),e=Math.cos(a),g=Math.sin(c),c=Math.cos(c),a=Math.atan2(f,c*e),c=Math.atan2(g*e,Nb(f,e*c)),c=Math.tan(c),f=Math.abs(c),e=f*(1+f/(Nb(1,f)+1)),g=1+e,h=g-1,c=(f=0===h?e:e*Math.log(g)/h,0>c?-f:f),f=Pb(this.gtu,2*a,2*c),a=a+f[0],c=c+f[1],m,q;return 2.623395162778>=Math.abs(c)?(m=this.a*this.Qn*c+this.x0,q=this.a*(this.Qn*a+this.Zb)+this.y0):(m=1/0,q=1/0),b.x=m,b.y=q,b},inverse:function(b){var c=1/this.a*(b.x-this.x0),a=1/this.a*(b.y-this.y0),a=(a-this.Zb)/this.Qn,c=c/this.Qn;if(2.623395162778>=Math.abs(c))var f=Pb(this.utg,2*a,2*c),a=a+f[0],c=c+f[1],c=Math.atan(Ja(c)),f=Math.cos(a),e=Math.sin(c),c=Math.cos(c),a=Math.atan2(Math.sin(a)*c,Nb(e,c*f)),c=Math.atan2(e,c*f),c=D(c+this.long0),a=Ob(this.cgb,a);else c=1/0,a=1/0;return b.x=c,b.y=a,b},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]},Qb={init:function(){var b;b=this.zone;void 0===b&&(0>(b=Math.floor(30*(D(this.long0)+Math.PI)/Math.PI)+1)?b=0:60<b&&(b=60));if(void 0===b)throw Error("unknown utm zone");this.lat0=0;this.long0=(6*Math.abs(b)-183)*ea;this.x0=5E5;this.y0=this.utmSouth?1E7:0;this.k0=.9996;pb.init.apply(this);this.forward=pb.forward;this.inverse=pb.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},Ab=function(b,c){return Math.pow((1-b)/(1+b),c)},Sb=function(){var b=Math.sin(this.lat0),c=Math.cos(this.lat0),c=c*c;this.rc=Math.sqrt(1-this.es)/(1-this.es*b*b);this.C=Math.sqrt(1+this.es*c*c/(1-this.es));this.phic0=Math.asin(b/this.C);this.ratexp=.5*this.C*this.e;this.K=Math.tan(.5*this.phic0+P)/(Math.pow(Math.tan(.5*this.lat0+P),this.C)*Ab(this.e*b,this.ratexp))},qb=function(b){var c=b.x,a=b.y;return b.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*a+P),this.C)*Ab(this.e*Math.sin(a),this.ratexp))-y,b.x=this.C*c,b},Tb=function(b){for(var c=b.x/this.C,a=b.y,f=Math.pow(Math.tan(.5*a+P)/this.K,1/this.C),e=20;0<e&&(a=2*Math.atan(f*Ab(this.e*Math.sin(b.y),-.5*this.e))-y,!(1E-14>Math.abs(a-b.y)));--e)b.y=a;return e?(b.x=c,b.y=a,b):null},wc={init:function(){Sb.apply(this);this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(b){var c,a,f,e;return b.x=D(b.x-this.long0),qb.apply(this,[b]),c=Math.sin(b.y),a=Math.cos(b.y),f=Math.cos(b.x),e=this.k0*this.R2/(1+this.sinc0*c+this.cosc0*a*f),b.x=e*a*Math.sin(b.x),b.y=e*(this.cosc0*c-this.sinc0*a*f),b.x=this.a*b.x+this.x0,b.y=this.a*b.y+this.y0,b},inverse:function(b){var c,a,f,e;(b.x=(b.x-this.x0)/this.a,b.y=(b.y-this.y0)/this.a,b.x/=this.k0,b.y/=this.k0,e=Math.sqrt(b.x*b.x+b.y*b.y))?(f=2*Math.atan2(e,this.R2),c=Math.sin(f),a=Math.cos(f),f=Math.asin(a*this.sinc0+b.y*c*this.cosc0/e),c=Math.atan2(b.x*c,e*this.cosc0*a-b.y*this.sinc0*c)):(f=this.phic0,c=0);return b.x=c,b.y=f,Tb.apply(this,[b]),b.x=D(b.x+this.long0),b},names:"Stereographic_North_Pole;Oblique_Stereographic;Polar_Stereographic;sterea;Oblique Stereographic Alternative;Double_Stereographic".split(";")},xc={init:function(){this.coslat0=Math.cos(this.lat0);this.sinlat0=Math.sin(this.lat0);this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=A&&(this.k0=.5*(1+(0>this.lat0?-1:1)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=A&&(0<this.lat0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=A&&(this.k0=.5*this.cons*ta(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/la(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=ta(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-y,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(b){var c,a,f,e,g,h,m=b.x,q=b.y,k=Math.sin(q),p=Math.cos(q),w=D(m-this.long0);return Math.abs(Math.abs(m-this.long0)-Math.PI)<=A&&Math.abs(q+this.lat0)<=A?(b.x=NaN,b.y=NaN,b):this.sphere?(c=2*this.k0/(1+this.sinlat0*k+this.coslat0*p*Math.cos(w)),b.x=this.a*c*p*Math.sin(w)+this.x0,b.y=this.a*c*(this.coslat0*k-this.sinlat0*p*Math.cos(w))+this.y0,b):(a=2*Math.atan(this.ssfn_(q,k,this.e))-y,e=Math.cos(a),f=Math.sin(a),Math.abs(this.coslat0)<=A?(g=la(this.e,q*this.con,this.con*k),h=2*this.a*this.k0*g/this.cons,b.x=this.x0+h*Math.sin(m-this.long0),b.y=this.y0-this.con*h*Math.cos(m-this.long0),b):(Math.abs(this.sinlat0)<A?(c=2*this.a*this.k0/(1+e*Math.cos(w)),b.y=c*f):(c=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*f+this.cosX0*e*Math.cos(w))),b.y=c*(this.cosX0*f-this.sinX0*e*Math.cos(w))+this.y0),b.x=c*e*Math.sin(w)+this.x0,b))},inverse:function(b){b.x-=this.x0;b.y-=this.y0;var c,a,f,e=Math.sqrt(b.x*b.x+b.y*b.y);if(this.sphere)return f=2*Math.atan(e/(2*this.a*this.k0)),c=this.long0,a=this.lat0,e<=A?(b.x=c,b.y=a,b):(a=Math.asin(Math.cos(f)*this.sinlat0+b.y*Math.sin(f)*this.coslat0/e),c=D(Math.abs(this.coslat0)<A?0<this.lat0?this.long0+Math.atan2(b.x,-1*b.y):this.long0+Math.atan2(b.x,b.y):this.long0+Math.atan2(b.x*Math.sin(f),e*this.coslat0*Math.cos(f)-b.y*this.sinlat0*Math.sin(f))),b.x=c,b.y=a,b);if(Math.abs(this.coslat0)<=A){if(e<=A)return a=this.lat0,c=this.long0,b.x=c,b.y=a,b;b.x*=this.con;b.y*=this.con;c=e*this.cons/(2*this.a*this.k0);a=this.con*za(this.e,c);c=this.con*D(this.con*this.long0+Math.atan2(b.x,-1*b.y))}else a=2*Math.atan(e*this.cosX0/(2*this.a*this.k0*this.ms1)),c=this.long0,e<=A?f=this.X0:(f=Math.asin(Math.cos(a)*this.sinX0+b.y*Math.sin(a)*this.cosX0/e),c=D(this.long0+Math.atan2(b.x*Math.sin(a),e*this.cosX0*Math.cos(a)-b.y*this.sinX0*Math.sin(a)))),a=-1*za(this.e,Math.tan(.5*(y+f)));return b.x=c,b.y=a,b},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(b,c,a){return c*=a,Math.tan(.5*(y+b))*Math.pow((1-c)/(1+c),.5*a)}},yc={init:function(){var b=this.lat0;this.lambda0=this.long0;var c=Math.sin(b),a=this.a,f=1/this.rf,f=2*f-Math.pow(f,2),e=this.e=Math.sqrt(f);this.R=this.k0*a*Math.sqrt(1-f)/(1-f*Math.pow(c,2));this.alpha=Math.sqrt(1+f/(1-f)*Math.pow(Math.cos(b),4));this.b0=Math.asin(c/this.alpha);this.K=Math.log(Math.tan(Math.PI/4+this.b0/2))-this.alpha*Math.log(Math.tan(Math.PI/4+b/2))+this.alpha*e/2*Math.log((1+e*c)/(1-e*c))},forward:function(b){var c=2*(Math.atan(Math.exp(-this.alpha*(Math.log(Math.tan(Math.PI/4-b.y/2))+this.e/2*Math.log((1+this.e*Math.sin(b.y))/(1-this.e*Math.sin(b.y))))+this.K))-Math.PI/4),a=this.alpha*(b.x-this.lambda0),f=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(c)+Math.cos(this.b0)*Math.cos(a))),c=Math.asin(Math.cos(this.b0)*Math.sin(c)-Math.sin(this.b0)*Math.cos(c)*Math.cos(a));return b.y=this.R/2*Math.log((1+Math.sin(c))/(1-Math.sin(c)))+this.y0,b.x=this.R*f+this.x0,b},inverse:function(b){for(var c=(b.x-this.x0)/this.R,a=2*(Math.atan(Math.exp((b.y-this.y0)/this.R))-Math.PI/4),f=Math.asin(Math.cos(this.b0)*Math.sin(a)+Math.sin(this.b0)*Math.cos(a)*Math.cos(c)),c=this.lambda0+Math.atan(Math.sin(c)/(Math.cos(this.b0)*Math.cos(c)-Math.sin(this.b0)*Math.tan(a)))/this.alpha,e=f,g=-1E3,h=0;1E-7<Math.abs(e-g);){if(20<++h)return;a=1/this.alpha*(Math.log(Math.tan(Math.PI/4+f/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(e))/2));g=e;e=2*Math.atan(Math.exp(a))-Math.PI/2}return b.x=c,b.y=e,b},names:["somerc"]},zc={init:function(){this.no_off=this.no_off||!1;this.no_rot=this.no_rot||!1;isNaN(this.k0)&&(this.k0=1);var b=Math.sin(this.lat0),c=Math.cos(this.lat0),a=this.e*b;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(c,4));this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-a*a);b=la(this.e,this.lat0,b);c=this.bl/c*Math.sqrt((1-this.es)/(1-a*a));1>c*c&&(c=1);var f;if(isNaN(this.longc)){var a=la(this.e,this.lat1,Math.sin(this.lat1)),e=la(this.e,this.lat2,Math.sin(this.lat2));0<=this.lat0?this.el=(c+Math.sqrt(c*c-1))*Math.pow(b,this.bl):this.el=(c-Math.sqrt(c*c-1))*Math.pow(b,this.bl);a=Math.pow(a,this.bl);e=Math.pow(e,this.bl);b=.5*((f=this.el/a)-1/f);f=(this.el*this.el-e*a)/(this.el*this.el+e*a);a=(e-a)/(e+a);e=D(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(f*Math.tan(.5*this.bl*e)/a)/this.bl;this.long0=D(this.long0);f=D(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*f)/b);this.alpha=Math.asin(c*Math.sin(this.gamma0))}else f=0<=this.lat0?c+Math.sqrt(c*c-1):c-Math.sqrt(c*c-1),this.el=f*Math.pow(b,this.bl),this.gamma0=Math.asin(Math.sin(this.alpha)/c),this.long0=this.longc-Math.asin(.5*(f-1/f)*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:0<=this.lat0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(c*c-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(c*c-1),Math.cos(this.alpha))},forward:function(b){var c,a;a=b.y;c=D(b.x-this.long0);if(Math.abs(Math.abs(a)-y)<=A)c=0<a?-1:1,a=this.al/this.bl*Math.log(Math.tan(P+c*this.gamma0*.5)),c=-1*c*y*this.al/this.bl;else{a=la(this.e,a,Math.sin(a));a=this.el/Math.pow(a,this.bl);var f=.5*(a-1/a),e=Math.sin(this.bl*c);a=(f*Math.sin(this.gamma0)-e*Math.cos(this.gamma0))/(.5*(a+1/a));a=Math.abs(Math.abs(a)-1)<=A?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-a)/(1+a))/this.bl;c=Math.abs(Math.cos(this.bl*c))<=A?this.al*this.bl*c:this.al*Math.atan2(f*Math.cos(this.gamma0)+e*Math.sin(this.gamma0),Math.cos(this.bl*c))/this.bl}return this.no_rot?(b.x=this.x0+c,b.y=this.y0+a):(c-=this.uc,b.x=this.x0+a*Math.cos(this.alpha)+c*Math.sin(this.alpha),b.y=this.y0+c*Math.cos(this.alpha)-a*Math.sin(this.alpha)),b},inverse:function(b){var c,a;this.no_rot?(a=b.y-this.y0,c=b.x-this.x0):(a=(b.x-this.x0)*Math.cos(this.alpha)-(b.y-this.y0)*Math.sin(this.alpha),c=(b.y-this.y0)*Math.cos(this.alpha)+(b.x-this.x0)*Math.sin(this.alpha),c+=this.uc);var f=Math.exp(-1*this.bl*a/this.al);a=.5*(f-1/f);var e=Math.sin(this.bl*c/this.al),f=(e*Math.cos(this.gamma0)+a*Math.sin(this.gamma0))/(.5*(f+1/f)),g=Math.pow(this.el/Math.sqrt((1+f)/(1-f)),1/this.bl);return Math.abs(f-1)<A?(b.x=this.long0,b.y=y):Math.abs(f+1)<A?(b.x=this.long0,b.y=-1*y):(b.y=za(this.e,g),b.x=D(this.long0-Math.atan2(a*Math.cos(this.gamma0)-e*Math.sin(this.gamma0),Math.cos(this.bl*c/this.al))/this.bl)),b},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},Bc={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<A)){var b=this.b/this.a;this.e=Math.sqrt(1-b*b);var b=Math.sin(this.lat1),c=ta(this.e,b,Math.cos(this.lat1)),a=la(this.e,this.lat1,b),f=Math.sin(this.lat2),e=ta(this.e,f,Math.cos(this.lat2)),f=la(this.e,this.lat2,f),g=la(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>A?this.ns=Math.log(c/e)/Math.log(a/f):this.ns=b;isNaN(this.ns)&&(this.ns=b);this.f0=c/(this.ns*Math.pow(a,this.ns));this.rh=this.a*this.f0*Math.pow(g,this.ns);this.title||(this.title="Lambert Conformal Conic")}},forward:function(b){var c=b.x,a=b.y;Math.abs(2*Math.abs(a)-Math.PI)<=A&&(a=(0>a?-1:1)*(y-2*A));if(Math.abs(Math.abs(a)-y)>A)a=la(this.e,a,Math.sin(a)),a=this.a*this.f0*Math.pow(a,this.ns);else{if(0>=a*this.ns)return null;a=0}c=this.ns*D(c-this.long0);return b.x=this.k0*a*Math.sin(c)+this.x0,b.y=this.k0*(this.rh-a*Math.cos(c))+this.y0,b},inverse:function(b){var c,a,f,e,g=(b.x-this.x0)/this.k0,h=this.rh-(b.y-this.y0)/this.k0;0<this.ns?(c=Math.sqrt(g*g+h*h),a=1):(c=-Math.sqrt(g*g+h*h),a=-1);var m=0;if(0!==c&&(m=Math.atan2(a*g,a*h)),0!==c||0<this.ns){if(a=1/this.ns,f=Math.pow(c/(this.a*this.f0),a),-9999===(c=za(this.e,f)))return null}else c=-y;return e=D(m/this.ns+this.long0),b.x=e,b.y=c,b},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},Ib={init:function(){this.a=6377397.155;this.es=.006674372230614;this.e=Math.sqrt(this.es);this.lat0||(this.lat0=.863937979737193);this.long0||(this.long0=.4334234309119251);this.k0||(this.k0=.9999);this.s45=.785398163397448;this.s90=2*this.s45;this.fi0=this.lat0;this.e2=this.es;this.e=Math.sqrt(this.e2);this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2));this.uq=1.04216856380474;this.u0=Math.asin(Math.sin(this.fi0)/this.alfa);this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2);this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g;this.k1=this.k0;this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2));this.s0=1.37008346281555;this.n=Math.sin(this.s0);this.ro0=this.k1*this.n0/Math.tan(this.s0);this.ad=this.s90-this.uq},forward:function(b){var c,a,f,e,g,h,m,q=b.y,k=D(b.x-this.long0);return c=Math.pow((1+this.e*Math.sin(q))/(1-this.e*Math.sin(q)),this.alfa*this.e/2),a=2*(Math.atan(this.k*Math.pow(Math.tan(q/2+this.s45),this.alfa)/c)-this.s45),f=-k*this.alfa,e=Math.asin(Math.cos(this.ad)*Math.sin(a)+Math.sin(this.ad)*Math.cos(a)*Math.cos(f)),g=Math.asin(Math.cos(a)*Math.sin(f)/Math.cos(e)),h=this.n*g,m=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(e/2+this.s45),this.n),b.y=m*Math.cos(h)/1,b.x=m*Math.sin(h)/1,this.czech||(b.y*=-1,b.x*=-1),b},inverse:function(b){var c,a,f;c=b.x;b.x=b.y;b.y=c;this.czech||(b.y*=-1,b.x*=-1);c=Math.sqrt(b.x*b.x+b.y*b.y);f=Math.atan2(b.y,b.x)/Math.sin(this.s0);a=2*(Math.atan(Math.pow(this.ro0/c,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45);c=Math.asin(Math.cos(this.ad)*Math.sin(a)-Math.sin(this.ad)*Math.cos(a)*Math.cos(f));b.x=this.long0-Math.asin(Math.cos(a)*Math.sin(f)/Math.cos(c))/this.alfa;f=c;var e=a=0;do b.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(c/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(f))/(1-this.e*Math.sin(f)),this.e/2))-this.s45),1E-10>Math.abs(f-b.y)&&(a=1),f=b.y,e+=1;while(0===a&&15>e);return 15<=e?null:b},names:["Krovak","krovak"]},ja=function(b,c,a,f,e){return b*e-c*Math.sin(2*e)+a*Math.sin(4*e)-f*Math.sin(6*e)},wb=function(b){return 1-.25*b*(1+b/16*(3+1.25*b))},sa=function(b){return.375*b*(1+.25*b*(1+.46875*b))},kb=function(b){return.05859375*b*b*(1+.75*b)},cb=function(b){return 35/3072*b*b*b},db=function(b,c,a){c*=a;return b/Math.sqrt(1-c*c)},rb=function(b){return Math.abs(b)<y?b:b-(0>b?-1:1)*Math.PI},oa=function(b,c,a,f,e){var l,g;l=b/c;for(var h=0;15>h;h++)if(g=(b-(c*l-a*Math.sin(2*l)+f*Math.sin(4*l)-e*Math.sin(6*l)))/(c-2*a*Math.cos(2*l)+4*f*Math.cos(4*l)-6*e*Math.cos(6*l)),l+=g,1E-10>=Math.abs(g))return l;return NaN},Bb={init:function(){this.sphere||(this.e0=wb(this.es),this.e1=sa(this.es),this.e2=kb(this.es),this.e3=cb(this.es),this.ml0=this.a*ja(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(b){var c,a,f=b.x;a=b.y;if(f=D(f-this.long0),this.sphere)c=this.a*Math.asin(Math.cos(a)*Math.sin(f)),a=this.a*(Math.atan2(Math.tan(a),Math.cos(f))-this.lat0);else{var e=Math.sin(a),g=Math.cos(a),h=db(this.a,this.e,e),m=Math.tan(a)*Math.tan(a);c=f*Math.cos(a);var f=c*c,q=this.es*g*g/(1-this.es);c=h*c*(1-f*m*(1/6-(8-m+8*q)*f/120));a=this.a*ja(this.e0,this.e1,this.e2,this.e3,a)-this.ml0+h*e/g*f*(.5+(5-m+6*q)*f/24)}return b.x=c+this.x0,b.y=a+this.y0,b},inverse:function(b){b.x-=this.x0;b.y-=this.y0;var c,a,f=b.x/this.a;c=b.y/this.a;if(this.sphere)a=c+this.lat0,c=Math.asin(Math.sin(a)*Math.cos(f)),a=Math.atan2(Math.tan(f),Math.cos(a));else{a=oa(this.ml0/this.a+c,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-y)<=A)return b.x=this.long0,b.y=y,0>c&&(b.y*=-1),b;c=db(this.a,this.e,Math.sin(a));var e=Math.pow(Math.tan(a),2),f=f*this.a/c,g=f*f;c=a-c*Math.tan(a)/(c*c*c/this.a/this.a*(1-this.es))*f*f*(.5-(1+3*e)*f*f/24);a=f*(1-g*(e/3+(1+3*e)*e*g/15))/Math.cos(a)}return b.x=D(a+this.long0),b.y=rb(c),b},names:["Cassini","Cassini_Soldner","cass"]},Sa=function(b,c){var a;return 1E-7<b?(a=b*c,(1-b*b)*(c/(1-a*a)-.5/b*Math.log((1-a)/(1+a)))):2*c},Ta={init:function(){var b=Math.abs(this.lat0);if(Math.abs(b-y)<A?this.mode=0>this.lat0?this.S_POLE:this.N_POLE:Math.abs(b)<A?this.mode=this.EQUIT:this.mode=this.OBLIQ,0<this.es){var c;this.qp=Sa(this.e,1);this.mmf=.5/(1-this.es);var b=this.es,a=[];switch(this.apa=(a[0]=.3333333333333333*b,c=b*b,a[0]+=.17222222222222222*c,a[1]=.06388888888888888*c,c*=b,a[0]+=.10257936507936508*c,a[1]+=.0664021164021164*c,a[2]=.016415012942191543*c,a),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp);this.dd=1/this.rq;this.xmf=1;this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),c=Math.sin(this.lat0),this.sinb1=Sa(this.e,c)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*c*c)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(b){var c,a,f,e,g,h,m,q,k;e=b.x;var p=b.y;if(e=D(e-this.long0),this.sphere)if(g=Math.sin(p),h=Math.cos(p),f=Math.cos(e),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((a=this.mode===this.EQUIT?1+h*f:1+this.sinph0*g+this.cosph0*h*f)<=A)return null;c=(a=Math.sqrt(2/a))*h*Math.sin(e);a*=this.mode===this.EQUIT?g:this.cosph0*g-this.sinph0*h*f}else{if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(f=-f),Math.abs(p+this.phi0)<A)return null;a=P-.5*p;c=(a=2*(this.mode===this.S_POLE?Math.cos(a):Math.sin(a)))*Math.sin(e);a*=f}}else{switch(m=0,q=0,k=0,f=Math.cos(e),e=Math.sin(e),g=Math.sin(p),h=Sa(this.e,g),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(m=h/this.qp,q=Math.sqrt(1-m*m)),this.mode){case this.OBLIQ:k=1+this.sinb1*m+this.cosb1*q*f;break;case this.EQUIT:k=1+q*f;break;case this.N_POLE:k=y+p;h=this.qp-h;break;case this.S_POLE:k=p-y,h=this.qp+h}if(Math.abs(k)<A)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:k=Math.sqrt(2/k);a=this.mode===this.OBLIQ?this.ymf*k*(this.cosb1*m-this.sinb1*q*f):(k=Math.sqrt(2/(1+q*f)))*m*this.ymf;c=this.xmf*k*q*e;break;case this.N_POLE:case this.S_POLE:0<=h?(c=(k=Math.sqrt(h))*e,a=f*(this.mode===this.S_POLE?k:-k)):c=a=0}}return b.x=this.a*c+this.x0,b.y=this.a*a+this.y0,b},inverse:function(b){b.x-=this.x0;b.y-=this.y0;var c,a,f,e,g;c=b.x/this.a;var h=b.y/this.a;if(this.sphere){g=e=0;if(f=Math.sqrt(c*c+h*h),1<(a=.5*f))return null;switch(a=2*Math.asin(a),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(g=Math.sin(a),e=Math.cos(a)),this.mode){case this.EQUIT:a=Math.abs(f)<=A?0:Math.asin(h*g/f);c*=g;h=e*f;break;case this.OBLIQ:a=Math.abs(f)<=A?this.phi0:Math.asin(e*this.sinph0+h*g*this.cosph0/f);c*=g*this.cosph0;h=(e-Math.sin(a)*this.sinph0)*f;break;case this.N_POLE:h=-h;a=y-a;break;case this.S_POLE:a-=y}c=0!==h||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(c,h):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c/=this.dd,h*=this.dd,(g=Math.sqrt(c*c+h*h))<A)return b.x=0,b.y=this.phi0,b;e=2*Math.asin(.5*g/this.rq);f=Math.cos(e);c*=e=Math.sin(e);this.mode===this.OBLIQ?(a=f*this.sinb1+h*e*this.cosb1/g,h=g*this.cosb1*f-h*this.sinb1*e):(a=h*e/g,h=g*f)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(h=-h),!(a=c*c+h*h))return b.x=0,b.y=this.phi0,b;a=1-a/this.qp;this.mode===this.S_POLE&&(a=-a)}c=Math.atan2(c,h);h=Math.asin(a);a=this.apa;f=h+h;a=h+a[0]*Math.sin(f)+a[1]*Math.sin(f+f)+a[2]*Math.sin(f+f+f)}return b.x=D(this.long0+c),b.y=a,b},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},ra=function(b){return 1<Math.abs(b)&&(b=1<b?1:-1),Math.asin(b)},hc={init:function(){Math.abs(this.lat1+this.lat2)<A||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=ta(this.e3,this.sin_po,this.cos_po),this.qs1=Sa(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=ta(this.e3,this.sin_po,this.cos_po),this.qs2=Sa(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Sa(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>A?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(b){var c=b.x,a=b.y;this.sin_phi=Math.sin(a);this.cos_phi=Math.cos(a);var a=Sa(this.e3,this.sin_phi,this.cos_phi),a=this.a*Math.sqrt(this.c-this.ns0*a)/this.ns0,c=this.ns0*D(c-this.long0),f=this.rh-a*Math.cos(c)+this.y0;return b.x=a*Math.sin(c)+this.x0,b.y=f,b},inverse:function(b){var c,a,f,e,g,h;return b.x-=this.x0,b.y=this.rh-b.y+this.y0,0<=this.ns0?(c=Math.sqrt(b.x*b.x+b.y*b.y),f=1):(c=-Math.sqrt(b.x*b.x+b.y*b.y),f=-1),e=0,0!==c&&(e=Math.atan2(f*b.x,f*b.y)),f=c*this.ns0/this.a,this.sphere?h=Math.asin((this.c-f*f)/(2*this.ns0)):(a=(this.c-f*f)/this.ns0,h=this.phi1z(this.e3,a)),g=D(e/this.ns0+this.long0),b.x=g,b.y=h,b},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(b,c){var a,f,e,g,l,h=ra(.5*c);if(b<A)return h;for(var m=b*b,q=1;25>=q;q++)if(a=Math.sin(h),f=Math.cos(h),e=b*a,g=1-e*e,l=.5*g*g/f*(c/(1-m)-a/g+.5/b*Math.log((1-e)/(1+e))),h+=l,1E-7>=Math.abs(l))return h;return null}},Cb={init:function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1E3*this.a;this.rc=1},forward:function(b){var c,a,f,e,g,h,m,q=b.y;return f=D(b.x-this.long0),c=Math.sin(q),a=Math.cos(q),e=Math.cos(f),0<(g=this.sin_p14*c+this.cos_p14*a*e)||Math.abs(g)<=A?(h=this.x0+1*this.a*a*Math.sin(f)/g,m=this.y0+1*this.a*(this.cos_p14*c-this.sin_p14*a*e)/g):(h=this.x0+this.infinity_dist*a*Math.sin(f),m=this.y0+this.infinity_dist*(this.cos_p14*c-this.sin_p14*a*e)),b.x=h,b.y=m,b},inverse:function(b){var c,a,f,e,g,h;return b.x=(b.x-this.x0)/this.a,b.y=(b.y-this.y0)/this.a,b.x/=this.k0,b.y/=this.k0,(c=Math.sqrt(b.x*b.x+b.y*b.y))?(e=Math.atan2(c,this.rc),a=Math.sin(e),f=Math.cos(e),h=ra(f*this.sin_p14+b.y*a*this.cos_p14/c),g=Math.atan2(b.x*a,c*this.cos_p14*f-b.y*this.sin_p14*a),g=D(this.long0+g)):(h=this.phic0,g=0),b.x=g,b.y=h,b},names:["gnom"]},Db={init:function(){this.sphere||(this.k0=ta(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(b){var c,a;a=b.y;c=D(b.x-this.long0);this.sphere?(c=this.x0+this.a*c*Math.cos(this.lat_ts),a=this.y0+this.a*Math.sin(a)/Math.cos(this.lat_ts)):(a=Sa(this.e,Math.sin(a)),c=this.x0+this.a*this.k0*c,a=this.y0+this.a*a*.5/this.k0);return b.x=c,b.y=a,b},inverse:function(b){b.x-=this.x0;b.y-=this.y0;var c,a;if(this.sphere)c=D(this.long0+b.x/this.a/Math.cos(this.lat_ts)),a=Math.asin(b.y/this.a*Math.cos(this.lat_ts));else{a:if(c=this.e,a=2*b.y*this.k0/this.a,1E-6>Math.abs(Math.abs(a)-(1-(1-c*c)/(2*c)*Math.log((1-c)/(1+c)))))c=0>a?-1*y:y;else{for(var f,e,g,h,m=Math.asin(.5*a),q=0;30>q;q++)if(e=Math.sin(m),g=Math.cos(m),h=c*e,f=Math.pow(1-h*h,2)/(2*g)*(a/(1-c*c)-e/(1-h*h)+.5/c*Math.log((1-h)/(1+h))),m+=f,1E-10>=Math.abs(f)){c=m;break a}c=NaN}a=c;c=D(this.long0+b.x/(this.a*this.k0))}return b.x=c,b.y=a,b},names:["cea"]},ic={init:function(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Equidistant Cylindrical (Plate Carre)";this.rc=Math.cos(this.lat_ts)},forward:function(b){var c=b.y,a=D(b.x-this.long0),c=rb(c-this.lat0);return b.x=this.x0+this.a*a*this.rc,b.y=this.y0+this.a*c,b},inverse:function(b){var c=b.y;return b.x=D(this.long0+(b.x-this.x0)/(this.a*this.rc)),b.y=rb(this.lat0+(c-this.y0)/this.a),b},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},jc={init:function(){this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=wb(this.es);this.e1=sa(this.es);this.e2=kb(this.es);this.e3=cb(this.es);this.ml0=this.a*ja(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(b){var c,a,f,e=b.y,g=D(b.x-this.long0);(f=g*Math.sin(e),this.sphere)?Math.abs(e)<=A?(c=this.a*g,a=-1*this.a*this.lat0):(c=this.a*Math.sin(f)/Math.tan(e),a=this.a*(rb(e-this.lat0)+(1-Math.cos(f))/Math.tan(e))):Math.abs(e)<=A?(c=this.a*g,a=-1*this.ml0):(a=db(this.a,this.e,Math.sin(e))/Math.tan(e),c=a*Math.sin(f),a=this.a*ja(this.e0,this.e1,this.e2,this.e3,e)-this.ml0+a*(1-Math.cos(f)));return b.x=c+this.x0,b.y=a+this.y0,b},inverse:function(b){var c,a,f,e,g,h,m;if(c=b.x-this.x0,f=b.y-this.y0,this.sphere)if(Math.abs(f+this.a*this.lat0)<=A)c=D(c/this.a+this.long0),a=0;else{e=this.lat0+f/this.a;g=c*c/this.a/this.a+e*e;h=e;var q;for(f=20;f;--f)if(q=Math.tan(h),m=-1*(e*(h*q+1)-h-.5*(h*h+g)*q)/((h-e)/q-1),h+=m,Math.abs(m)<=A){a=h;break}c=D(this.long0+Math.asin(c*Math.tan(h)/this.a)/Math.sin(a))}else if(Math.abs(f+this.ml0)<=A)a=0,c=D(this.long0+c/this.a);else{e=(this.ml0+f)/this.a;g=c*c/this.a/this.a+e*e;h=e;var k,p,w,u,J;for(f=20;f;--f)if(J=this.e*Math.sin(h),k=Math.sqrt(1-J*J)*Math.tan(h),p=this.a*ja(this.e0,this.e1,this.e2,this.e3,h),w=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),u=p/this.a,m=(e*(k*u+1)-u-.5*k*(u*u+g))/(this.es*Math.sin(2*h)*(u*u+g-2*e*u)/(4*k)+(e-u)*(k*w-2/Math.sin(2*h))-w),h-=m,Math.abs(m)<=A){a=h;break}k=Math.sqrt(1-this.es*Math.pow(Math.sin(a),2))*Math.tan(a);c=D(this.long0+Math.asin(c*k/this.a)/Math.sin(a))}return b.x=c,b.y=a,b},names:["Polyconic","poly"]},Rc={init:function(){this.A=[];this.A[1]=.6399175073;this.A[2]=-.1358797613;this.A[3]=.063294409;this.A[4]=-.02526853;this.A[5]=.0117879;this.A[6]=-.0055161;this.A[7]=.0026906;this.A[8]=-.001333;this.A[9]=6.7E-4;this.A[10]=-3.4E-4;this.B_re=[];this.B_im=[];this.B_re[1]=.7557853228;this.B_im[1]=0;this.B_re[2]=.249204646;this.B_im[2]=.003371507;this.B_re[3]=-.001541739;this.B_im[3]=.04105856;this.B_re[4]=-.10162907;this.B_im[4]=.01727609;this.B_re[5]=-.26623489;this.B_im[5]=-.36249218;this.B_re[6]=-.6870983;this.B_im[6]=-1.1651967;this.C_re=[];this.C_im=[];this.C_re[1]=1.3231270439;this.C_im[1]=0;this.C_re[2]=-.577245789;this.C_im[2]=-.007809598;this.C_re[3]=.508307513;this.C_im[3]=-.112208952;this.C_re[4]=-.15094762;this.C_im[4]=.18200602;this.C_re[5]=1.01418179;this.C_im[5]=1.64497696;this.C_re[6]=1.9660549;this.C_im[6]=2.5127645;this.D=[];this.D[1]=1.5627014243;this.D[2]=.5185406398;this.D[3]=-.03333098;this.D[4]=-.1052906;this.D[5]=-.0368594;this.D[6]=.007317;this.D[7]=.0122;this.D[8]=.00394;this.D[9]=-.0013},forward:function(b){var c,a=b.x-this.long0,f=(b.y-this.lat0)/Ma*1E-5,e=1,g=0;for(c=1;10>=c;c++)e*=f,g+=this.A[c]*e;var e=g,g=1,h=0,m=0,q=0;for(c=1;6>=c;c++)f=h*e+g*a,g=g*e-h*a,h=f,m=m+this.B_re[c]*g-this.B_im[c]*h,q=q+this.B_im[c]*g+this.B_re[c]*h;return b.x=q*this.a+this.x0,b.y=m*this.a+this.y0,b},inverse:function(b){var c,a,f=(b.y-this.y0)/this.a,e=(b.x-this.x0)/this.a,g=1,h=0,m=0,q=0;for(c=1;6>=c;c++)a=h*f+g*e,g=g*f-h*e,h=a,m=m+this.C_re[c]*g-this.C_im[c]*h,q=q+this.C_im[c]*g+this.C_re[c]*h;for(a=0;a<this.iterations;a++){var k,p=m,w=q,g=f,h=e;for(c=2;6>=c;c++)k=w*m+p*q,p=p*m-w*q,w=k,g+=(c-1)*(this.B_re[c]*p-this.B_im[c]*w),h+=(c-1)*(this.B_im[c]*p+this.B_re[c]*w);var p=1,w=0,u=this.B_re[1],J=this.B_im[1];for(c=2;6>=c;c++)k=w*m+p*q,p=p*m-w*q,w=k,u+=c*(this.B_re[c]*p-this.B_im[c]*w),J+=c*(this.B_im[c]*p+this.B_re[c]*w);q=u*u+J*J;m=(g*u+h*J)/q;q=(h*u-g*J)/q}f=m;e=1;m=0;for(c=1;9>=c;c++)e*=f,m+=this.D[c]*e;c=this.lat0+m*Ma*1E5;return b.x=this.long0+q,b.y=c,b},names:["New_Zealand_Map_Grid","nzmg"]},kc={init:function(){},forward:function(b){var c=b.y,a=D(b.x-this.long0),c=this.y0+this.a*Math.log(Math.tan(Math.PI/4+c/2.5))*1.25;return b.x=this.x0+this.a*a,b.y=c,b},inverse:function(b){b.x-=this.x0;b.y-=this.y0;var c=D(this.long0+b.x/this.a),a=2.5*(Math.atan(Math.exp(.8*b.y/this.a))-Math.PI/4);return b.x=c,b.y=a,b},names:["Miller_Cylindrical","mill"]},Vb={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=ec(this.es)},forward:function(b){var c,a;c=b.x;a=b.y;if(c=D(c-this.long0),this.sphere){if(this.m)for(var f=this.n*Math.sin(a),e=20;e;--e){var g=(this.m*a+Math.sin(a)-f)/(this.m+Math.cos(a));if(a-=g,Math.abs(g)<A)break}else a=1!==this.n?Math.asin(this.n*Math.sin(a)):a;c=this.a*this.C_x*c*(this.m+Math.cos(a));a*=this.a*this.C_y}else f=Math.sin(a),e=Math.cos(a),a=this.a*gb(a,f,e,this.en),c=this.a*c*e/Math.sqrt(1-this.es*f*f);return b.x=c,b.y=a,b},inverse:function(b){var c,a,f,e;return b.x-=this.x0,f=b.x/this.a,b.y-=this.y0,c=b.y/this.a,this.sphere?(c/=this.C_y,f/=this.C_x*(this.m+Math.cos(c)),this.m?c=ra((this.m*c+Math.sin(c))/this.n):1!==this.n&&(c=ra(Math.sin(c)/this.n)),f=D(f+this.long0),c=rb(c)):(c=$a(b.y/this.a,this.es,this.en),(e=Math.abs(c))<y?(e=Math.sin(c),a=this.long0+b.x*Math.sqrt(1-this.es*e*e)/(this.a*Math.cos(c)),f=D(a)):e-A<y&&(f=this.long0)),b.x=f,b.y=c,b},names:["Sinusoidal","sinu"]},sb={init:function(){},forward:function(b){for(var c=b.y,a=D(b.x-this.long0),f=c,e=Math.PI*Math.sin(c);;){var g=-(f+Math.sin(f)-e)/(1+Math.cos(f));if(f+=g,Math.abs(g)<A)break}f/=2;Math.PI/2-Math.abs(c)<A&&(a=0);c=1.4142135623731*this.a*Math.sin(f)+this.y0;return b.x=.900316316158*this.a*a*Math.cos(f)+this.x0,b.y=c,b},inverse:function(b){var c;b.x-=this.x0;b.y-=this.y0;c=b.y/(1.4142135623731*this.a);.999999999999<Math.abs(c)&&(c=.999999999999);c=Math.asin(c);var a=D(this.long0+b.x/(.900316316158*this.a*Math.cos(c)));a<-Math.PI&&(a=-Math.PI);a>Math.PI&&(a=Math.PI);c=(2*c+Math.sin(2*c))/Math.PI;1<Math.abs(c)&&(c=1);c=Math.asin(c);return b.x=a,b.y=c,b},names:["Mollweide","moll"]},xb={init:function(){Math.abs(this.lat1+this.lat2)<A||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=wb(this.es),this.e1=sa(this.es),this.e2=kb(this.es),this.e3=cb(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=ta(this.e,this.sinphi,this.cosphi),this.ml1=ja(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<A?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=ta(this.e,this.sinphi,this.cosphi),this.ml2=ja(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=ja(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(b){var c,a=b.x;c=b.y;this.sphere||(c=ja(this.e0,this.e1,this.e2,this.e3,c));c=this.a*(this.g-c);var a=this.ns*D(a-this.long0),f=this.y0+this.rh-c*Math.cos(a);return b.x=this.x0+c*Math.sin(a),b.y=f,b},inverse:function(b){b.x-=this.x0;b.y=this.rh-b.y+this.y0;var c,a,f,e;0<=this.ns?(a=Math.sqrt(b.x*b.x+b.y*b.y),c=1):(a=-Math.sqrt(b.x*b.x+b.y*b.y),c=-1);var g=0;return(0!==a&&(g=Math.atan2(c*b.x,c*b.y)),this.sphere)?(e=D(this.long0+g/this.ns),f=rb(this.g-a/this.a),b.x=e,b.y=f,b):(f=oa(this.g-a/this.a,this.e0,this.e1,this.e2,this.e3),e=D(this.long0+g/this.ns),b.x=e,b.y=f,b)},names:["Equidistant_Conic","eqdc"]},lc={init:function(){this.R=this.a},forward:function(b){var c,a,f=b.y;c=D(b.x-this.long0);Math.abs(f)<=A&&(a=this.y0);var e=ra(2*Math.abs(f/Math.PI));(Math.abs(c)<=A||Math.abs(Math.abs(f)-y)<=A)&&(a=0<=f?this.y0+Math.PI*this.R*Math.tan(.5*e):this.y0+Math.PI*this.R*-Math.tan(.5*e));var g=.5*Math.abs(Math.PI/c-c/Math.PI),h=g*g,m=Math.sin(e),e=Math.cos(e),e=e/(m+e-1),m=e*(2/m-1),q=m*m,k=Math.PI*this.R*(g*(e-q)+Math.sqrt(h*(e-q)*(e-q)-(q+h)*(e*e-q)))/(q+h);0>c&&(k=-k);c=this.x0+k;e=h+e;return k=Math.PI*this.R*(m*e-g*Math.sqrt((q+h)*(h+1)-e*e))/(q+h),a=0<=f?this.y0+k:this.y0-k,b.x=c,b.y=a,b},inverse:function(b){var c,a,f,e,g,h,m,q,k,p,w,u,J;return b.x-=this.x0,b.y-=this.y0,w=Math.PI*this.R,f=b.x/w,e=b.y/w,g=f*f+e*e,h=-Math.abs(e)*(1+g),m=h-2*e*e+f*f,q=-2*h+1+2*e*e+g*g,J=e*e/q+(2*m*m*m/q/q/q-9*h*m/q/q)/27,k=(h-m*m/3/q)/q,p=2*Math.sqrt(-k/3),w=3*J/k/p,1<Math.abs(w)&&(w=0<=w?1:-1),u=Math.acos(w)/3,a=0<=b.y?(-p*Math.cos(u+Math.PI/3)-m/3/q)*Math.PI:-(-p*Math.cos(u+Math.PI/3)-m/3/q)*Math.PI,c=Math.abs(f)<A?this.long0:D(this.long0+Math.PI*(g-1+Math.sqrt(1+2*(f*f-e*e)+g*g))/2/f),b.x=c,b.y=a,b},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},mb={init:function(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)},forward:function(b){var c,a,f,e,g,h,m,q,k,p,w,u,J,v,N,x,ua,z,ga,E,H,Y,F,C=b.y,ma=Math.sin(b.y),I=Math.cos(b.y),G=D(b.x-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=A?(b.x=this.x0+this.a*(y-C)*Math.sin(G),b.y=this.y0-this.a*(y-C)*Math.cos(G),b):Math.abs(this.sin_p12+1)<=A?(b.x=this.x0+this.a*(y+C)*Math.sin(G),b.y=this.y0+this.a*(y+C)*Math.cos(G),b):(z=this.sin_p12*ma+this.cos_p12*I*Math.cos(G),x=Math.acos(z),ua=x/Math.sin(x),b.x=this.x0+this.a*ua*I*Math.sin(G),b.y=this.y0+this.a*ua*(this.cos_p12*ma-this.sin_p12*I*Math.cos(G)),b):(c=wb(this.es),a=sa(this.es),f=kb(this.es),e=cb(this.es),Math.abs(this.sin_p12-1)<=A?(g=this.a*ja(c,a,f,e,y),h=this.a*ja(c,a,f,e,C),b.x=this.x0+(g-h)*Math.sin(G),b.y=this.y0-(g-h)*Math.cos(G),b):Math.abs(this.sin_p12+1)<=A?(g=this.a*ja(c,a,f,e,y),h=this.a*ja(c,a,f,e,C),b.x=this.x0+(g+h)*Math.sin(G),b.y=this.y0+(g+h)*Math.cos(G),b):(m=ma/I,q=db(this.a,this.e,this.sin_p12),k=db(this.a,this.e,ma),p=Math.atan((1-this.es)*m+this.es*q*this.sin_p12/(k*I)),w=Math.atan2(Math.sin(G),this.cos_p12*Math.tan(p)-this.sin_p12*Math.cos(G)),ga=0===w?Math.asin(this.cos_p12*Math.sin(p)-this.sin_p12*Math.cos(p)):Math.abs(Math.abs(w)-Math.PI)<=A?-Math.asin(this.cos_p12*Math.sin(p)-this.sin_p12*Math.cos(p)):Math.asin(Math.sin(G)*Math.cos(p)/Math.sin(w)),u=this.e*this.sin_p12/Math.sqrt(1-this.es),J=this.e*this.cos_p12*Math.cos(w)/Math.sqrt(1-this.es),v=u*J,N=J*J,E=ga*ga,H=E*ga,Y=H*ga,F=Y*ga,x=q*ga*(1-E*N*(1-N)/6+H/8*v*(1-2*N)+Y/120*(N*(4-7*N)-3*u*u*(1-7*N))-F/48*v),b.x=this.x0+x*Math.sin(w),b.y=this.y0+x*Math.cos(w),b))},inverse:function(b){b.x-=this.x0;b.y-=this.y0;var c,a,f,e,g,h,m,q,k,p,w,u,J,v,N,x,ua,z,ga,E,H,Y,F;return this.sphere?(c=Math.sqrt(b.x*b.x+b.y*b.y))>2*y*this.a?void 0:(a=c/this.a,f=Math.sin(a),e=Math.cos(a),g=this.long0,Math.abs(c)<=A?h=this.lat0:(h=ra(e*this.sin_p12+b.y*f*this.cos_p12/c),m=Math.abs(this.lat0)-y,g=D(Math.abs(m)<=A?0<=this.lat0?this.long0+Math.atan2(b.x,-b.y):this.long0-Math.atan2(-b.x,b.y):this.long0+Math.atan2(b.x*f,c*this.cos_p12*e-b.y*this.sin_p12*f))),b.x=g,b.y=h,b):(q=wb(this.es),k=sa(this.es),p=kb(this.es),w=cb(this.es),Math.abs(this.sin_p12-1)<=A?(u=this.a*ja(q,k,p,w,y),c=Math.sqrt(b.x*b.x+b.y*b.y),J=u-c,h=oa(J/this.a,q,k,p,w),g=D(this.long0+Math.atan2(b.x,-1*b.y)),b.x=g,b.y=h,b):Math.abs(this.sin_p12+1)<=A?(u=this.a*ja(q,k,p,w,y),c=Math.sqrt(b.x*b.x+b.y*b.y),J=c-u,h=oa(J/this.a,q,k,p,w),g=D(this.long0+Math.atan2(b.x,b.y)),b.x=g,b.y=h,b):(c=Math.sqrt(b.x*b.x+b.y*b.y),x=Math.atan2(b.x,b.y),v=db(this.a,this.e,this.sin_p12),ua=Math.cos(x),z=this.e*this.cos_p12*ua,ga=-z*z/(1-this.es),E=3*this.es*(1-ga)*this.sin_p12*this.cos_p12*ua/(1-this.es),H=c/v,Y=H-ga*(1+ga)*Math.pow(H,3)/6-E*(1+3*ga)*Math.pow(H,4)/24,F=1-ga*Y*Y/2-H*Y*Y*Y/6,N=Math.asin(this.sin_p12*Math.cos(Y)+this.cos_p12*Math.sin(Y)*ua),g=D(this.long0+Math.asin(Math.sin(x)*Math.sin(Y)/Math.cos(N))),h=Math.atan((1-this.es*F*this.sin_p12/Math.sin(N))*Math.tan(N)/(1-this.es)),b.x=g,b.y=h,b))},names:["Azimuthal_Equidistant","aeqd"]},Eb={init:function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0)},forward:function(b){var c,a,f,e,g,h,m,q=b.y;return f=D(b.x-this.long0),c=Math.sin(q),a=Math.cos(q),e=Math.cos(f),(0<(g=this.sin_p14*c+this.cos_p14*a*e)||Math.abs(g)<=A)&&(h=1*this.a*a*Math.sin(f),m=this.y0+1*this.a*(this.cos_p14*c-this.sin_p14*a*e)),b.x=h,b.y=m,b},inverse:function(b){var c,a,f,e,g,h,m;return b.x-=this.x0,b.y-=this.y0,c=Math.sqrt(b.x*b.x+b.y*b.y),a=ra(c/this.a),f=Math.sin(a),e=Math.cos(a),h=this.long0,Math.abs(c)<=A?(m=this.lat0,b.x=h,b.y=m,b):(m=ra(e*this.sin_p14+b.y*f*this.cos_p14/c),g=Math.abs(this.lat0)-y,Math.abs(g)<=A?(h=D(0<=this.lat0?this.long0+Math.atan2(b.x,-b.y):this.long0-Math.atan2(-b.x,b.y)),b.x=h,b.y=m,b):(h=D(this.long0+Math.atan2(b.x*f,c*this.cos_p14*e-b.y*this.sin_p14*f)),b.x=h,b.y=m,b))},names:["ortho"]},U={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4},Cc={init:function(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Quadrilateralized Spherical Cube";this.lat0>=y-P/2?this.face=5:this.lat0<=-(y-P/2)?this.face=6:Math.abs(this.long0)<=P?this.face=1:Math.abs(this.long0)<=y+P?this.face=0<this.long0?2:4:this.face=3;0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(b){var c,a,f,e,g,h,m=0,q=0,k={value:0};if(b.x-=this.long0,c=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(b.y)):b.y,a=b.x,5===this.face)e=y-c,a>=P&&a<=y+P?(k.value=U.AREA_0,f=a-y):a>y+P||a<=-(y+P)?(k.value=U.AREA_1,f=0<a?a-T:a+T):a>-(y+P)&&a<=-P?(k.value=U.AREA_2,f=a+y):(k.value=U.AREA_3,f=a);else if(6===this.face)e=y+c,a>=P&&a<=y+P?(k.value=U.AREA_0,f=-a+y):a<P&&a>=-P?(k.value=U.AREA_1,f=-a):a<-P&&a>=-(y+P)?(k.value=U.AREA_2,f=-a-y):(k.value=U.AREA_3,f=0<a?-a+T:-a-T);else{var p,w;2===this.face?a=va(a,+y):3===this.face?a=va(a,+T):4===this.face&&(a=va(a,-y));p=Math.sin(c);c=Math.cos(c);w=Math.sin(a);a=c*Math.cos(a);c*=w;1===this.face?f=Ga(e=Math.acos(a),p,c,k):2===this.face?f=Ga(e=Math.acos(c),p,-a,k):3===this.face?f=Ga(e=Math.acos(-a),p,-c,k):4===this.face?f=Ga(e=Math.acos(-c),p,a,k):(e=f=0,k.value=U.AREA_0)}return h=Math.atan(12/T*(f+Math.acos(Math.sin(f)*Math.cos(P))-y)),g=Math.sqrt((1-Math.cos(e))/(Math.cos(h)*Math.cos(h))/(1-Math.cos(Math.atan(1/Math.cos(f))))),k.value===U.AREA_1?h+=y:k.value===U.AREA_2?h+=T:k.value===U.AREA_3&&(h+=1.5*T),m=g*Math.cos(h),q=g*Math.sin(h),m=m*this.a+this.x0,q=q*this.a+this.y0,b.x=m,b.y=q,b},inverse:function(b){var c,a,f,e,g,h,m,q,k,p=0,w=0;if(b.x=(b.x-this.x0)/this.a,b.y=(b.y-this.y0)/this.a,a=Math.atan(Math.sqrt(b.x*b.x+b.y*b.y)),c=Math.atan2(b.y,b.x),0<=b.x&&b.x>=Math.abs(b.y)?w=U.AREA_0:0<=b.y&&b.y>=Math.abs(b.x)?(w=U.AREA_1,c-=y):0>b.x&&-b.x>=Math.abs(b.y)?(w=U.AREA_2,c=0>c?c+T:c-T):(w=U.AREA_3,c+=y),k=T/12*Math.tan(c),g=Math.sin(k)/(Math.cos(k)-1/Math.sqrt(2)),h=Math.atan(g),f=Math.cos(c),e=Math.tan(a),-1>(m=1-f*f*e*e*(1-Math.cos(Math.atan(1/Math.cos(h)))))?m=-1:1<m&&(m=1),5===this.face)q=Math.acos(m),k=y-q,w===U.AREA_0?p=h+y:w===U.AREA_1?p=0>h?h+T:h-T:w===U.AREA_2?p=h-y:p=h;else if(6===this.face)q=Math.acos(m),k=q-y,w===U.AREA_0?p=-h+y:w===U.AREA_1?p=-h:w===U.AREA_2?p=-h-y:p=0>h?-h-T:-h+T;else{var u;k=(q=m)*q;p=1<=(k+=(u=1<=k?0:Math.sqrt(1-k)*Math.sin(h))*u)?0:Math.sqrt(1-k);w===U.AREA_1?(k=p,p=-u,u=k):w===U.AREA_2?(p=-p,u=-u):w===U.AREA_3&&(k=p,p=u,u=-k);2===this.face?(k=q,q=-p,p=k):3===this.face?(q=-q,p=-p):4===this.face&&(k=q,q=p,p=-k);k=Math.acos(-u)-y;p=Math.atan2(p,q);2===this.face?p=va(p,-y):3===this.face?p=va(p,-T):4===this.face&&(p=va(p,+y))}0!==this.es&&(w=0>k?1:0,h=Math.tan(k),h=this.b/Math.sqrt(h*h+this.one_minus_f_squared),k=Math.atan(Math.sqrt(this.a*this.a-h*h)/(this.one_minus_f*h)),w&&(k=-k));return p+=this.long0,b.x=p,b.y=k,b},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},Fb=[[1,2.2199E-17,-7.15515E-5,3.1103E-6],[.9986,-4.82243E-4,-2.4897E-5,-1.3309E-6],[.9954,-8.3103E-4,-4.48605E-5,-9.86701E-7],[.99,-.00135364,-5.9661E-5,3.6777E-6],[.9822,-.00167442,-4.49547E-6,-5.72411E-6],[.973,-.00214868,-9.03571E-5,1.8736E-8],[.96,-.00305085,-9.00761E-5,1.64917E-6],[.9427,-.00382792,-6.53386E-5,-2.6154E-6],[.9216,-.00467746,-1.0457E-4,4.81243E-6],[.8962,-.00536223,-3.23831E-5,-5.43432E-6],[.8679,-.00609363,-1.13898E-4,3.32484E-6],[.835,-.00698325,-6.40253E-5,9.34959E-7],[.7986,-.00755338,-5.00009E-5,9.35324E-7],[.7597,-.00798324,-3.5971E-5,-2.27626E-6],[.7186,-.00851367,-7.01149E-5,-8.6303E-6],[.6732,-.00986209,-1.99569E-4,1.91974E-5],[.6213,-.010418,8.83923E-5,6.24051E-6],[.5722,-.00906601,1.82E-4,6.24051E-6],[.5322,-.00677797,2.75608E-4,6.24051E-6]],Ra=[[-5.20417E-18,.0124,1.21431E-18,-8.45284E-11],[.062,.0124,-1.26793E-9,4.22642E-10],[.124,.0124,5.07171E-9,-1.60604E-9],[.186,.0123999,-1.90189E-8,6.00152E-9],[.248,.0124002,7.10039E-8,-2.24E-8],[.31,.0123992,-2.64997E-7,8.35986E-8],[.372,.0124029,9.88983E-7,-3.11994E-7],[.434,.0123893,-3.69093E-6,-4.35621E-7],[.4958,.0123198,-1.02252E-5,-3.45523E-7],[.5571,.0121916,-1.54081E-5,-5.82288E-7],[.6176,.0119938,-2.41424E-5,-5.25327E-7],[.6769,.011713,-3.20223E-5,-5.16405E-7],[.7346,.0113541,-3.97684E-5,-6.09052E-7],[.7903,.0109107,-4.89042E-5,-1.04739E-6],[.8435,.0103431,-6.4615E-5,-1.40374E-9],[.8936,.00969686,-6.4636E-5,-8.547E-6],[.9394,.00840947,-1.92841E-4,-4.2106E-6],[.9761,.00616527,-2.56E-4,-4.2106E-6],[1,.00328947,-3.19159E-4,-4.2106E-6]],Wb=Ca/5,Dc=1/Wb,Gb=function(b,c){return b[0]+c*(b[1]+c*(b[2]+c*b[3]))},Ec={init:function(){this.x0=this.x0||0;this.y0=this.y0||0;this.long0=this.long0||0;this.es=0;this.title=this.title||"Robinson"},forward:function(b){var c=D(b.x-this.long0),a=Math.abs(b.y),f=Math.floor(a*Wb);0>f?f=0:18<=f&&(f=17);a=Ca*(a-Dc*f);c={x:Gb(Fb[f],a)*c,y:Gb(Ra[f],a)};return 0>b.y&&(c.y=-c.y),c.x=c.x*this.a*.8487+this.x0,c.y=c.y*this.a*1.3523+this.y0,c},inverse:function(b){var c={x:(b.x-this.x0)/(.8487*this.a),y:Math.abs(b.y-this.y0)/(1.3523*this.a)};if(1<=c.y)c.x/=Fb[18][0],c.y=0>b.y?-y:y;else{var a=Math.floor(18*c.y);for(0>a?a=0:18<=a&&(a=17);;)if(Ra[a][0]>c.y)--a;else{if(!(Ra[a+1][0]<=c.y))break;++a}var f=Ra[a],e=5*(c.y-f[0])/(Ra[a+1][0]-f[0]),e=eb(function(b){return(Gb(f,b)-c.y)/(f[1]+b*(2*f[2]+3*b*f[3]))},e,A,100);c.x/=Gb(Fb[a],e);c.y=(5*a+e)*ea;0>b.y&&(c.y=-c.y)}return c.x=D(c.x+this.long0),c},names:["Robinson","robin"]};return C.defaultDatum="WGS84",C.Proj=F,C.WGS84=new C.Proj("WGS84"),C.Point=O,C.toPoint=ga,C.defs=g,C.transform=aa,C.mgrs=dc,C.version="2.5.0",function(b){b.Proj.projections.add(yb);b.Proj.projections.add(pb);b.Proj.projections.add(Qb);b.Proj.projections.add(wc);b.Proj.projections.add(xc);b.Proj.projections.add(yc);b.Proj.projections.add(zc);b.Proj.projections.add(Bc);b.Proj.projections.add(Ib);b.Proj.projections.add(Bb);b.Proj.projections.add(Ta);b.Proj.projections.add(hc);b.Proj.projections.add(Cb);b.Proj.projections.add(Db);b.Proj.projections.add(ic);b.Proj.projections.add(jc);b.Proj.projections.add(Rc);b.Proj.projections.add(kc);b.Proj.projections.add(Vb);b.Proj.projections.add(sb);b.Proj.projections.add(xb);b.Proj.projections.add(lc);b.Proj.projections.add(mb);b.Proj.projections.add(Eb);b.Proj.projections.add(Cc);b.Proj.projections.add(Ec)}(C),C});(function(a){var e,k;if("function"===typeof define&&define.amd)define(["leaflet","proj4"],a);else if("object"===typeof module&&"object"===typeof module.exports)e=require("leaflet"),k=require("proj4"),module.exports=a(e,k);else{if("undefined"===typeof window.L||"undefined"===typeof window.proj4)throw"Leaflet and proj4 must be loaded first";a(window.L,window.proj4)}})(function(a,e){e.__esModule&&e["default"]&&(e=e["default"]);a.Proj={};a.Proj._isProj4Obj=function(a){return"undefined"!==typeof a.inverse&&"undefined"!==typeof a.forward};a.Proj.Projection=a.Class.extend({initialize:function(e,f,h){var m=a.Proj._isProj4Obj(e);this._proj=m?e:this._projFromCodeDef(e,f);this.bounds=m?f:h},project:function(e){e=this._proj.forward([e.lng,e.lat]);return new a.Point(e[0],e[1])},unproject:function(e,f){var h=this._proj.inverse([e.x,e.y]);return new a.LatLng(h[1],h[0],f)},_projFromCodeDef:function(a,f){if(f)e.defs(a,f);else if(void 0===e.defs[a]){var h=a.split(":");3<h.length&&(a=h[h.length-3]+":"+h[h.length-1]);if(void 0===e.defs[a])throw"No projection definition for code "+a;}return e(a)}});a.Proj.CRS=a.Class.extend({includes:a.CRS,options:{transformation:new a.Transformation(1,0,-1,0)},initialize:function(e,f,h){var m;a.Proj._isProj4Obj(e)?(m=e.srsCode,h=f||{},this.projection=new a.Proj.Projection(e,h.bounds)):(m=e,h=h||{},this.projection=new a.Proj.Projection(m,f,h.bounds));a.Util.setOptions(this,h);this.code=m;this.transformation=this.options.transformation;this.options.origin&&(this.transformation=new a.Transformation(1,-this.options.origin[0],-1,this.options.origin[1]));if(this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions)for(this._scales=[],e=this.options.resolutions.length-1;0<=e;e--)this.options.resolutions[e]&&(this._scales[e]=1/this.options.resolutions[e]);this.infinite=!this.options.bounds},scale:function(a){var f=Math.floor(a),e;if(a===f)return this._scales[a];e=this._scales[f];return e+(this._scales[f+1]-e)*(a-f)},zoom:function(a){var f=this._closestElement(this._scales,a),e=this._scales.indexOf(f),m;if(a===f)return e;if(void 0===f)return-Infinity;m=this._scales[e+1];return void 0===m?Infinity:(a-f)/(m-f)+e},distance:a.CRS.Earth.distance,R:a.CRS.Earth.R,_closestElement:function(a,f){for(var e,m=a.length;m--;)a[m]<=f&&(void 0===e||e<a[m])&&(e=a[m]);return e}});a.Proj.GeoJSON=a.GeoJSON.extend({initialize:function(e,f){this._callLevel=0;a.GeoJSON.prototype.initialize.call(this,e,f)},addData:function(e){var f;e&&(e.crs&&"name"===e.crs.type?f=new a.Proj.CRS(e.crs.properties.name):e.crs&&e.crs.type&&(f=new a.Proj.CRS(e.crs.type+":"+e.crs.properties.code)),void 0!==f&&(this.options.coordsToLatLng=function(e){e=a.point(e[0],e[1]);return f.projection.unproject(e)}));this._callLevel++;try{a.GeoJSON.prototype.addData.call(this,e)}finally{this._callLevel--,0===this._callLevel&&delete this.options.coordsToLatLng}}});a.Proj.geoJson=function(e,f){return new a.Proj.GeoJSON(e,f)};a.Proj.ImageOverlay=a.ImageOverlay.extend({initialize:function(e,f,h){a.ImageOverlay.prototype.initialize.call(this,e,null,h);this._projectedBounds=f},_animateZoom:function(e){var f=this._map.getZoomScale(e.zoom),h=a.point(this._projectedBounds.min.x,this._projectedBounds.max.y);e=this._projectedToNewLayerPoint(h,e.zoom,e.center);a.DomUtil.setTransform(this._image,e,f)},_reset:function(){var e=this._map.getZoom(),f=this._map.getPixelOrigin(),e=a.bounds(this._transform(this._projectedBounds.min,e)._subtract(f),this._transform(this._projectedBounds.max,e)._subtract(f)),f=e.getSize();a.DomUtil.setPosition(this._image,e.min);this._image.style.width=f.x+"px";this._image.style.height=f.y+"px"},_projectedToNewLayerPoint:function(a,f,e){var h=this._map.getSize()._divideBy(2);e=this._map.project(e,f)._subtract(h)._round().add(this._map._getMapPanePos());return this._transform(a,f)._subtract(e)},_transform:function(a,f){var e=this._map.options.crs,m=e.transformation,e=e.scale(f);return m.transform(a,e)}});a.Proj.imageOverlay=function(e,f,h){return new a.Proj.ImageOverlay(e,f,h)};return a.Proj});!function(a,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet"],e):e((a.L=a.L||{},a.L.esri={}),a.L)}(this,function(a,e){function k(c){var a="",f;for(f in c.f=c.f||"json",c)if(c.hasOwnProperty(f)){var e;e=c[f];var g=Object.prototype.toString.call(e);a.length&&(a+="\x26");e="[object Array]"===g?"[object Object]"===Object.prototype.toString.call(e[0])?JSON.stringify(e):e.join(","):"[object Object]"===g?JSON.stringify(e):"[object Date]"===g?e.valueOf():e;a+=encodeURIComponent(f)+"\x3d"+encodeURIComponent(e)}return a}function f(c,a){var f=new window.XMLHttpRequest;return f.onerror=function(g){f.onreadystatechange=e.Util.falseFn;c.call(a,{error:{code:500,message:"XMLHttpRequest error"}},null)},f.onreadystatechange=function(){var g,h;if(4===f.readyState){try{g=JSON.parse(f.responseText)}catch(ua){g=null,h={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!h&&g.error&&(h=g.error,g=null);f.onerror=e.Util.falseFn;c.call(a,h,g)}},f.ontimeout=function(){this.onerror()},f}function h(c,a,e,g){e=f(e,g);return e.open("POST",c),void 0!==g&&null!==g&&void 0!==g.options&&(e.timeout=g.options.timeout),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset\x3dUTF-8"),e.send(k(a)),e}function m(c,a,e,g){e=f(e,g);return e.open("GET",c+"?"+k(a),!0),void 0!==g&&null!==g&&void 0!==g.options&&(e.timeout=g.options.timeout),e.send(null),e}function g(c,a,e,g){var h=k(a),m=f(e,g),q=(c+"?"+h).length;if(2E3>=q&&ea.cors?m.open("GET",c+"?"+h):2E3<q&&ea.cors&&(m.open("POST",c),m.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset\x3dUTF-8")),void 0!==g&&null!==g&&void 0!==g.options&&(m.timeout=g.options.timeout),2E3>=q&&ea.cors)m.send(null);else{if(!(2E3<q&&ea.cors))return 2E3>=q&&!ea.cors?u(c,a,e,g):void X("a request to "+c+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");m.send(h)}return m}function u(c,a,f,g){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var h="c"+P;a.callback="window._EsriLeafletCallbacks."+h;window._EsriLeafletCallbacks[h]=function(c){if(!0!==window._EsriLeafletCallbacks[h]){var a,e=Object.prototype.toString.call(c);"[object Object]"!==e&&"[object Array]"!==e&&(a={error:{code:500,message:"Expected array or object as JSONP response"}},c=null);!a&&c.error&&(a=c,c=null);f.call(g,a,c);window._EsriLeafletCallbacks[h]=!0}};var m=e.DomUtil.create("script",null,document.body);return m.type="text/javascript",m.src=c+"?"+k(a),m.id=h,m.onerror=function(c){c&&!0!==window._EsriLeafletCallbacks[h]&&(f.call(g,{error:{code:500,message:"An unknown error occurred"}}),window._EsriLeafletCallbacks[h]=!0)},e.DomUtil.addClass(m,"esri-leaflet-jsonp"),P++,{id:h,url:m.src,abort:function(){window._EsriLeafletCallbacks._callback[h]({code:0,message:"Request aborted."})}}}function p(c){var a;a:{a=c[0];for(var f=0;f<a.length;f++)if(a[f]!==c[c.length-1][f]){a=!1;break a}a=!0}return a||c.push(c[0]),c}function v(c){for(var a,f=0,e=0,g=c.length,h=c[e];e<g-1;e++)f+=((a=c[e+1])[0]-h[0])*(a[1]+h[1]),h=a;return 0<=f}function x(c,a){for(var f=0;f<c.length-1;f++)for(var e=0;e<a.length-1;e++){var g;a:{var h=c[f],m=c[f+1],q=a[e],p=a[e+1],k=(p[0]-q[0])*(h[1]-q[1])-(p[1]-q[1])*(h[0]-q[0]);g=(m[0]-h[0])*(h[1]-q[1])-(m[1]-h[1])*(h[0]-q[0]);h=(p[1]-q[1])*(m[0]-h[0])-(p[0]-q[0])*(m[1]-h[1]);if(0!==h&&(k/=h,g/=h,0<=k&&1>=k&&0<=g&&1>=g)){g=!0;break a}g=!1}if(g)return!0}return!1}function E(c){var a=[];c=c.slice(0);var f=p(c.shift().slice(0));if(4<=f.length)for(v(f)||f.reverse(),a.push(f),f=0;f<c.length;f++){var e=p(c[f].slice(0));4<=e.length&&(v(e)&&e.reverse(),a.push(e))}return a}function z(c){var a={},f;for(f in c)c.hasOwnProperty(f)&&(a[f]=c[f]);return a}function H(c,a){var f={};if(c.features){f.type="FeatureCollection";f.features=[];for(var e=0;e<c.features.length;e++)f.features.push(H(c.features[e],a))}if("number"==typeof c.x&&"number"==typeof c.y&&(f.type="Point",f.coordinates=[c.x,c.y],"number"==typeof c.z&&f.coordinates.push(c.z)),c.points&&(f.type="MultiPoint",f.coordinates=c.points.slice(0)),c.paths&&(1===c.paths.length?(f.type="LineString",f.coordinates=c.paths[0].slice(0)):(f.type="MultiLineString",f.coordinates=c.paths.slice(0))),c.rings&&(f=function(c){var a,f=[],e=[];for(a=0;a<c.length;a++){var g=p(c[a].slice(0));4>g.length||(v(g)?(g=[g.slice().reverse()],f.push(g)):e.push(g.slice().reverse()))}for(g=[];e.length;){a=e.pop();var h=!1;for(c=f.length-1;0<=c;c--){for(var m=f[c][0],q=a,k=x(m,q),q=q[0],u=!1,w=-1,J=m.length,N=J-1;++w<J;N=w)(m[w][1]<=q[1]&&q[1]<m[N][1]||m[N][1]<=q[1]&&q[1]<m[w][1])&&q[0]<(m[N][0]-m[w][0])*(q[1]-m[w][1])/(m[N][1]-m[w][1])+m[w][0]&&(u=!u);m=u;if(!k&&m){f[c].push(a);h=!0;break}}h||g.push(a)}for(;g.length;){a=g.pop();e=!1;for(c=f.length-1;0<=c;c--)if(x(f[c][0],a)){f[c].push(a);e=!0;break}e||f.push([a.reverse()])}return 1===f.length?{type:"Polygon",coordinates:f[0]}:{type:"MultiPolygon",coordinates:f}}(c.rings.slice(0))),(c.geometry||c.attributes)&&(f.type="Feature",f.geometry=c.geometry?H(c.geometry):null,f.properties=c.attributes?z(c.attributes):null,c.attributes))try{f.id=function(c,a){for(var f=a?[a,"OBJECTID","FID"]:["OBJECTID","FID"],e=0;e<f.length;e++){var g=f[e];if(g in c&&("string"==typeof c[g]||"number"==typeof c[g]))return c[g]}throw Error("No valid id attribute found");}(c.attributes,a)}catch(N){}return JSON.stringify(f.geometry)===JSON.stringify({})&&(f.geometry=null),c.spatialReference&&c.spatialReference.wkid&&4326!==c.spatialReference.wkid&&console.warn("Object converted in non-standard crs - "+JSON.stringify(c.spatialReference)),f}function F(c,a){a=a||"OBJECTID";var f;f={wkid:4326};var e={};switch(c.type){case "Point":e.x=c.coordinates[0];e.y=c.coordinates[1];e.spatialReference=f;break;case "MultiPoint":e.points=c.coordinates.slice(0);e.spatialReference=f;break;case "LineString":e.paths=[c.coordinates.slice(0)];e.spatialReference=f;break;case "MultiLineString":e.paths=c.coordinates.slice(0);e.spatialReference=f;break;case "Polygon":e.rings=E(c.coordinates.slice(0));e.spatialReference=f;break;case "MultiPolygon":for(var g=e,h=c.coordinates.slice(0),m=[],q=0;q<h.length;q++)for(var p=E(h[q]),k=p.length-1;0<=k;k--){var u=p[k].slice(0);m.push(u)}g.rings=m;e.spatialReference=f;break;case "Feature":c.geometry&&(e.geometry=F(c.geometry,a));e.attributes=c.properties?z(c.properties):{};c.id&&(e.attributes[a]=c.id);break;case "FeatureCollection":e=[];for(f=0;f<c.features.length;f++)e.push(F(c.features[f],a));break;case "GeometryCollection":for(e=[],f=0;f<c.geometries.length;f++)e.push(F(c.geometries[f],a))}return e}function I(c,a){return H(c,a)}function V(c){if("NaN"!==c.xmin&&"NaN"!==c.ymin&&"NaN"!==c.xmax&&"NaN"!==c.ymax){var a=e.latLng(c.ymin,c.xmin);c=e.latLng(c.ymax,c.xmax);return e.latLngBounds(a,c)}return null}function aa(c){return{xmin:(c=e.latLngBounds(c)).getSouthWest().lng,ymin:c.getSouthWest().lat,xmax:c.getNorthEast().lng,ymax:c.getNorthEast().lat,spatialReference:{wkid:4326}}}function fa(c){var a;if(c.objectIdFieldName)a=c.objectIdFieldName;else if(c.fields){for(var f=0;f<=c.fields.length-1;f++)if("esriFieldTypeOID"===c.fields[f].type){a=c.fields[f].name;break}if(!a)for(f=0;f<=c.fields.length-1;f++)if(c.fields[f].name.match(M)){a=c.fields[f].name;break}}return a}function Fa(c){for(var a in c.attributes)if(a.match(M))return a}function C(c,a){var f,e=c.features||c.results,g=e.length;f=a||fa(c);var h={type:"FeatureCollection",features:[]};if(g)for(g=e.length-1;0<=g;g--){var m=I(e[g],f||Fa(e[g]));h.features.push(m)}return h}function G(c){return"/"!==(c=e.Util.trim(c))[c.length-1]&&(c+="/"),c}function R(c){if(-1!==c.url.indexOf("?")){c.requestParams=c.requestParams||{};var a=c.url.substring(c.url.indexOf("?")+1);c.url=c.url.split("?")[0];c.requestParams=JSON.parse('{"'+decodeURI(a).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return c.url=G(c.url.split("?")[0]),c}function pa(c){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(c)}function ha(c){var a;switch(c){case "Point":a="esriGeometryPoint";break;case "MultiPoint":a="esriGeometryMultipoint";break;case "LineString":case "MultiLineString":a="esriGeometryPolyline";break;case "Polygon":case "MultiPolygon":a="esriGeometryPolygon"}return a}function X(){console&&console.warn&&console.warn.apply(console,arguments)}function Q(c){return c.getSize().x-Ca.attributionWidthOffset+"px"}function O(c){if(c.attributionControl&&!c.attributionControl._esriAttributionAdded){c.attributionControl.setPrefix('\x3ca href\x3d"http://leafletjs.com" title\x3d"A JS library for interactive maps"\x3eLeaflet\x3c/a\x3e | Powered by \x3ca href\x3d"https://www.esri.com"\x3eEsri\x3c/a\x3e');var a=document.createElement("style");a.type="text/css";a.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}";document.getElementsByTagName("head")[0].appendChild(a);e.DomUtil.addClass(c.attributionControl._container,"esri-truncated-attribution:hover");var f=document.createElement("style");f.type="text/css";f.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+Q(c)+";}";document.getElementsByTagName("head")[0].appendChild(f);e.DomUtil.addClass(c.attributionControl._container,"esri-truncated-attribution");c.on("resize",function(a){c.attributionControl._container.style.maxWidth=Q(a.target)});c.on("unload",function(){a.parentNode.removeChild(a);f.parentNode.removeChild(f);for(var c=document.querySelectorAll(".esri-leaflet-jsonp"),e=0;e<c.length;e++)c.item(e).parentNode.removeChild(c.item(e))});c.attributionControl._esriAttributionAdded=!0}}function Ga(c){var a={geometry:null,geometryType:null};return c instanceof e.LatLngBounds?(a.geometry=aa(c),a.geometryType="esriGeometryEnvelope",a):(c.getLatLng&&(c=c.getLatLng()),c instanceof e.LatLng&&(c={type:"Point",coordinates:[c.lng,c.lat]}),c instanceof e.GeoJSON&&(c=c.getLayers()[0].feature.geometry,a.geometry=F(c,void 0),a.geometryType=ha(c.type)),c.toGeoJSON&&(c=c.toGeoJSON()),"Feature"===c.type&&(c=c.geometry),"Point"===c.type||"LineString"===c.type||"Polygon"===c.type||"MultiPolygon"===c.type?(a.geometry=F(c,void 0),a.geometryType=ha(c.type),a):void X("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}function va(c,a){u(c,{},e.Util.bind(function(c,f){if(!c){a._esriAttributions=[];for(var g=0;g<f.contributors.length;g++)for(var h=f.contributors[g],m=0;m<h.coverageAreas.length;m++){var q=h.coverageAreas[m],p=e.latLng(q.bbox[0],q.bbox[1]),k=e.latLng(q.bbox[2],q.bbox[3]);a._esriAttributions.push({attribution:h.attribution,score:q.score,bounds:e.latLngBounds(p,k),minZoom:q.zoomMin,maxZoom:q.zoomMax})}a._esriAttributions.sort(function(c,a){return a.score-c.score});eb({target:a})}},this))}function eb(c){c=c.target;var a=c._esriAttributions;if(c&&c.attributionControl){var f=c.attributionControl._container.querySelector(".esri-dynamic-attribution");if(f&&a){for(var g="",h=c.getBounds(),h=e.latLngBounds(h.getSouthWest().wrap(),h.getNorthEast().wrap()),m=c.getZoom(),p=0;p<a.length;p++){var k=a[p],u=k.attribution;!g.match(u)&&k.bounds.intersects(h)&&m>=k.minZoom&&m<=k.maxZoom&&(g+=", "+u)}g=g.substr(2);f.innerHTML=g;f.style.maxWidth=Q(c);c.fire("attributionupdated",{attribution:g})}}}function wa(c){return new Ea(c)}function ia(c){return new xa(c)}function Jb(c){return new K(c)}function lb(c){return new ca(c)}function Ma(c){return new Wa(c)}function y(c){return new ka(c)}function Kb(c){return new Xa(c)}function Ba(c){this.values=[].concat(c||[])}var Aa=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,A=""===document.documentElement.style.pointerEvents,ea={cors:Aa,pointerEvents:A},Ca={attributionWidthOffset:55},P=0,Oa=ea.cors?m:u;Oa.CORS=m;Oa.JSONP=u;var T={request:g,get:Oa,post:h},M=/^(OBJECTID|FID|OID|ID)$/i,ba={warn:X,cleanUrl:G,getUrlParams:R,isArcgisOnline:pa,geojsonTypeToArcGIS:ha,responseToFeatureCollection:C,geojsonToArcGIS:function(c,a){return F(c,a)},arcgisToGeoJSON:I,boundsToExtent:aa,extentToBounds:V,calcAttributionWidth:Q,setEsriAttribution:O,_setGeometry:Ga,_getAttributionData:va,_updateMapAttribution:eb,_findIdAttributeFromFeature:Fa,_findIdAttributeFromResponse:fa},Ha=e.Class.extend({options:{proxy:!1,useCors:Aa},generateSetter:function(c,a){return e.Util.bind(function(a){return this.params[c]=a,this},a)},initialize:function(c){if(c.request&&c.options?(this._service=c,e.Util.setOptions(this,c.options)):(e.Util.setOptions(this,c),this.options.url=G(c.url)),this.params=e.Util.extend({},this.params||{}),this.setters)for(var a in this.setters)this[a]=this.generateSetter(this.setters[a],this)},token:function(c){return this._service?this._service.authenticate(c):this.params.token=c,this},format:function(c){return this.params.returnUnformattedValues=!c,this},request:function(c,a){return this.options.requestParams&&e.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,c,a):this._request("request",this.path,this.params,c,a)},_request:function(c,a,f,e,g){a=this.options.proxy?this.options.proxy+"?"+this.options.url+a:this.options.url+a;return"get"!==c&&"request"!==c||this.options.useCors?T[c](a,f,e,g):T.get.JSONP(a,f,e,g)}}),Ea=Ha.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1\x3d1",outSr:4326,outFields:"*"},within:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(c){return this._setGeometryParams(c),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(c,a){return c=e.latLng(c),this.params.geometry=[c.lng,c.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=a,this.params.inSr=4326,this},where:function(c){return this.params.where=c,this},between:function(c,a){return this.params.time=[c.valueOf(),a.valueOf()],this},simplify:function(c,a){var f=Math.abs(c.getBounds().getWest()-c.getBounds().getEast());return this.params.maxAllowableOffset=f/c.getSize().y*a,this},orderBy:function(c,a){return a=a||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[c,a].join(" "),this},run:function(c,a){return this._cleanParams(),this.options.isModern||pa(this.options.url)?(this.params.f="geojson",this.request(function(f,e){this._trapSQLerrors(f);c.call(a,f,e,e)},this)):this.request(function(f,e){this._trapSQLerrors(f);c.call(a,f,e&&C(e),e)},this)},count:function(c,a){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(a,f){c.call(this,a,f&&f.count,f)},a)},ids:function(c,a){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(a,f){c.call(this,a,f&&f.objectIds,f)},a)},bounds:function(c,a){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(f,e){e&&e.extent&&V(e.extent)?c.call(a,f,V(e.extent),e):(f={message:"Invalid Bounds"},c.call(a,f,null,e))},a)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(c){c=e.point(c);return this.params.pixelSize=[c.x,c.y],this},layer:function(c){return this.path=c+"/query",this},_trapSQLerrors:function(c){c&&"400"===c.code&&X("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly;delete this.params.returnExtentOnly;delete this.params.returnCountOnly},_setGeometryParams:function(c){this.params.inSr=4326;c=Ga(c);this.params.geometry=c.geometry;this.params.geometryType=c.geometryType}}),xa=Ha.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(c,a){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[c,a].join(":"),this},simplify:function(c,a){var f=Math.abs(c.getBounds().getWest()-c.getBounds().getEast());return this.params.maxAllowableOffset=f/c.getSize().y*a,this},run:function(c,a){return this.request(function(f,e){c.call(a,f,e&&C(e),e)},a)}}),Va=Ha.extend({path:"identify",between:function(c,a){return this.params.time=[c.valueOf(),a.valueOf()],this}}),K=Va.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(c){var a=aa(c.getBounds());c=c.getSize();return this.params.imageDisplay=[c.x,c.y,96],this.params.mapExtent=[a.xmin,a.ymin,a.xmax,a.ymax],this},at:function(c){return 2===c.length&&(c=e.latLng(c)),this._setGeometryParams(c),this},layerDef:function(c,a){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[c,a].join(":"),this},simplify:function(c,a){var f=Math.abs(c.getBounds().getWest()-c.getBounds().getEast());return this.params.maxAllowableOffset=f/c.getSize().y*a,this},run:function(c,a){return this.request(function(f,e){if(f)c.call(a,f,void 0,e);else{var g=C(e);e.results=e.results.reverse();for(var h=0;h<g.features.length;h++)g.features[h].layerId=e.results[h].layerId;c.call(a,void 0,g,e)}})},_setGeometryParams:function(c){c=Ga(c);this.params.geometry=c.geometry;this.params.geometryType=c.geometryType}}),ca=Va.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(c){return c=e.latLng(c),this.params.geometry=JSON.stringify({x:c.lng,y:c.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(c,a){return this.request(function(f,e){c.call(a,f,e&&this._responseToGeoJSON(e),e)},this)},_responseToGeoJSON:function(c){var a=c.location,f=c.catalogItems,e=c.catalogItemVisibilities,a={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[a.x,a.y]},crs:{type:"EPSG",properties:{code:a.spatialReference.wkid}},properties:{OBJECTID:c.objectId,name:c.name,value:c.value},id:c.objectId}};if(c.properties&&c.properties.Values&&(a.pixel.properties.values=c.properties.Values),f&&f.features&&(a.catalogItems=C(f),e&&e.length===a.catalogItems.features.length))for(c=e.length-1;0<=c;c--)a.catalogItems.features[c].properties.catalogItemVisibility=e[c];return a}}),Da=e.Evented.extend({options:{proxy:!1,useCors:Aa,timeout:0},initialize:function(c){c=c||{};this._requestQueue=[];this._authenticating=!1;e.Util.setOptions(this,c);this.options.url=G(this.options.url)},get:function(c,a,f,e){return this._request("get",c,a,f,e)},post:function(c,a,f,e){return this._request("post",c,a,f,e)},request:function(c,a,f,e){return this._request("request",c,a,f,e)},metadata:function(c,a){return this._request("get","",{},c,a)},authenticate:function(c){return this._authenticating=!1,this.options.token=c,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(c){this.options.timeout=c},_request:function(c,a,f,g,h){this.fire("requeststart",{url:this.options.url+a,params:f,method:c},!0);var m=this._createServiceCallback(c,a,f,g,h);if(this.options.token&&(f.token=this.options.token),this.options.requestParams&&e.Util.extend(f,this.options.requestParams),!this._authenticating)return a=this.options.proxy?this.options.proxy+"?"+this.options.url+a:this.options.url+a,"get"!==c&&"request"!==c||this.options.useCors?T[c](a,f,m,h):T.get.JSONP(a,f,m,h);this._requestQueue.push([c,a,f,g,h])},_createServiceCallback:function(c,a,f,g,h){return e.Util.bind(function(m,p){!m||499!==m.code&&498!==m.code||(this._authenticating=!0,this._requestQueue.push([c,a,f,g,h]),this.fire("authenticationrequired",{authenticate:e.Util.bind(this.authenticate,this)},!0),m.authenticate=e.Util.bind(this.authenticate,this));g.call(h,m,p);m?this.fire("requesterror",{url:this.options.url+a,params:f,message:m.message,code:m.code,method:c},!0):this.fire("requestsuccess",{url:this.options.url+a,params:f,response:p,method:c},!0);this.fire("requestend",{url:this.options.url+a,params:f,method:c},!0)},this)},_runQueue:function(){for(var c=this._requestQueue.length-1;0<=c;c--){var a=this._requestQueue[c];this[a.shift()].apply(this,a)}this._requestQueue=[]}}),Wa=Da.extend({identify:function(){return Jb(this)},find:function(){return ia(this)},query:function(){return wa(this)}}),ka=Da.extend({query:function(){return wa(this)},identify:function(){return lb(this)}}),Xa=Da.extend({options:{idAttribute:"OBJECTID"},query:function(){return wa(this)},addFeature:function(c,a,f){this.addFeatures(c,a,f)},addFeatures:function(c,a,f){for(var e=c.features?c.features:[c],g=e.length-1;0<=g;g--)delete e[g].id;return c=F(c,void 0),c=1<e.length?c:[c],this.post("addFeatures",{features:c},function(c,e){var g=e&&e.addResults?1<e.addResults.length?e.addResults:e.addResults[0]:void 0;a&&a.call(f,c||e.addResults[0].error,g)},f)},updateFeature:function(c,a,f){this.updateFeatures(c,a,f)},updateFeatures:function(c,a,f){var e=c.features?c.features:[c];return c=F(c,this.options.idAttribute),c=1<e.length?c:[c],this.post("updateFeatures",{features:c},function(c,e){var g=e&&e.updateResults?1<e.updateResults.length?e.updateResults:e.updateResults[0]:void 0;a&&a.call(f,c||e.updateResults[0].error,g)},f)},deleteFeature:function(c,a,f){this.deleteFeatures(c,a,f)},deleteFeatures:function(c,a,f){return this.post("deleteFeatures",{objectIds:c},function(c,e){var g=e&&e.deleteResults?1<e.deleteResults.length?e.deleteResults:e.deleteResults[0]:void 0;a&&a.call(f,c||e.deleteResults[0].error,g)},f)}}),W="https:"!==window.location.protocol?"http:":"https:",da=e.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:W+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:W+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:A?"esri-labels":"tilePane",attribution:""}},NationalGeographic:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, \x26copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:A?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, \x26copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:A?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}},ImageryLabels:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:A?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:A?"esri-labels":"tilePane",attribution:""}},ShadedRelief:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:A?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:A?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:W+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}},ImageryClarity:{urlTemplate:W+"//clarity.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"}},Physical:{urlTemplate:W+"//{s}.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:8,subdomains:["server","services"],attribution:"U.S. National Park Service"}},ImageryFirefly:{urlTemplate:W+"//fly.maptiles.arcgis.com/arcgis/rest/services/World_Imagery_Firefly/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}}}},initialize:function(c,a){var f;if("object"==typeof c&&c.urlTemplate&&c.options)f=c;else{if("string"!=typeof c||!da.TILES[c])throw Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Physical", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ImageryClarity", "ImageryFirefly", ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');f=da.TILES[c]}var g=e.Util.extend(f.options,a);e.Util.setOptions(this,g);this.options.token&&-1===f.urlTemplate.indexOf("token\x3d")&&(f.urlTemplate+="?token\x3d"+this.options.token);e.TileLayer.prototype.initialize.call(this,f.urlTemplate,g)},onAdd:function(c){O(c);"esri-labels"===this.options.pane&&this._initPane();this.options.attributionUrl&&va(this.options.attributionUrl,c);c.on("moveend",eb);e.TileLayer.prototype.onAdd.call(this,c)},onRemove:function(c){c.off("moveend",eb);e.TileLayer.prototype.onRemove.call(this,c)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var c=this._map.createPane(this.options.pane);c.style.pointerEvents="none";c.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var c='\x3cspan class\x3d"esri-dynamic-attribution"\x3e'+this.options.attribution+"\x3c/span\x3e";return c}}),ya=e.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg\x3d\x3d"},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(c){c=R(c=e.Util.setOptions(this,c));this.tileUrl=(c.proxy?c.proxy+"?":"")+c.url+"tile/{z}/{y}/{x}"+(c.requestParams&&0<Object.keys(c.requestParams).length?e.Util.getParamString(c.requestParams):"");-1!==c.url.indexOf("{s}")&&c.subdomains&&(c.url=c.url.replace("{s}",c.subdomains[0]));this.service=Ma(c);this.service.addEventParent(this);(new RegExp(/tiles.arcgis(online)?\.com/g)).test(c.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),c.subdomains=["1","2","3","4"]);this.options.token&&(this.tileUrl+="?token\x3d"+this.options.token);e.TileLayer.prototype.initialize.call(this,this.tileUrl,c)},getTileUrl:function(c){var a=this._getZoomForUrl();return e.Util.template(this.tileUrl,e.Util.extend({s:this._getSubdomain(c),x:c.x,y:c.y,z:this._lodMap&&this._lodMap[a]?this._lodMap[a]:a},this.options))},createTile:function(c,a){var f=document.createElement("img");return e.DomEvent.on(f,"load",e.Util.bind(this._tileOnLoad,this,a,f)),e.DomEvent.on(f,"error",e.Util.bind(this._tileOnError,this,a,f)),this.options.crossOrigin&&(f.crossOrigin=""),f.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?f.src=this.getTileUrl(c):this.once("lodmap",function(){f.src=this.getTileUrl(c)},this),f},onAdd:function(c){O(c);this._lodMap||this.metadata(function(a,f){if(!a&&f.spatialReference){var g=f.spatialReference.latestWkid||f.spatialReference.wkid;if(!this.options.attribution&&c.attributionControl&&f.copyrightText&&(this.options.attribution=f.copyrightText,c.attributionControl.addAttribution(this.getAttribution())),c.options.crs!==e.CRS.EPSG3857||102100!==g&&3857!==g)c.options.crs&&c.options.crs.code&&-1<c.options.crs.code.indexOf(g)||X("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html");else{this._lodMap={};for(var g=f.tileInfo.lods,h=ya.MercatorZoomLevels,m=0;m<g.length;m++){var p=g[m],k;for(k in h)if(this._withinPercentage(p.resolution,h[k],this.options.zoomOffsetAllowance)){this._lodMap[k]=p.level;break}}this.fire("lodmap")}}},this);e.TileLayer.prototype.onAdd.call(this,c)},metadata:function(c,a){return this.service.metadata(c,a),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(c){var a="?token\x3d"+c;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,a):this.tileUrl+a,this.options.token=c,this.service.authenticate(c),this},_withinPercentage:function(c,a,f){return Math.abs(c/a-1)<f}}),ta=e.ImageOverlay.extend({onAdd:function(c){this._topLeft=c.getPixelBounds().min;e.ImageOverlay.prototype.onAdd.call(this,c)},_reset:function(){this._map.options.crs===e.CRS.EPSG3857?e.ImageOverlay.prototype._reset.call(this):e.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),Aa=e.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:Aa,attribution:null,interactive:!1,alt:""},onAdd:function(c){O(c);this.options.zIndex&&(this.options.position=null);this._update=e.Util.throttle(this._update,this.options.updateInterval,this);c.on("moveend",this._update,this);this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?c.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null);this._update();this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this));this.metadata(function(a,f){!a&&!this.options.attribution&&c.attributionControl&&f.copyrightText&&(this.options.attribution=f.copyrightText,c.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(c){this._currentImage&&this._map.removeLayer(this._currentImage);this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this));this._map.off("moveend",this._update,this)},bindPopup:function(c,a){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=e.popup(a),this._popupFunction=c,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&(this._currentImage.bringToFront(),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this.options.position="back",this._currentImage&&(this._currentImage.bringToBack(),this._setAutoZIndex(Math.min)),this},setZIndex:function(c){return this.options.zIndex=c,this._currentImage&&this._currentImage.setZIndex(c),this},_setAutoZIndex:function(c){if(this._currentImage){for(var a,f=this._currentImage.getPane().children,e=-c(-1/0,1/0),g=0,h=f.length;g<h;g++)a=f[g].style.zIndex,f[g]!==this._currentImage._image&&a&&(e=c(e,+a));isFinite(e)&&(this.options.zIndex=e+c(-1,1),this.setZIndex(this.options.zIndex))}},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(c){return this.options.opacity=c,this._currentImage&&this._currentImage.setOpacity(c),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(c,a){return this.options.from=c,this.options.to=a,this._update(),this},metadata:function(c,a){return this.service.metadata(c,a),this},authenticate:function(c){return this.service.authenticate(c),this},redraw:function(){this._update()},_renderImage:function(c,a,f){if(this._map&&(f&&(c="data:"+f+";base64,"+c),c)){var e=(new ta(c,a,{opacity:0,crossOrigin:this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive})).addTo(this._map),g=function(c){if(e.off("error",g,this),this._map){c=c.target;var f=this._currentImage;c._bounds.equals(a)&&c._bounds.equals(this._map.getBounds())?(this._currentImage=c,"front"===this.options.position?this.bringToFront():"back"===this.options.position&&this.bringToBack(),this.options.zIndex&&this.setZIndex(this.options.zIndex),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),f&&this._map&&this._map.removeLayer(f),f&&f._map&&f._map.removeLayer(f)):this._map.removeLayer(c)}this.fire("load",{bounds:a})};e.once("error",function(){this._map.removeLayer(e);this.fire("error");e.off("load",g,this)},this);e.once("load",g,this);this.fire("loading",{bounds:a})}},_update:function(){if(this._map){var c=this._map.getZoom(),a=this._map.getBounds();this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress||(c>this.options.maxZoom||c<this.options.minZoom?this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null):(c=this._buildExportParams(),e.Util.extend(c,this.options.requestParams),c?this._requestExport(c,a):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)))}},_renderPopup:function(c,a,f,g){(c=e.latLng(c),this._shouldRenderPopup&&this._lastClick.equals(c))&&(a=this._popupFunction(a,f,g))&&this._popup.setLatLng(c).setContent(a).openOn(this._map)},_resetPopupState:function(c){this._shouldRenderPopup=!1;this._lastClick=c.latlng},_calculateBbox:function(){var c=this._map.getPixelBounds(),a=this._map.unproject(c.getBottomLeft()),c=this._map.unproject(c.getTopRight()),c=this._map.options.crs.project(c),a=this._map.options.crs.project(a),a=e.bounds(c,a);return[a.getBottomLeft().x,a.getBottomLeft().y,a.getTopRight().x,a.getTopRight().y].join()},_calculateImageSize:function(){var c=this._map.getPixelBounds(),a=this._map.getSize(),f=this._map.unproject(c.getBottomLeft()),c=this._map.unproject(c.getTopRight()),c=this._map.latLngToLayerPoint(c).y,f=this._map.latLngToLayerPoint(f).y;return(0<c||f<a.y)&&(a.y=f-c),a.x+","+a.y}}),D=Aa.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"image"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(c){c=R(c);this.service=y(c);this.service.addEventParent(this);e.Util.setOptions(this,c)},setPixelType:function(c){return this.options.pixelType=c,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(c){return e.Util.isArray(c)?this.options.bandIds=c.join(","):this.options.bandIds=c.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(c,a){return e.Util.isArray(c)?this.options.noData=c.join(","):this.options.noData=c.toString(),a&&(this.options.noDataInterpretation=a),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(c){this.options.renderingRule=c;this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(c){this.options.mosaicRule=c;this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(c){var a=e.Util.bind(function(a,f,g){a||setTimeout(e.Util.bind(function(){this._renderPopup(c.latlng,a,f,g)},this),300)},this),f=this.identify().at(c.latlng);this.options.mosaicRule&&f.setMosaicRule(this.options.mosaicRule);f.run(a);this._shouldRenderPopup=!0;this._lastClick=c.latlng},_buildExportParams:function(){var c=parseInt(this._map.options.crs.code.split(":")[1],10),c={bbox:this._calculateBbox(),size:this._calculateImageSize(),format:this.options.format,transparent:this.options.transparent,bboxSR:c,imageSR:c};return this.options.from&&this.options.to&&(c.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(c.pixelType=this.options.pixelType),this.options.interpolation&&(c.interpolation=this.options.interpolation),this.options.compressionQuality&&(c.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(c.bandIds=this.options.bandIds),(0===this.options.noData||this.options.noData)&&(c.noData=this.options.noData),this.options.noDataInterpretation&&(c.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(c.token=this.service.options.token),this.options.renderingRule&&(c.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(c.mosaicRule=JSON.stringify(this.options.mosaicRule)),c},_requestExport:function(c,a){"json"===this.options.f?this.service.request("exportImage",c,function(c,f){c||(this.options.token&&(f.href+="?token\x3d"+this.options.token),this.options.proxy&&(f.href=this.options.proxy+"?"+f.href),this._renderImage(f.href,a))},this):(c.f="image",this._renderImage(this.options.url+"exportImage"+e.Util.getParamString(c),a))}}),la=Aa.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png24",transparent:!0,f:"json"},initialize:function(c){c=R(c);this.service=Ma(c);this.service.addEventParent(this);(c.proxy||c.token)&&"json"!==c.f&&(c.f="json");e.Util.setOptions(this,c)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(c){return this.options.dynamicLayers=c,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(c){return this.options.layers=c,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(c){return this.options.layerDefs=c,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(c){return this.options.timeOptions=c,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(c){var a,f=e.Util.bind(function(a,f,g){a||setTimeout(e.Util.bind(function(){this._renderPopup(c.latlng,a,f,g)},this),300)},this);if((a=this.options.popup?this.options.popup.on(this._map).at(c.latlng):this.identify().on(this._map).at(c.latlng)).params.maxAllowableOffset||a.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||(this.options.layers?a.layers("visible:"+this.options.layers.join(",")):a.layers("visible")),this.options.layerDefs&&"string"!=typeof this.options.layerDefs&&!a.params.layerDefs)for(var g in this.options.layerDefs)this.options.layerDefs.hasOwnProperty(g)&&a.layerDef(g,this.options.layerDefs[g]);a.run(f);this._shouldRenderPopup=!0;this._lastClick=c.latlng},_buildExportParams:function(){var c=parseInt(this._map.options.crs.code.split(":")[1],10),c={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:c,imageSR:c};if(this.options.dynamicLayers&&(c.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(0===this.options.layers.length)return;c.layers="show:"+this.options.layers.join(",")}return this.options.layerDefs&&(c.layerDefs="string"==typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(c.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(c.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(c.token=this.service.options.token),this.options.proxy&&(c.proxy=this.options.proxy),this.options.disableCache&&(c._ts=Date.now()),c},_requestExport:function(c,a){"json"===this.options.f?this.service.request("export",c,function(c,f){c||(this.options.token&&(f.href+="?token\x3d"+this.options.token),this.options.proxy&&(f.href=this.options.proxy+"?"+f.href),f.href?this._renderImage(f.href,a):this._renderImage(f.imageData,a,f.contentType))},this):(c.f="image",this._renderImage(this.options.url+"export"+e.Util.getParamString(c),a))}}),za=e.Layer.extend({options:{cellSize:512,updateInterval:150},initialize:function(c){e.setOptions(this,c);this._zooming=!1},onAdd:function(c){this._map=c;this._update=e.Util.throttle(this._update,this.options.updateInterval,this);this._reset();this._update()},onRemove:function(){this._map.removeEventListener(this.getEvents(),this);this._removeCells()},getEvents:function(){return{moveend:this._update,zoomstart:this._zoomstart,zoomend:this._reset}},addTo:function(c){return c.addLayer(this),this},removeFrom:function(c){return c.removeLayer(this),this},_zoomstart:function(){this._zooming=!0},_reset:function(){this._removeCells();this._cells={};this._activeCells={};this._cellsTotal=this._cellsToLoad=0;this._cellNumBounds=this._getCellNumBounds();this._resetWrap();this._zooming=!1},_resetWrap:function(){var c=this._map,a=c.options.crs;if(!a.infinite){var f=this._getCellSize();a.wrapLng&&(this._wrapLng=[Math.floor(c.project([0,a.wrapLng[0]]).x/f),Math.ceil(c.project([0,a.wrapLng[1]]).x/f)]);a.wrapLat&&(this._wrapLat=[Math.floor(c.project([a.wrapLat[0],0]).y/f),Math.ceil(c.project([a.wrapLat[1],0]).y/f)])}},_getCellSize:function(){return this.options.cellSize},_update:function(){if(this._map){var c=this._map.getPixelBounds(),a=this._getCellSize(),c=e.bounds(c.min.divideBy(a).floor(),c.max.divideBy(a).floor());this._removeOtherCells(c);this._addCells(c);this.fire("cellsupdated")}},_addCells:function(c){var a,f,g,h=[],m=c.getCenter(),p=this._map.getZoom();for(a=c.min.y;a<=c.max.y;a++)for(f=c.min.x;f<=c.max.x;f++)(g=e.point(f,a)).z=p,this._isValidCell(g)&&h.push(g);c=h.length;if(0!==c)for(this._cellsToLoad+=c,this._cellsTotal+=c,h.sort(function(c,a){return c.distanceTo(m)-a.distanceTo(m)}),f=0;f<c;f++)this._addCell(h[f])},_isValidCell:function(c){var a=this._map.options.crs;if(!a.infinite){var f=this._cellNumBounds;if(!a.wrapLng&&(c.x<f.min.x||c.x>f.max.x)||!a.wrapLat&&(c.y<f.min.y||c.y>f.max.y))return!1}if(!this.options.bounds)return!0;c=this._cellCoordsToBounds(c);return e.latLngBounds(this.options.bounds).intersects(c)},_cellCoordsToBounds:function(c){var a=this._map,f=this.options.cellSize,g=c.multiplyBy(f),f=g.add([f,f]),g=a.wrapLatLng(a.unproject(g,c.z));c=a.wrapLatLng(a.unproject(f,c.z));return e.latLngBounds(g,c)},_cellCoordsToKey:function(c){return c.x+":"+c.y},_keyToCellCoords:function(c){var a=c.split(":");c=parseInt(a[0],10);a=parseInt(a[1],10);return e.point(c,a)},_removeOtherCells:function(c){for(var a in this._cells)c.contains(this._keyToCellCoords(a))||this._removeCell(a)},_removeCell:function(c){var a=this._activeCells[c];a&&(delete this._activeCells[c],this.cellLeave&&this.cellLeave(a.bounds,a.coords),this.fire("cellleave",{bounds:a.bounds,coords:a.coords}))},_removeCells:function(){for(var c in this._cells){var a=this._cells[c].bounds,f=this._cells[c].coords;this.cellLeave&&this.cellLeave(a,f);this.fire("cellleave",{bounds:a,coords:f})}},_addCell:function(c){this._wrapCoords(c);var a=this._cellCoordsToKey(c),f=this._cells[a];f&&!this._activeCells[a]&&(this.cellEnter&&this.cellEnter(f.bounds,c),this.fire("cellenter",{bounds:f.bounds,coords:c}),this._activeCells[a]=f);f||(f={coords:c,bounds:this._cellCoordsToBounds(c)},this._cells[a]=f,this._activeCells[a]=f,this.createCell&&this.createCell(f.bounds,c),this.fire("cellcreate",{bounds:f.bounds,coords:c}))},_wrapCoords:function(c){c.x=this._wrapLng?e.Util.wrapNum(c.x,this._wrapLng):c.x;c.y=this._wrapLat?e.Util.wrapNum(c.y,this._wrapLat):c.y},_getCellNumBounds:function(){var c=this._map.getPixelWorldBounds(),a=this._getCellSize();return c?e.bounds(c.min.divideBy(a).floor(),c.max.divideBy(a).ceil().subtract([1,1])):null}});Ba.prototype.query=function(c){c=this.getIndex(c);return this.values[c]};Ba.prototype.getIndex=function(c){this.dirty&&this.sort();for(var a,f,e=0,g=this.values.length-1;e<=g;)if(a=(e+g)/2|0,+(f=this.values[Math.round(a)]).value<+c)e=a+1;else{if(!(+f.value>+c))return a;g=a-1}return Math.abs(~g)};Ba.prototype.between=function(c,a){var f=this.getIndex(c),e=this.getIndex(a);if(0===f&&0===e)return[];for(;this.values[f-1]&&this.values[f-1].value===c;)f--;for(;this.values[e+1]&&this.values[e+1].value===a;)e++;return this.values[e]&&this.values[e].value===a&&this.values[e+1]&&e++,this.values.slice(f,e)};Ba.prototype.insert=function(c){return this.values.splice(this.getIndex(c.value),0,c),this};Ba.prototype.bulkAdd=function(c,a){return this.values=this.values.concat([].concat(c||[])),a?this.sort():this.dirty=!0,this};Ba.prototype.sort=function(){return this.values.sort(function(c,a){return+a.value-+c.value}).reverse(),this.dirty=!1,this};var fb=za.extend({options:{attribution:null,where:"1\x3d1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6},initialize:function(c){if(za.prototype.initialize.call(this,c),c=R(c),c=e.Util.setOptions(this,c),this.service=Kb(c),this.service.addEventParent(this),"*"!==this.options.fields[0]){c=!1;for(var a=0;a<this.options.fields.length;a++)this.options.fields[a].match(/^(OBJECTID|FID|OID|ID)$/i)&&(c=!0);!1===c&&X("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new Ba,this._endTimeIndex=new Ba):this.options.timeField&&(this._timeIndex=new Ba);this._cache={};this._currentSnapshot=[];this._activeRequests=0},onAdd:function(c){return O(c),this.service.metadata(function(a,f){if(!a){var e=f.supportedQueryFormats,g=!1;!1===this.service.options.isModern&&(g=!0);!g&&e&&-1!==e.indexOf("geoJSON")&&(this.service.options.isModern=!0);f.objectIdField&&(this.service.options.idAttribute=f.objectIdField);!this.options.attribution&&c.attributionControl&&f.copyrightText&&(this.options.attribution=f.copyrightText,c.attributionControl.addAttribution(this.getAttribution()))}},this),c.on("zoomend",this._handleZoomChange,this),za.prototype.onAdd.call(this,c)},onRemove:function(c){return c.off("zoomend",this._handleZoomChange,this),za.prototype.onRemove.call(this,c)},getAttribution:function(){return this.options.attribution},createCell:function(c,a){this._visibleZoom()&&this._requestFeatures(c,a)},_requestFeatures:function(c,a,f){return this._activeRequests++,1===this._activeRequests&&this.fire("loading",{bounds:c},!0),this._buildQuery(c).run(function(g,h,m){m&&m.exceededTransferLimit&&this.fire("drawlimitexceeded");!g&&h&&h.features.length&&e.Util.requestAnimFrame(e.Util.bind(function(){this._addFeatures(h.features,a);this._postProcessFeatures(c)},this));g||!h||h.features.length||this._postProcessFeatures(c);g&&this._postProcessFeatures(c);f&&f.call(this,g,h)},this)},_postProcessFeatures:function(c){this._activeRequests--;0>=this._activeRequests&&this.fire("load",{bounds:c})},_cacheKey:function(c){return c.z+":"+c.x+":"+c.y},_addFeatures:function(c,a){var f=this._cacheKey(a);this._cache[f]=this._cache[f]||[];for(var e=c.length-1;0<=e;e--){var g=c[e].id;-1===this._currentSnapshot.indexOf(g)&&this._currentSnapshot.push(g);-1===this._cache[f].indexOf(g)&&this._cache[f].push(g)}this.options.timeField&&this._buildTimeIndexes(c);this.createLayers(c)},_buildQuery:function(c){c=this.service.query().intersects(c).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.requestParams&&e.Util.extend(c.params,this.options.requestParams),this.options.simplifyFactor&&c.simplify(this._map,this.options.simplifyFactor),"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&c.between(this.options.from,this.options.to),c},setWhere:function(c,a,f){this.options.where=c&&c.length?c:"1\x3d1";var g=[],h=[],m=0,p=null;c=e.Util.bind(function(c,k){if(c&&(p=c),k)for(var u=k.features.length-1;0<=u;u--)h.push(k.features[u].id);0>=--m&&this._visibleZoom()&&(this._currentSnapshot=h,e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(g);this.addLayers(h);a&&a.call(f,p)},this)))},this);for(var k=this._currentSnapshot.length-1;0<=k;k--)g.push(this._currentSnapshot[k]);for(var u in this._activeCells)m++,k=this._keyToCellCoords(u),k=this._cellCoordsToBounds(k),this._requestFeatures(k,u,c);return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(c,a,f,g){var h=this.options.from,m=this.options.to,p=0,k=null,u=e.Util.bind(function(e){e&&(k=e);this._filterExistingFeatures(h,m,c,a);p--;f&&0>=p&&f.call(g,k)},this);if(this.options.from=c,this.options.to=a,this._filterExistingFeatures(h,m,c,a),"server"===this.options.timeFilterMode)for(var q in this._activeCells){p++;var v=this._keyToCellCoords(q),v=this._cellCoordsToBounds(v);this._requestFeatures(v,q,u)}return this},refresh:function(){for(var c in this._activeCells){var a=this._keyToCellCoords(c),a=this._cellCoordsToBounds(a);this._requestFeatures(a,c)}this.redraw&&this.once("load",function(){this.eachFeature(function(c){this._redraw(c.feature.id)},this)},this)},_filterExistingFeatures:function(c,a,f,g){var h=c&&a?this._getFeaturesInTimeRange(c,a):this._currentSnapshot,m=this._getFeaturesInTimeRange(f,g);if(m.indexOf)for(c=0;c<m.length;c++)a=h.indexOf(m[c]),0<=a&&h.splice(a,1);e.Util.requestAnimFrame(e.Util.bind(function(){this.removeLayers(h);this.addLayers(m)},this))},_getFeaturesInTimeRange:function(c,a){var f,e=[];if(this.options.timeField.start&&this.options.timeField.end){f=this._startTimeIndex.between(c,a);var g=this._endTimeIndex.between(c,a);f=f.concat(g)}else f=this._timeIndex.between(c,a);for(g=f.length-1;0<=g;g--)e.push(f[g].id);return e},_buildTimeIndexes:function(c){var a,f;if(this.options.timeField.start&&this.options.timeField.end){var e=[],g=[];for(a=c.length-1;0<=a;a--)f=c[a],e.push({id:f.id,value:new Date(f.properties[this.options.timeField.start])}),g.push({id:f.id,value:new Date(f.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(e);this._endTimeIndex.bulkAdd(g)}else{e=[];for(a=c.length-1;0<=a;a--)f=c[a],e.push({id:f.id,value:new Date(f.properties[this.options.timeField])});this._timeIndex.bulkAdd(e)}},_featureWithinTimeRange:function(c){if(!this.options.from||!this.options.to)return!0;var a=+this.options.from.valueOf(),f=+this.options.to.valueOf();if("string"==typeof this.options.timeField){var e=+c.properties[this.options.timeField];return e>=a&&e<=f}if(this.options.timeField.start&&this.options.timeField.end)return e=+c.properties[this.options.timeField.start],c=+c.properties[this.options.timeField.end],e>=a&&e<=f||c>=a&&c<=f},_visibleZoom:function(){if(!this._map)return!1;var c=this._map.getZoom();return!(c>this.options.maxZoom||c<this.options.minZoom)},_handleZoomChange:function(){if(this._visibleZoom())for(var c in this._activeCells){var a=this._cacheKey(this._activeCells[c].coords);this._cache[a]&&this.addLayers(this._cache[a])}else this.removeLayers(this._currentSnapshot),this._currentSnapshot=[]},authenticate:function(c){return this.service.authenticate(c),this},metadata:function(c,a){return this.service.metadata(c,a),this},query:function(){return this.service.query()},_getMetadata:function(c){this._metadata?c(void 0,this._metadata):this.metadata(e.Util.bind(function(a,f){this._metadata=f;c(a,this._metadata)},this))},addFeature:function(c,a,f){this.addFeatures(c,a,f)},addFeatures:function(c,a,f){this._getMetadata(e.Util.bind(function(g,h){if(g)a&&a.call(this,g,null);else{var m=c.features?c.features:[c];this.service.addFeatures(c,e.Util.bind(function(c,e){if(!c){for(var g=m.length-1;0<=g;g--)m[g].properties[h.objectIdField]=1<m.length?e[g].objectId:e.objectId,m[g].id=1<m.length?e[g].objectId:e.objectId;this.createLayers(m)}a&&a.call(f,c,e)},this))}},this))},updateFeature:function(c,a,f){this.updateFeatures(c,a,f)},updateFeatures:function(c,a,f){var e=c.features?c.features:[c];this.service.updateFeatures(c,function(c,g){if(!c){for(var h=e.length-1;0<=h;h--)this.removeLayers([e[h].id],!0);this.createLayers(e)}a&&a.call(f,c,g)},this)},deleteFeature:function(c,a,f){this.deleteFeatures(c,a,f)},deleteFeatures:function(c,a,f){return this.service.deleteFeatures(c,function(c,e){var g=e.length?e:[e];if(!c&&0<g.length)for(var h=g.length-1;0<=h;h--)this.removeLayers([g[h].objectId],!0);a&&a.call(f,c,e)},this)}}),Pa=fb.extend({options:{cacheLayers:!0},initialize:function(c){fb.prototype.initialize.call(this,c);this._originalStyle=this.options.style;this._layers={}},onRemove:function(c){for(var a in this._layers)c.removeLayer(this._layers[a]),this.fire("removefeature",{feature:this._layers[a].feature,permanent:!1},!0);return fb.prototype.onRemove.call(this,c)},createNewLayer:function(c){c=e.GeoJSON.geometryToLayer(c,this.options);return c&&(c.defaultOptions=c.options),c},_updateLayer:function(c,a){var f;f=this.options.coordsToLatLng||e.GeoJSON.coordsToLatLng;switch(a.properties&&(c.feature.properties=a.properties),a.geometry.type){case "Point":f=e.GeoJSON.coordsToLatLng(a.geometry.coordinates);c.setLatLng(f);break;case "LineString":f=e.GeoJSON.coordsToLatLngs(a.geometry.coordinates,0,f);c.setLatLngs(f);break;case "MultiLineString":case "Polygon":f=e.GeoJSON.coordsToLatLngs(a.geometry.coordinates,1,f);c.setLatLngs(f);break;case "MultiPolygon":f=e.GeoJSON.coordsToLatLngs(a.geometry.coordinates,2,f),c.setLatLngs(f)}},createLayers:function(c){for(var a=c.length-1;0<=a;a--){var f,e=c[a],g=this._layers[e.id];this._visibleZoom()&&g&&!this._map.hasLayer(g)&&(this._map.addLayer(g),this.fire("addfeature",{feature:g.feature},!0));g&&0<this.options.simplifyFactor&&(g.setLatLngs||g.setLatLng)&&this._updateLayer(g,e);g||((f=this.createNewLayer(e))?(f.feature=e,f.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(f.feature,f),this._layers[f.feature.id]=f,this.setFeatureStyle(f.feature.id,this.options.style),this.fire("createfeature",{feature:f.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(e))&&this._map.addLayer(f)):X("invalid GeoJSON encountered"))}},addLayers:function(c){for(var a=c.length-1;0<=a;a--){var f=this._layers[c[a]];f&&this._map.addLayer(f)}},removeLayers:function(c,a){for(var f=c.length-1;0<=f;f--){var e=c[f],g=this._layers[e];g&&(this.fire("removefeature",{feature:g.feature,permanent:a},!0),this._map.removeLayer(g));g&&a&&delete this._layers[e]}},cellEnter:function(c,a){this._visibleZoom()&&!this._zooming&&this._map&&e.Util.requestAnimFrame(e.Util.bind(function(){var c=this._cacheKey(a),f=this._cellCoordsToKey(a),c=this._cache[c];this._activeCells[f]&&c&&this.addLayers(c)},this))},cellLeave:function(c,a){this._zooming||e.Util.requestAnimFrame(e.Util.bind(function(){if(this._map){var c=this._cacheKey(a),f=this._cellCoordsToKey(a),e=this._cache[c],g=this._map.getBounds();if(!this._activeCells[f]&&e){for(var h=!0,m=0;m<e.length;m++){var p=this._layers[e[m]];p&&p.getBounds&&g.intersects(p.getBounds())&&(h=!1)}h&&this.removeLayers(e,!this.options.cacheLayers);!this.options.cacheLayers&&h&&(delete this._cache[c],delete this._cells[f],delete this._activeCells[f])}}},this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature(function(c){this.resetFeatureStyle(c.feature.id)},this),this},setStyle:function(c){return this.options.style=c,this.eachFeature(function(a){this.setFeatureStyle(a.feature.id,c)},this),this},resetFeatureStyle:function(c){var a=this._layers[c],f=this._originalStyle||e.Path.prototype.options;return a&&(e.Util.extend(a.options,a.defaultOptions),this.setFeatureStyle(c,f)),this},setFeatureStyle:function(c,a){var f=this._layers[c];return"function"==typeof a&&(a=a(f.feature)),f.setStyle&&f.setStyle(a),this},eachActiveFeature:function(c,a){if(this._map){var f=this._map.getBounds(),e;for(e in this._layers)-1!==this._currentSnapshot.indexOf(this._layers[e].feature.id)&&("function"==typeof this._layers[e].getLatLng&&f.contains(this._layers[e].getLatLng())?c.call(a,this._layers[e]):"function"==typeof this._layers[e].getBounds&&f.intersects(this._layers[e].getBounds())&&c.call(a,this._layers[e]))}return this},eachFeature:function(c,a){for(var f in this._layers)c.call(a,this._layers[f]);return this},getFeature:function(c){return this._layers[c]},bringToBack:function(){this.eachFeature(function(c){c.bringToBack&&c.bringToBack()})},bringToFront:function(){this.eachFeature(function(c){c.bringToFront&&c.bringToFront()})},redraw:function(c){return c&&this._redraw(c),this},_redraw:function(c){c=this._layers[c];var a=c.feature;if(c&&c.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var f=this.options.pointToLayer(a,e.latLng(a.geometry.coordinates[1],a.geometry.coordinates[0])).options.icon;c.setIcon(f)}c&&c.setStyle&&this.options.pointToLayer&&(f=this.options.pointToLayer(a,e.latLng(a.geometry.coordinates[1],a.geometry.coordinates[0])).options,this.setFeatureStyle(a.id,f));c&&c.setStyle&&this.options.style&&this.resetStyle(a.id)}});a.VERSION="2.2.3";a.Support=ea;a.options=Ca;a.Util=ba;a.get=Oa;a.post=h;a.request=g;a.Task=Ha;a.task=function(c){return c=R(c),new Ha(c)};a.Query=Ea;a.query=wa;a.Find=xa;a.find=ia;a.Identify=Va;a.identify=function(c){return new Va(c)};a.IdentifyFeatures=K;a.identifyFeatures=Jb;a.IdentifyImage=ca;a.identifyImage=lb;a.Service=Da;a.service=function(c){return c=R(c),new Da(c)};a.MapService=Wa;a.mapService=Ma;a.ImageService=ka;a.imageService=y;a.FeatureLayerService=Xa;a.featureLayerService=Kb;a.BasemapLayer=da;a.basemapLayer=function(c,a){return new da(c,a)};a.TiledMapLayer=ya;a.tiledMapLayer=function(c,a){return new ya(c,a)};a.RasterLayer=Aa;a.ImageMapLayer=D;a.imageMapLayer=function(c,a){return new D(c,a)};a.DynamicMapLayer=la;a.dynamicMapLayer=function(c,a){return new la(c,a)};a.FeatureManager=fb;a.FeatureLayer=Pa;a.featureLayer=function(a){return new Pa(a)};Object.defineProperty(a,"__esModule",{value:!0})});!function(a,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((a.Leaflet=a.Leaflet||{},a.Leaflet.markercluster=a.Leaflet.markercluster||{}))}(this,function(a){var e=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(a){L.Util.setOptions(this,a);this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction);this._featureGroup=L.featureGroup();this._featureGroup.addEventParent(this);this._nonPointGroup=L.featureGroup();this._nonPointGroup.addEventParent(this);this._inZoomAnimation=0;this._needsClustering=[];this._needsRemoving=[];this._currentShownBounds=null;this._queue=[];this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};a=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,a?this._withAnimation:this._noAnimation);this._markerCluster=a?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(a){if(a instanceof L.LayerGroup)return this.addLayers([a]);if(!a.getLatLng)return this._nonPointGroup.addLayer(a),this.fire("layeradd",{layer:a}),this;if(!this._map)return this._needsClustering.push(a),this.fire("layeradd",{layer:a}),this;if(this.hasLayer(a))return this;this._unspiderfy&&this._unspiderfy();this._addLayer(a,this._maxZoom);this.fire("layeradd",{layer:a});this._topClusterLevel._recalculateBounds();this._refreshClustersIcons();var f=a,e=this._zoom;if(a.__parent)for(;f.__parent._zoom>=e;)f=f.__parent;return this._currentShownBounds.contains(f.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(a,f):this._animationAddLayerNonAnimated(a,f)),this},removeLayer:function(a){return a instanceof L.LayerGroup?this.removeLayers([a]):a.getLatLng?this._map?a.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(a)),this._removeLayer(a,!0),this.fire("layerremove",{layer:a}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),a.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(a)&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,a)&&this.hasLayer(a)&&this._needsRemoving.push({layer:a,latlng:a._latlng}),this.fire("layerremove",{layer:a}),this):(this._nonPointGroup.removeLayer(a),this.fire("layerremove",{layer:a}),this)},addLayers:function(a,e){if(!L.Util.isArray(a))return this.addLayer(a);var f,g=this._featureGroup,h=this._nonPointGroup,p=this.options.chunkedLoading,k=this.options.chunkInterval,x=this.options.chunkProgress,E=a.length,z=0,H=!0;if(this._map){var F=(new Date).getTime(),I=L.bind(function(){for(var m=(new Date).getTime();E>z&&!(p&&0===z%200&&(new Date).getTime()-m>k);z++)if(f=a[z],f instanceof L.LayerGroup)H&&(a=a.slice(),H=!1),this._extractNonGroupLayers(f,a),E=a.length;else if(f.getLatLng){if(!this.hasLayer(f)&&(this._addLayer(f,this._maxZoom),e||this.fire("layeradd",{layer:f}),f.__parent&&2===f.__parent.getChildCount())){var u=f.__parent.getAllChildMarkers();g.removeLayer(u[0]===f?u[1]:u[0])}}else h.addLayer(f),e||this.fire("layeradd",{layer:f});x&&x(z,E,(new Date).getTime()-F);z===E?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(I,this.options.chunkDelay)},this);I()}else for(var V=this._needsClustering;E>z;z++)f=a[z],f instanceof L.LayerGroup?(H&&(a=a.slice(),H=!1),this._extractNonGroupLayers(f,a),E=a.length):f.getLatLng?this.hasLayer(f)||V.push(f):h.addLayer(f);return this},removeLayers:function(a){var f,e,g=a.length,k=this._featureGroup,p=this._nonPointGroup,v=!0;if(!this._map){for(f=0;g>f;f++)e=a[f],e instanceof L.LayerGroup?(v&&(a=a.slice(),v=!1),this._extractNonGroupLayers(e,a),g=a.length):(this._arraySplice(this._needsClustering,e),p.removeLayer(e),this.hasLayer(e)&&this._needsRemoving.push({layer:e,latlng:e._latlng}),this.fire("layerremove",{layer:e}));return this}if(this._unspiderfy){this._unspiderfy();var x=a.slice(),E=g;for(f=0;E>f;f++)e=x[f],e instanceof L.LayerGroup?(this._extractNonGroupLayers(e,x),E=x.length):this._unspiderfyLayer(e)}for(f=0;g>f;f++)e=a[f],e instanceof L.LayerGroup?(v&&(a=a.slice(),v=!1),this._extractNonGroupLayers(e,a),g=a.length):e.__parent?(this._removeLayer(e,!0,!0),this.fire("layerremove",{layer:e}),k.hasLayer(e)&&(k.removeLayer(e),e.clusterShow&&e.clusterShow())):(p.removeLayer(e),this.fire("layerremove",{layer:e}));return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(a){a.off(this._childMarkerEventHandlers,this);delete a.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var a=new L.LatLngBounds;this._topClusterLevel&&a.extend(this._topClusterLevel._bounds);for(var e=this._needsClustering.length-1;0<=e;e--)a.extend(this._needsClustering[e].getLatLng());return a.extend(this._nonPointGroup.getBounds()),a},eachLayer:function(a,e){var f,g,h,p=this._needsClustering.slice(),k=this._needsRemoving;this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(p);for(g=p.length-1;0<=g;g--){f=!0;for(h=k.length-1;0<=h;h--)if(k[h].layer===p[g]){f=!1;break}f&&a.call(e,p[g])}this._nonPointGroup.eachLayer(a,e)},getLayers:function(){var a=[];return this.eachLayer(function(f){a.push(f)}),a},getLayer:function(a){var f=null;return a=parseInt(a,10),this.eachLayer(function(e){L.stamp(e)===a&&(f=e)}),f},hasLayer:function(a){if(!a)return!1;var f,e=this._needsClustering;for(f=e.length-1;0<=f;f--)if(e[f]===a)return!0;e=this._needsRemoving;for(f=e.length-1;0<=f;f--)if(e[f].layer===a)return!1;return!(!a.__parent||a.__parent._group!==this)||this._nonPointGroup.hasLayer(a)},zoomToShowLayer:function(a,e){"function"!=typeof e&&(e=function(){});var f=function(){!a._icon&&!a.__parent._icon||this._inZoomAnimation||(this._map.off("moveend",f,this),this.off("animationend",f,this),a._icon?e():a.__parent._icon&&(this.once("spiderfied",e,this),a.__parent.spiderfy()))};a._icon&&this._map.getBounds().contains(a.getLatLng())?e():a.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",f,this),this._map.panTo(a.getLatLng())):(this._map.on("moveend",f,this),this.on("animationend",f,this),a.__parent.zoomToBounds())},onAdd:function(a){this._map=a;var f,e;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";this._featureGroup.addTo(a);this._nonPointGroup.addTo(a);this._gridClusters||this._generateInitialClusters();this._maxLat=a.options.crs.projection.MAX_LATITUDE;a=0;for(f=this._needsRemoving.length;f>a;a++)e=this._needsRemoving[a],e.newlatlng=e.layer._latlng,e.layer._latlng=e.latlng;a=0;for(f=this._needsRemoving.length;f>a;a++)e=this._needsRemoving[a],this._removeLayer(e.layer,!0),e.layer._latlng=e.newlatlng;this._needsRemoving=[];this._zoom=Math.round(this._map._zoom);this._currentShownBounds=this._getExpandedVisibleBounds();this._map.on("zoomend",this._zoomEnd,this);this._map.on("moveend",this._moveEnd,this);this._spiderfierOnAdd&&this._spiderfierOnAdd();this._bindEvents();f=this._needsClustering;this._needsClustering=[];this.addLayers(f,!0)},onRemove:function(a){a.off("zoomend",this._zoomEnd,this);a.off("moveend",this._moveEnd,this);this._unbindEvents();this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","");this._spiderfierOnRemove&&this._spiderfierOnRemove();delete this._maxLat;this._hideCoverage();this._featureGroup.remove();this._nonPointGroup.remove();this._featureGroup.clearLayers();this._map=null},getVisibleParent:function(a){for(;a&&!a._icon;)a=a.__parent;return a||null},_arraySplice:function(a,e){for(var f=a.length-1;0<=f;f--)if(a[f]===e)return a.splice(f,1),!0},_removeFromGridUnclustered:function(a,e){for(var f=this._map,g=this._gridUnclustered,h=Math.floor(this._map.getMinZoom());e>=h&&g[e].removeObject(a,f.project(a.getLatLng(),e));e--);},_childMarkerDragStart:function(a){a.target.__dragStart=a.target._latlng},_childMarkerMoved:function(a){if(!this._ignoreMove&&!a.target.__dragStart){var f=a.target._popup&&a.target._popup.isOpen();this._moveChild(a.target,a.oldLatLng,a.latlng);f&&a.target.openPopup()}},_moveChild:function(a,e,m){a._latlng=e;this.removeLayer(a);a._latlng=m;this.addLayer(a)},_childMarkerDragEnd:function(a){var f=a.target.__dragStart;delete a.target.__dragStart;f&&this._moveChild(a.target,f,a.target._latlng)},_removeLayer:function(a,e,m){var f=this._gridClusters,h=this._gridUnclustered,p=this._featureGroup,k=this._map,x=Math.floor(this._map.getMinZoom());e&&this._removeFromGridUnclustered(a,this._maxZoom);var E,z=a.__parent;for(this._arraySplice(z._markers,a);z&&(z._childCount--,z._boundsNeedUpdate=!0,!(z._zoom<x));)e&&1>=z._childCount?(E=z._markers[0]===a?z._markers[1]:z._markers[0],f[z._zoom].removeObject(z,k.project(z._cLatLng,z._zoom)),h[z._zoom].addObject(E,k.project(E.getLatLng(),z._zoom)),this._arraySplice(z.__parent._childClusters,z),z.__parent._markers.push(E),E.__parent=z.__parent,z._icon&&(p.removeLayer(z),m||p.addLayer(E))):z._iconNeedsUpdate=!0,z=z.__parent;delete a.__parent},_isOrIsParent:function(a,e){for(;e;){if(a===e)return!0;e=e.parentNode}return!1},fire:function(a,e,m){if(e&&e.layer instanceof L.MarkerCluster){if(e.originalEvent&&this._isOrIsParent(e.layer._icon,e.originalEvent.relatedTarget))return;a="cluster"+a}L.FeatureGroup.prototype.fire.call(this,a,e,m)},listens:function(a,e){return L.FeatureGroup.prototype.listens.call(this,a,e)||L.FeatureGroup.prototype.listens.call(this,"cluster"+a,e)},_defaultIconCreateFunction:function(a){a=a.getChildCount();var f=" marker-cluster-";return f+=10>a?"small":100>a?"medium":"large",new L.DivIcon({html:"\x3cdiv\x3e\x3cspan\x3e"+a+"\x3c/span\x3e\x3c/div\x3e",className:"marker-cluster"+f,iconSize:new L.Point(40,40)})},_bindEvents:function(){var a=this._map,e=this.options.showCoverageOnHover,m=this.options.zoomToBoundsOnClick;(this.options.spiderfyOnMaxZoom||m)&&this.on("clusterclick",this._zoomOrSpiderfy,this);e&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),a.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(a){for(var f=a.layer,e=f;1===e._childClusters.length;)e=e._childClusters[0];e._zoom===this._maxZoom&&e._childCount===f._childCount&&this.options.spiderfyOnMaxZoom?f.spiderfy():this.options.zoomToBoundsOnClick&&f.zoomToBounds();a.originalEvent&&13===a.originalEvent.keyCode&&this._map._container.focus()},_showCoverage:function(a){var f=this._map;this._inZoomAnimation||(this._shownPolygon&&f.removeLayer(this._shownPolygon),2<a.layer.getChildCount()&&a.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(a.layer.getConvexHull(),this.options.polygonOptions),f.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var a=this.options.showCoverageOnHover,e=this.options.zoomToBoundsOnClick,m=this._map;(this.options.spiderfyOnMaxZoom||e)&&this.off("clusterclick",this._zoomOrSpiderfy,this);a&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),m.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var a=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,a);this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),a);this._currentShownBounds=a}},_generateInitialClusters:function(){var a=Math.ceil(this._map.getMaxZoom()),e=Math.floor(this._map.getMinZoom()),m=this.options.maxClusterRadius,g=m;"function"!=typeof m&&(g=function(){return m});null!==this.options.disableClusteringAtZoom&&(a=this.options.disableClusteringAtZoom-1);this._maxZoom=a;this._gridClusters={};for(this._gridUnclustered={};a>=e;a--)this._gridClusters[a]=new L.DistanceGrid(g(a)),this._gridUnclustered[a]=new L.DistanceGrid(g(a));this._topClusterLevel=new this._markerCluster(this,e-1)},_addLayer:function(a,e){var f,g,h=this._gridClusters;g=this._gridUnclustered;var p=Math.floor(this._map.getMinZoom());this.options.singleMarkerMode&&this._overrideMarkerIcon(a);for(a.on(this._childMarkerEventHandlers,this);e>=p;e--){f=this._map.project(a.getLatLng(),e);var k=h[e].getNearObject(f);if(k)return k._addChild(a),a.__parent=k,void 0;if(k=g[e].getNearObject(f)){(f=k.__parent)&&this._removeLayer(k,!1);g=new this._markerCluster(this,e,k,a);h[e].addObject(g,this._map.project(g._cLatLng,e));k.__parent=g;p=a.__parent=g;for(g=e-1;g>f._zoom;g--)p=new this._markerCluster(this,g,p),h[g].addObject(p,this._map.project(k.getLatLng(),g));return f._addChild(p),this._removeFromGridUnclustered(k,e),void 0}g[e].addObject(a,f)}this._topClusterLevel._addChild(a);a.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(a){a instanceof L.MarkerCluster&&a._iconNeedsUpdate&&a._updateIcon()})},_enqueue:function(a){this._queue.push(a);this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var a=0;a<this._queue.length;a++)this._queue[a].call(this);this._queue.length=0;clearTimeout(this._queueTimeout);this._queueTimeout=null},_mergeSplitClusters:function(){var a=Math.round(this._map._zoom);this._processQueue();this._zoom<a&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,a)):this._zoom>a?(this._animationStart(),this._animationZoomOut(this._zoom,a)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?L.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(a){var f=this._maxLat;return void 0!==f&&(a.getNorth()>=f&&(a._northEast.lat=1/0),a.getSouth()<=-f&&(a._southWest.lat=-1/0)),a},_animationAddLayerNonAnimated:function(a,e){if(e===a)this._featureGroup.addLayer(a);else if(2===e._childCount){e._addToMap();var f=e.getAllChildMarkers();this._featureGroup.removeLayer(f[0]);this._featureGroup.removeLayer(f[1])}else e._updateIcon()},_extractNonGroupLayers:function(a,e){var f,g=a.getLayers(),h=0;for(e=e||[];h<g.length;h++)f=g[h],f instanceof L.LayerGroup?this._extractNonGroupLayers(f,e):e.push(f);return e},_overrideMarkerIcon:function(a){return a.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[a]}})}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))});L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(a,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a);this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds());this.fire("animationend")},_animationZoomOut:function(a,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a);this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds());this.fire("animationend")},_animationAddLayer:function(a,e){this._animationAddLayerNonAnimated(a,e)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim";this._inZoomAnimation++},_animationZoomIn:function(a,e){var f,g=this._getExpandedVisibleBounds(),h=this._featureGroup,p=Math.floor(this._map.getMinZoom());this._ignoreMove=!0;this._topClusterLevel._recursively(g,a,p,function(m){var p=m._latlng,k=m._markers;g.contains(p)||(p=null);m._isSingleParent()&&a+1===e?(h.removeLayer(m),m._recursivelyAddChildrenToMap(null,e,g)):(m.clusterHide(),m._recursivelyAddChildrenToMap(p,e,g));for(f=k.length-1;0<=f;f--)m=k[f],g.contains(m._latlng)||h.removeLayer(m)});this._forceLayout();this._topClusterLevel._recursivelyBecomeVisible(g,e);h.eachLayer(function(a){a instanceof L.MarkerCluster||!a._icon||a.clusterShow()});this._topClusterLevel._recursively(g,a,e,function(a){a._recursivelyRestoreChildPositions(e)});this._ignoreMove=!1;this._enqueue(function(){this._topClusterLevel._recursively(g,a,p,function(a){h.removeLayer(a);a.clusterShow()});this._animationEnd()})},_animationZoomOut:function(a,e){this._animationZoomOutSingle(this._topClusterLevel,a-1,e);this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds());this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a,this._getExpandedVisibleBounds())},_animationAddLayer:function(a,e){var f=this,g=this._featureGroup;g.addLayer(a);e!==a&&(2<e._childCount?(e._updateIcon(),this._forceLayout(),this._animationStart(),a._setPos(this._map.latLngToLayerPoint(e.getLatLng())),a.clusterHide(),this._enqueue(function(){g.removeLayer(a);a.clusterShow();f._animationEnd()})):(this._forceLayout(),f._animationStart(),f._animationZoomOutSingle(e,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(a,e,m){var f=this._getExpandedVisibleBounds(),h=Math.floor(this._map.getMinZoom());a._recursivelyAnimateChildrenInAndAddSelfToMap(f,h,e+1,m);var p=this;this._forceLayout();a._recursivelyBecomeVisible(f,m);this._enqueue(function(){if(1===a._childCount){var g=a._markers[0];this._ignoreMove=!0;g.setLatLng(g.getLatLng());this._ignoreMove=!1;g.clusterShow&&g.clusterShow()}else a._recursively(f,m,h,function(a){a._recursivelyRemoveChildrenFromMap(f,h,e+1)});p._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""));this._inZoomAnimation--;this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}});L.markerClusterGroup=function(a){return new L.MarkerClusterGroup(a)};var k=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(a,e,m,g){L.Marker.prototype.initialize.call(this,m?m._cLatLng||m.getLatLng():new L.LatLng(0,0),{icon:this,pane:a.options.clusterPane});this._group=a;this._zoom=e;this._markers=[];this._childClusters=[];this._childCount=0;this._boundsNeedUpdate=this._iconNeedsUpdate=!0;this._bounds=new L.LatLngBounds;m&&this._addChild(m);g&&this._addChild(g)},getAllChildMarkers:function(a,e){a=a||[];for(var f=this._childClusters.length-1;0<=f;f--)this._childClusters[f].getAllChildMarkers(a);for(f=this._markers.length-1;0<=f;f--)e&&this._markers[f].__dragStart||a.push(this._markers[f]);return a},getChildCount:function(){return this._childCount},zoomToBounds:function(a){var e,f=this._childClusters.slice();e=this._group._map;for(var g=e.getBoundsZoom(this._bounds),k=this._zoom+1,p=e.getZoom();0<f.length&&g>k;){k++;var v=[];for(e=0;e<f.length;e++)v=v.concat(f[e]._childClusters);f=v}g>k?this._group._map.setView(this._latlng,k):p>=g?this._group._map.setView(this._latlng,p+1):this._group._map.fitBounds(this._bounds,a)},getBounds:function(){var a=new L.LatLngBounds;return a.extend(this._bounds),a},_updateIcon:function(){this._iconNeedsUpdate=!0;this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(a,e){this._boundsNeedUpdate=this._iconNeedsUpdate=!0;this._setClusterCenter(a);a instanceof L.MarkerCluster?(e||(this._childClusters.push(a),a.__parent=this),this._childCount+=a._childCount):(e||this._markers.push(a),this._childCount++);this.__parent&&this.__parent._addChild(a,!0)},_setClusterCenter:function(a){this._cLatLng||(this._cLatLng=a._cLatLng||a._latlng)},_resetBounds:function(){var a=this._bounds;a._southWest&&(a._southWest.lat=1/0,a._southWest.lng=1/0);a._northEast&&(a._northEast.lat=-1/0,a._northEast.lng=-1/0)},_recalculateBounds:function(){var a,e,m;e=this._markers;var g=this._childClusters,k=0,p=0,v=this._childCount;if(0!==v){this._resetBounds();for(a=0;a<e.length;a++)m=e[a]._latlng,this._bounds.extend(m),k+=m.lat,p+=m.lng;for(a=0;a<g.length;a++)e=g[a],e._boundsNeedUpdate&&e._recalculateBounds(),this._bounds.extend(e._bounds),m=e._wLatLng,e=e._childCount,k+=m.lat*e,p+=m.lng*e;this._latlng=this._wLatLng=new L.LatLng(k/v,p/v);this._boundsNeedUpdate=!1}},_addToMap:function(a){a&&(this._backupLatlng=this._latlng,this.setLatLng(a));this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(a,e,m){this._recursively(a,this._group._map.getMinZoom(),m-1,function(a){var f,g=a._markers;for(a=g.length-1;0<=a;a--)f=g[a],f._icon&&(f._setPos(e),f.clusterHide())},function(a){var f,g=a._childClusters;for(a=g.length-1;0<=a;a--)f=g[a],f._icon&&(f._setPos(e),f.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(a,e,m,g){this._recursively(a,g,e,function(f){f._recursivelyAnimateChildrenIn(a,f._group._map.latLngToLayerPoint(f.getLatLng()).round(),m);f._isSingleParent()&&m-1===g?(f.clusterShow(),f._recursivelyRemoveChildrenFromMap(a,e,m)):f.clusterHide();f._addToMap()})},_recursivelyBecomeVisible:function(a,e){this._recursively(a,this._group._map.getMinZoom(),e,null,function(a){a.clusterShow()})},_recursivelyAddChildrenToMap:function(a,e,m){this._recursively(m,this._group._map.getMinZoom()-1,e,function(f){if(e!==f._zoom)for(var g=f._markers.length-1;0<=g;g--){var h=f._markers[g];m.contains(h._latlng)&&(a&&(h._backupLatlng=h.getLatLng(),h.setLatLng(a),h.clusterHide&&h.clusterHide()),f._group._featureGroup.addLayer(h))}},function(e){e._addToMap(a)})},_recursivelyRestoreChildPositions:function(a){for(var e=this._markers.length-1;0<=e;e--){var f=this._markers[e];f._backupLatlng&&(f.setLatLng(f._backupLatlng),delete f._backupLatlng)}if(a-1===this._zoom)for(a=this._childClusters.length-1;0<=a;a--)this._childClusters[a]._restorePosition();else for(e=this._childClusters.length-1;0<=e;e--)this._childClusters[e]._recursivelyRestoreChildPositions(a)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(a,e,m,g){var f,h;this._recursively(a,e-1,m-1,function(a){for(h=a._markers.length-1;0<=h;h--)f=a._markers[h],g&&g.contains(f._latlng)||(a._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())},function(a){for(h=a._childClusters.length-1;0<=h;h--)f=a._childClusters[h],g&&g.contains(f._latlng)||(a._group._featureGroup.removeLayer(f),f.clusterShow&&f.clusterShow())})},_recursively:function(a,e,m,g,k){var f,h,u=this._childClusters;f=this._zoom;if(f>=e&&(g&&g(this),k&&f===m&&k(this)),e>f||m>f)for(f=u.length-1;0<=f;f--)h=u[f],h._boundsNeedUpdate&&h._recalculateBounds(),a.intersects(h._bounds)&&h._recursively(a,e,m,g,k)},_isSingleParent:function(){return 0<this._childClusters.length&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var a=this.options.opacity;return this.setOpacity(0),this.options.opacity=a,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}});L.DistanceGrid=function(a){this._cellSize=a;this._sqCellSize=a*a;this._grid={};this._objectPoint={}};L.DistanceGrid.prototype={addObject:function(a,e){var f=this._getCoord(e.x),g=this._getCoord(e.y),h=this._grid,g=h[g]=h[g]||{},f=g[f]=g[f]||[],g=L.Util.stamp(a);this._objectPoint[g]=e;f.push(a)},updateObject:function(a,e){this.removeObject(a);this.addObject(a,e)},removeObject:function(a,e){var f,g,h=this._getCoord(e.x);f=this._getCoord(e.y);g=this._grid;var k=g[f]=g[f]||{},v=k[h]=k[h]||[];delete this._objectPoint[L.Util.stamp(a)];f=0;for(g=v.length;g>f;f++)if(v[f]===a)return v.splice(f,1),1===g&&delete k[h],!0},eachObject:function(a,e){var f,g,h,k,v,x,E,z=this._grid;for(f in z)for(g in v=z[f],v)for(x=v[g],h=0,k=x.length;k>h;h++)(E=a.call(e,x[h]))&&(h--,k--)},getNearObject:function(a){var e,f,g,k,p,v,x,E,z=this._getCoord(a.x),H=this._getCoord(a.y),F=this._objectPoint,I=this._sqCellSize,V=null;for(e=H-1;H+1>=e;e++)if(k=this._grid[e])for(f=z-1;z+1>=f;f++)if(p=k[f])for(g=0,v=p.length;v>g;g++)x=p[g],E=this._sqDist(F[L.Util.stamp(x)],a),(I>E||I>=E&&null===V)&&(I=E,V=x);return V},_getCoord:function(a){var e=Math.floor(a/this._cellSize);return isFinite(e)?e:a},_sqDist:function(a,e){var f=e.x-a.x,g=e.y-a.y;return f*f+g*g}};(function(){L.QuickHull={getDistant:function(a,e){return(e[0].lng-e[1].lng)*(a.lat-e[0].lat)+(e[1].lat-e[0].lat)*(a.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(a,e){var f,g,h,k=0,v=null,x=[];for(f=e.length-1;0<=f;f--)g=e[f],h=this.getDistant(g,a),0<h&&(x.push(g),h>k&&(k=h,v=g));return{maxPoint:v,newPoints:x}},buildConvexHull:function(a,e){var f=[],g=this.findMostDistantPointFromBaseLine(a,e);return g.maxPoint?(f=f.concat(this.buildConvexHull([a[0],g.maxPoint],g.newPoints)),f.concat(this.buildConvexHull([g.maxPoint,a[1]],g.newPoints))):[a[0]]},getConvexHull:function(a){var e,f=!1,g=!1,k=!1,p=!1,v=null,x=null,E=null,z=null,H=null,F=null;for(e=a.length-1;0<=e;e--){var I=a[e];(!1===f||I.lat>f)&&(v=I,f=I.lat);(!1===g||I.lat<g)&&(x=I,g=I.lat);(!1===k||I.lng>k)&&(E=I,k=I.lng);(!1===p||I.lng<p)&&(z=I,p=I.lng)}g!==f?(F=x,H=v):(F=z,H=E);return[].concat(this.buildConvexHull([F,H],a),this.buildConvexHull([H,F],a))}}})();L.MarkerCluster.include({getConvexHull:function(){var a,e,m=this.getAllChildMarkers(),g=[];for(e=m.length-1;0<=e;e--)a=m[e].getLatLng(),g.push(a);return L.QuickHull.getConvexHull(g)}});L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var a,e=this.getAllChildMarkers(null,!0),m=this._group._map.latLngToLayerPoint(this._latlng);this._group._unspiderfy();this._group._spiderfied=this;e.length>=this._circleSpiralSwitchover?a=this._generatePointsSpiral(e.length,m):(m.y+=10,a=this._generatePointsCircle(e.length,m));this._animationSpiderfy(e,a)}},unspiderfy:function(a){this._group._inZoomAnimation||(this._animationUnspiderfy(a),this._group._spiderfied=null)},_generatePointsCircle:function(a,e){var f,g,h=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+a)/this._2PI,k=this._2PI/a,v=[],h=Math.max(h,35);v.length=a;for(f=0;a>f;f++)g=this._circleStartAngle+f*k,v[f]=(new L.Point(e.x+h*Math.cos(g),e.y+h*Math.sin(g)))._round();return v},_generatePointsSpiral:function(a,e){var f;f=this._group.options.spiderfyDistanceMultiplier;var g=f*this._spiralLengthStart,h=f*this._spiralFootSeparation,k=f*this._spiralLengthFactor*this._2PI,v=0,x=[];for(f=x.length=a;0<=f;f--)a>f&&(x[f]=(new L.Point(e.x+g*Math.cos(v),e.y+g*Math.sin(v)))._round()),v+=h/g+5E-4*f,g+=k/v;return x},_noanimationUnspiderfy:function(){var a,e,m=this._group,g=m._map,k=m._featureGroup,p=this.getAllChildMarkers(null,!0);m._ignoreMove=!0;this.setOpacity(1);for(e=p.length-1;0<=e;e--)a=p[e],k.removeLayer(a),a._preSpiderfyLatlng&&(a.setLatLng(a._preSpiderfyLatlng),delete a._preSpiderfyLatlng),a.setZIndexOffset&&a.setZIndexOffset(0),a._spiderLeg&&(g.removeLayer(a._spiderLeg),delete a._spiderLeg);m.fire("unspiderfied",{cluster:this,markers:p});m._ignoreMove=!1;m._spiderfied=null}});L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(a,e){var f,g,h,k,v=this._group,x=v._map,E=v._featureGroup,z=this._group.options.spiderLegPolylineOptions;v._ignoreMove=!0;for(f=0;f<a.length;f++)k=x.layerPointToLatLng(e[f]),g=a[f],h=new L.Polyline([this._latlng,k],z),x.addLayer(h),g._spiderLeg=h,g._preSpiderfyLatlng=g._latlng,g.setLatLng(k),g.setZIndexOffset&&g.setZIndexOffset(1E6),E.addLayer(g);this.setOpacity(.3);v._ignoreMove=!1;v.fire("spiderfied",{cluster:this,markers:a})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}});L.MarkerCluster.include({_animationSpiderfy:function(a,e){var f,g,h,k,v,x,E=this,z=this._group,H=z._map,F=z._featureGroup,I=this._latlng,V=H.latLngToLayerPoint(I),aa=L.Path.SVG,fa=L.extend({},this._group.options.spiderLegPolylineOptions),Fa=fa.opacity;void 0===Fa&&(Fa=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity);aa?(fa.opacity=0,fa.className=(fa.className||"")+" leaflet-cluster-spider-leg"):fa.opacity=Fa;z._ignoreMove=!0;for(f=0;f<a.length;f++)g=a[f],x=H.layerPointToLatLng(e[f]),h=new L.Polyline([I,x],fa),H.addLayer(h),g._spiderLeg=h,aa&&(k=h._path,v=k.getTotalLength()+.1,k.style.strokeDasharray=v,k.style.strokeDashoffset=v),g.setZIndexOffset&&g.setZIndexOffset(1E6),g.clusterHide&&g.clusterHide(),F.addLayer(g),g._setPos&&g._setPos(V);z._forceLayout();z._animationStart();for(f=a.length-1;0<=f;f--)x=H.layerPointToLatLng(e[f]),g=a[f],g._preSpiderfyLatlng=g._latlng,g.setLatLng(x),g.clusterShow&&g.clusterShow(),aa&&(h=g._spiderLeg,k=h._path,k.style.strokeDashoffset=0,h.setStyle({opacity:Fa}));this.setOpacity(.3);z._ignoreMove=!1;setTimeout(function(){z._animationEnd();z.fire("spiderfied",{cluster:E,markers:a})},200)},_animationUnspiderfy:function(a){var e,f,g,k,p,v,x=this,E=this._group,z=E._map,H=E._featureGroup;a=a?z._latLngToNewLayerPoint(this._latlng,a.zoom,a.center):z.latLngToLayerPoint(this._latlng);var F=this.getAllChildMarkers(null,!0),I=L.Path.SVG;E._ignoreMove=!0;E._animationStart();this.setOpacity(1);for(f=F.length-1;0<=f;f--)e=F[f],e._preSpiderfyLatlng&&(e.closePopup(),e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng,v=!0,e._setPos&&(e._setPos(a),v=!1),e.clusterHide&&(e.clusterHide(),v=!1),v&&H.removeLayer(e),I&&(g=e._spiderLeg,k=g._path,p=k.getTotalLength()+.1,k.style.strokeDashoffset=p,g.setStyle({opacity:0})));E._ignoreMove=!1;setTimeout(function(){var a=0;for(f=F.length-1;0<=f;f--)e=F[f],e._spiderLeg&&a++;for(f=F.length-1;0<=f;f--)e=F[f],e._spiderLeg&&(e.clusterShow&&e.clusterShow(),e.setZIndexOffset&&e.setZIndexOffset(0),1<a&&H.removeLayer(e),z.removeLayer(e._spiderLeg),delete e._spiderLeg);E._animationEnd();E.fire("unspiderfied",{cluster:x,markers:F})},200)}});L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this);this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this);this._map.on("zoomend",this._noanimationUnspiderfy,this);L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this);this._map.off("zoomstart",this._unspiderfyZoomStart,this);this._map.off("zoomanim",this._unspiderfyZoomAnim,this);this._map.off("zoomend",this._noanimationUnspiderfy,this);this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(a){null!=this._map&&(L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(a)))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(a){this._spiderfied&&this._spiderfied.unspiderfy(a)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(a){a._spiderLeg&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow(),a.setZIndexOffset&&a.setZIndexOffset(0),this._map.removeLayer(a._spiderLeg),delete a._spiderLeg)}});L.MarkerClusterGroup.include({refreshClusters:function(a){return a?a instanceof L.MarkerClusterGroup?a=a._topClusterLevel.getAllChildMarkers():a instanceof L.LayerGroup?a=a._layers:a instanceof L.MarkerCluster?a=a.getAllChildMarkers():a instanceof L.Marker&&(a=[a]):a=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(a),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(a),this},_flagParentsIconsNeedUpdate:function(a){var e,f;for(e in a)for(f=a[e].__parent;f;)f._iconNeedsUpdate=!0,f=f.__parent},_refreshSingleMarkerModeMarkers:function(a){var e,f;for(e in a)f=a[e],this.hasLayer(f)&&f.setIcon(this._overrideMarkerIcon(f))}});L.Marker.include({refreshIconOptions:function(a,e){var f=this.options.icon;return L.setOptions(f,a),this.setIcon(f),e&&this.__parent&&this.__parent._group.refreshClusters(this),this}});a.MarkerClusterGroup=e;a.MarkerCluster=k});"use strict";function __$strToBlobUri(a,e,k){try{return window.URL.createObjectURL(new Blob([Uint8Array.from(a.split("").map(function(a){return a.charCodeAt(0)}))],{type:e}))}catch(f){return"data:"+e+(k?";base64,":",")+a}}L.SVG.Tile=L.SVG.extend({initialize:function(a,e,k){L.SVG.prototype.initialize.call(this,k);this._tileCoord=a;this._size=e;this._initContainer();this._container.setAttribute("width",this._size.x);this._container.setAttribute("height",this._size.y);this._container.setAttribute("viewBox",[0,0,this._size.x,this._size.y].join(" "));this._layers={}},getCoord:function(){return this._tileCoord},getContainer:function(){return this._container},onAdd:L.Util.falseFn,addTo:function(a){this._map=a;if(this.options.interactive)for(var e in this._layers)a=this._layers[e],a._path.style.pointerEvents="auto",this._map._targets[L.stamp(a._path)]=a},removeFrom:function(a){if(this.options.interactive)for(var e in this._layers)delete this._map._targets[L.stamp(this._layers[e]._path)];delete this._map},_initContainer:function(){L.SVG.prototype._initContainer.call(this);L.SVG.create("rect")},_addPath:function(a){this._rootGroup.appendChild(a._path);this._layers[L.stamp(a)]=a},_updateIcon:function(a){var e=a._path=L.SVG.create("image"),k=a.options.icon.options,f=L.point(k.iconSize),h=k.iconAnchor||f&&f.divideBy(2,!0);a=a._point.subtract(h);e.setAttribute("x",a.x);e.setAttribute("y",a.y);e.setAttribute("width",f.x+"px");e.setAttribute("height",f.y+"px");e.setAttribute("href",k.iconUrl)}});L.svg.tile=function(a,e,k){return new L.SVG.Tile(a,e,k)};var Symbolizer=L.Class.extend({render:function(a,e){this._renderer=a;this.options=e;a._initPath(this);a._updateStyle(this)},updateStyle:function(a,e){this.options=e;a._updateStyle(this)},_getPixelBounds:function(){for(var a=this._parts,e=L.bounds([]),k=0;k<a.length;k++)for(var f=a[k],h=0;h<f.length;h++)e.extend(f[h]);a=this._clickTolerance();a=new L.Point(a,a);e.min._subtract(a);e.max._add(a);return e},_clickTolerance:L.Path.prototype._clickTolerance}),PolyBase={_makeFeatureParts:function(a,e){var k=a.geometry,f;this._parts=[];for(var h=0;h<k.length;h++){for(var m=k[h],g=[],u=0;u<m.length;u++)f=m[u],g.push(L.point(f).scaleBy(e));this._parts.push(g)}},makeInteractive:function(){this._pxBounds=this._getPixelBounds()}},PointSymbolizer=L.CircleMarker.extend({includes:Symbolizer.prototype,statics:{iconCache:{}},initialize:function(a,e){this.properties=a.properties;this._makeFeatureParts(a,e)},render:function(a,e){Symbolizer.prototype.render.call(this,a,e);this._radius=e.radius||L.CircleMarker.prototype.options.radius;this._updatePath()},_makeFeatureParts:function(a,e){var k=a.geometry[0];this._point="object"===typeof k[0]&&"x"in k[0]?L.point(k[0]).scaleBy(e):L.point(k).scaleBy(e);this._empty=L.Util.falseFn},makeInteractive:function(){this._updateBounds()},updateStyle:function(a,e){this._radius=e.radius||this._radius;this._updateBounds();return Symbolizer.prototype.updateStyle.call(this,a,e)},_updateBounds:function(){var a=this.options.icon;if(a){var e=L.point(a.options.iconSize),e=a.options.iconAnchor||e&&e.divideBy(2,!0),e=this._point.subtract(e);this._pxBounds=new L.Bounds(e,e.add(a.options.iconSize))}else L.CircleMarker.prototype._updateBounds.call(this)},_updatePath:function(){this.options.icon?this._renderer._updateIcon(this):L.CircleMarker.prototype._updatePath.call(this)},_getImage:function(){if(this.options.icon){var a=this.options.icon.options.iconUrl,e=PointSymbolizer.iconCache[a];e||(e=PointSymbolizer.iconCache[a]=this.options.icon.createIcon());return e}return null},_containsPoint:function(a){return this.options.icon?this._pxBounds.contains(a):L.CircleMarker.prototype._containsPoint.call(this,a)}}),LineSymbolizer=L.Polyline.extend({includes:[Symbolizer.prototype,PolyBase],initialize:function(a,e){this.properties=a.properties;this._makeFeatureParts(a,e)},render:function(a,e){e.fill=!1;Symbolizer.prototype.render.call(this,a,e);this._updatePath()},updateStyle:function(a,e){e.fill=!1;Symbolizer.prototype.updateStyle.call(this,a,e)}}),FillSymbolizer=L.Polygon.extend({includes:[Symbolizer.prototype,PolyBase],initialize:function(a,e){this.properties=a.properties;this._makeFeatureParts(a,e)},render:function(a,e){Symbolizer.prototype.render.call(this,a,e);this._updatePath()}});L.VectorGrid=L.GridLayer.extend({options:{rendererFactory:L.svg.tile,vectorTileLayerStyles:{},interactive:!1},initialize:function(a){L.setOptions(this,a);L.GridLayer.prototype.initialize.apply(this,arguments);this.options.getFeatureId&&(this._vectorTiles={},this._overriddenStyles={},this.on("tileunload",function(a){a=this._tileCoordsToKey(a.coords);var e=this._vectorTiles[a];e&&this._map&&e.removeFrom(this._map);delete this._vectorTiles[a]},this));this._dataLayerNames={}},createTile:function(a,e){var k=this.options.getFeatureId,f=this.getTileSize(),h=this.options.rendererFactory(a,f,this.options),f=this._getVectorTilePromise(a);k&&(this._vectorTiles[this._tileCoordsToKey(a)]=h,h._features={});f.then(function(f){for(var g in f.layers){this._dataLayerNames[g]=!0;for(var m=f.layers[g],p=this.getTileSize().divideBy(m.extent),v=this.options.vectorTileLayerStyles[g]||L.Path.prototype.options,x=0;x<m.features.length;x++){var E=m.features[x],z,H=v;if(k){z=this.options.getFeatureId(E);var F=this._overriddenStyles[z];F&&(H=F[g]?F[g]:F)}H instanceof Function&&(H=H(E.properties,a.z));H instanceof Array||(H=[H]);if(H.length){E=this._createLayer(E,p);for(F=0;F<H.length;F++){var I=L.extend({},L.Path.prototype.options,H[F]);E.render(h,I);h._addPath(E)}this.options.interactive&&E.makeInteractive();k&&(h._features[z]={layerName:g,feature:E})}}}null!=this._map&&h.addTo(this._map);L.Util.requestAnimFrame(e.bind(a,null,null))}.bind(this));return h.getContainer()},setFeatureStyle:function(a,e){this._overriddenStyles[a]=e;for(var k in this._vectorTiles){var f=this._vectorTiles[k],h=f._features[a];if(h){var m=h.feature,g=e;e[h.layerName]&&(g=e[h.layerName]);this._updateStyles(m,f,g)}}return this},resetFeatureStyle:function(a){delete this._overriddenStyles[a];for(var e in this._vectorTiles){var k=this._vectorTiles[e],f=k._features[a];f&&this._updateStyles(f.feature,k,this.options.vectorTileLayerStyles[f.layerName]||L.Path.prototype.options)}return this},getDataLayerNames:function(){return Object.keys(this._dataLayerNames)},_updateStyles:function(a,e,k){k=k instanceof Function?k(a.properties,e.getCoord().z):k;k instanceof Array||(k=[k]);for(var f=0;f<k.length;f++){var h=L.extend({},L.Path.prototype.options,k[f]);a.updateStyle(e,h)}},_createLayer:function(a,e,k){var f;switch(a.type){case 1:f=new PointSymbolizer(a,e);break;case 2:f=new LineSymbolizer(a,e);break;case 3:f=new FillSymbolizer(a,e)}this.options.interactive&&f.addEventParent(this);return f}});L.vectorGrid=function(a){return new L.VectorGrid(a)};var read=function(a,e,k,f,h){var m;m=8*h-f-1;var g=(1<<m)-1,u=g>>1,p=-7;h=k?h-1:0;var v=k?-1:1,x=a[e+h];h+=v;k=x&(1<<-p)-1;x>>=-p;for(p+=m;0<p;k=256*k+a[e+h],h+=v,p-=8);m=k&(1<<-p)-1;k>>=-p;for(p+=f;0<p;m=256*m+a[e+h],h+=v,p-=8);if(0===k)k=1-u;else{if(k===g)return m?NaN:Infinity*(x?-1:1);m+=Math.pow(2,f);k-=u}return(x?-1:1)*m*Math.pow(2,k-f)},write=function(a,e,k,f,h,m){var g,u=8*m-h-1,p=(1<<u)-1,v=p>>1,x=23===h?Math.pow(2,-24)-Math.pow(2,-77):0;m=f?0:m-1;var E=f?1:-1,z=0>e||0===e&&0>1/e?1:0;e=Math.abs(e);isNaN(e)||Infinity===e?(e=isNaN(e)?1:0,f=p):(f=Math.floor(Math.log(e)/Math.LN2),1>e*(g=Math.pow(2,-f))&&(f--,g*=2),e=1<=f+v?e+x/g:e+x*Math.pow(2,1-v),2<=e*g&&(f++,g/=2),f+v>=p?(e=0,f=p):1<=f+v?(e=(e*g-1)*Math.pow(2,h),f+=v):(e=e*Math.pow(2,v-1)*Math.pow(2,h),f=0));for(;8<=h;a[k+m]=e&255,m+=E,e/=256,h-=8);f=f<<h|e;for(u+=h;0<u;a[k+m]=f&255,m+=E,f/=256,u-=8);a[k+m-E]|=128*z},index$1={read:read,write:write},index=Pbf,ieee754=index$1;function Pbf(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0);this.type=this.pos=0;this.length=this.buf.length}Pbf.Varint=0;Pbf.Fixed64=1;Pbf.Bytes=2;Pbf.Fixed32=5;var SHIFT_LEFT_32=4294967296,SHIFT_RIGHT_32=1/SHIFT_LEFT_32;Pbf.prototype={destroy:function(){this.buf=null},readFields:function(a,e,k){for(k=k||this.length;this.pos<k;){var f=this.readVarint(),h=f>>3,m=this.pos;this.type=f&7;a(h,e,this);this.pos===m&&this.skip(f)}return e},readMessage:function(a,e){return this.readFields(a,e,this.readVarint()+this.pos)},readFixed32:function(){var a=readUInt32(this.buf,this.pos);this.pos+=4;return a},readSFixed32:function(){var a=readInt32(this.buf,this.pos);this.pos+=4;return a},readFixed64:function(){var a=readUInt32(this.buf,this.pos)+readUInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;this.pos+=8;return a},readSFixed64:function(){var a=readUInt32(this.buf,this.pos)+readInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;this.pos+=8;return a},readFloat:function(){var a=ieee754.read(this.buf,this.pos,!0,23,4);this.pos+=4;return a},readDouble:function(){var a=ieee754.read(this.buf,this.pos,!0,52,8);this.pos+=8;return a},readVarint:function(a){var e=this.buf,k,f;f=e[this.pos++];k=f&127;if(128>f)return k;f=e[this.pos++];k|=(f&127)<<7;if(128>f)return k;f=e[this.pos++];k|=(f&127)<<14;if(128>f)return k;f=e[this.pos++];k|=(f&127)<<21;if(128>f)return k;f=e[this.pos];return readVarintRemainder(k|(f&15)<<28,a,this)},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return 1===a%2?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,e=readUtf8(this.buf,this.pos,a);this.pos=a;return e},readBytes:function(){var a=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,a);this.pos=a;return e},readPackedVarint:function(a,e){var k=readPackedEnd(this);for(a=a||[];this.pos<k;)a.push(this.readVarint(e));return a},readPackedSVarint:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readBoolean());return a},readPackedFloat:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readFloat());return a},readPackedDouble:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readDouble());return a},readPackedFixed32:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){var e=readPackedEnd(this);for(a=a||[];this.pos<e;)a.push(this.readSFixed64());return a},skip:function(a){a&=7;if(a===Pbf.Varint)for(;127<this.buf[this.pos++];);else if(a===Pbf.Bytes)this.pos=this.readVarint()+this.pos;else if(a===Pbf.Fixed32)this.pos+=4;else if(a===Pbf.Fixed64)this.pos+=8;else throw Error("Unimplemented type: "+a);},writeTag:function(a,e){this.writeVarint(a<<3|e)},realloc:function(a){for(var e=this.length||16;e<this.pos+a;)e*=2;e!==this.length&&(a=new Uint8Array(e),a.set(this.buf),this.buf=a,this.length=e)},finish:function(){this.length=this.pos;this.pos=0;return this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4);writeInt32(this.buf,a,this.pos);this.pos+=4},writeSFixed32:function(a){this.realloc(4);writeInt32(this.buf,a,this.pos);this.pos+=4},writeFixed64:function(a){this.realloc(8);writeInt32(this.buf,a&-1,this.pos);writeInt32(this.buf,Math.floor(a*SHIFT_RIGHT_32),this.pos+4);this.pos+=8},writeSFixed64:function(a){this.realloc(8);writeInt32(this.buf,a&-1,this.pos);writeInt32(this.buf,Math.floor(a*SHIFT_RIGHT_32),this.pos+4);this.pos+=8},writeVarint:function(a){a=+a||0;268435455<a||0>a?writeBigVarint(a,this):(this.realloc(4),this.buf[this.pos++]=a&127|(127<a?128:0),127>=a||(this.buf[this.pos++]=(a>>>=7)&127|(127<a?128:0),127>=a||(this.buf[this.pos++]=(a>>>=7)&127|(127<a?128:0),127>=a||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(0>a?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a);this.realloc(4*a.length);this.pos++;var e=this.pos;this.pos=writeUtf8(this.buf,a,this.pos);a=this.pos-e;128<=a&&makeRoomForExtraLength(e,a,this);this.pos=e-1;this.writeVarint(a);this.pos+=a},writeFloat:function(a){this.realloc(4);ieee754.write(this.buf,a,this.pos,!0,23,4);this.pos+=4},writeDouble:function(a){this.realloc(8);ieee754.write(this.buf,a,this.pos,!0,52,8);this.pos+=8},writeBytes:function(a){var e=a.length;this.writeVarint(e);this.realloc(e);for(var k=0;k<e;k++)this.buf[this.pos++]=a[k]},writeRawMessage:function(a,e){this.pos++;var k=this.pos;a(e,this);var f=this.pos-k;128<=f&&makeRoomForExtraLength(k,f,this);this.pos=k-1;this.writeVarint(f);this.pos+=f},writeMessage:function(a,e,k){this.writeTag(a,Pbf.Bytes);this.writeRawMessage(e,k)},writePackedVarint:function(a,e){this.writeMessage(a,writePackedVarint,e)},writePackedSVarint:function(a,e){this.writeMessage(a,writePackedSVarint,e)},writePackedBoolean:function(a,e){this.writeMessage(a,writePackedBoolean,e)},writePackedFloat:function(a,e){this.writeMessage(a,writePackedFloat,e)},writePackedDouble:function(a,e){this.writeMessage(a,writePackedDouble,e)},writePackedFixed32:function(a,e){this.writeMessage(a,writePackedFixed32,e)},writePackedSFixed32:function(a,e){this.writeMessage(a,writePackedSFixed32,e)},writePackedFixed64:function(a,e){this.writeMessage(a,writePackedFixed64,e)},writePackedSFixed64:function(a,e){this.writeMessage(a,writePackedSFixed64,e)},writeBytesField:function(a,e){this.writeTag(a,Pbf.Bytes);this.writeBytes(e)},writeFixed32Field:function(a,e){this.writeTag(a,Pbf.Fixed32);this.writeFixed32(e)},writeSFixed32Field:function(a,e){this.writeTag(a,Pbf.Fixed32);this.writeSFixed32(e)},writeFixed64Field:function(a,e){this.writeTag(a,Pbf.Fixed64);this.writeFixed64(e)},writeSFixed64Field:function(a,e){this.writeTag(a,Pbf.Fixed64);this.writeSFixed64(e)},writeVarintField:function(a,e){this.writeTag(a,Pbf.Varint);this.writeVarint(e)},writeSVarintField:function(a,e){this.writeTag(a,Pbf.Varint);this.writeSVarint(e)},writeStringField:function(a,e){this.writeTag(a,Pbf.Bytes);this.writeString(e)},writeFloatField:function(a,e){this.writeTag(a,Pbf.Fixed32);this.writeFloat(e)},writeDoubleField:function(a,e){this.writeTag(a,Pbf.Fixed64);this.writeDouble(e)},writeBooleanField:function(a,e){this.writeVarintField(a,!!e)}};function readVarintRemainder(a,e,k){var f=k.buf,h,m;m=f[k.pos++];h=(m&112)>>4;if(128>m)return toNum(a,h,e);m=f[k.pos++];h|=(m&127)<<3;if(128>m)return toNum(a,h,e);m=f[k.pos++];h|=(m&127)<<10;if(128>m)return toNum(a,h,e);m=f[k.pos++];h|=(m&127)<<17;if(128>m)return toNum(a,h,e);m=f[k.pos++];h|=(m&127)<<24;if(128>m)return toNum(a,h,e);m=f[k.pos++];if(128>m)return toNum(a,h|(m&1)<<31,e);throw Error("Expected varint not more than 10 bytes");}function readPackedEnd(a){return a.type===Pbf.Bytes?a.readVarint()+a.pos:a.pos+1}function toNum(a,e,k){return k?4294967296*e+(a>>>0):4294967296*(e>>>0)+(a>>>0)}function writeBigVarint(a,e){var k,f;0<=a?(k=a%4294967296|0,f=a/4294967296|0):(k=~(-a%4294967296),f=~(-a/4294967296),k^4294967295?k=k+1|0:(k=0,f=f+1|0));if(1.8446744073709552E19<=a||-1.8446744073709552E19>a)throw Error("Given varint doesn't fit into 10 bytes");e.realloc(10);writeBigVarintLow(k,f,e);writeBigVarintHigh(f,e)}function writeBigVarintLow(a,e,k){k.buf[k.pos++]=a&127|128;a>>>=7;k.buf[k.pos++]=a&127|128;a>>>=7;k.buf[k.pos++]=a&127|128;a>>>=7;k.buf[k.pos++]=a&127|128;k.buf[k.pos]=a>>>7&127}function writeBigVarintHigh(a,e){e.buf[e.pos++]|=(a&7)<<4|((a>>>=3)?128:0);a&&(e.buf[e.pos++]=a&127|((a>>>=7)?128:0),a&&(e.buf[e.pos++]=a&127|((a>>>=7)?128:0),a&&(e.buf[e.pos++]=a&127|((a>>>=7)?128:0),a&&(e.buf[e.pos++]=a&127|((a>>>=7)?128:0),a&&(e.buf[e.pos++]=a&127)))))}function makeRoomForExtraLength(a,e,k){e=16383>=e?1:2097151>=e?2:268435455>=e?3:Math.ceil(Math.log(e)/(7*Math.LN2));k.realloc(e);for(var f=k.pos-1;f>=a;f--)k.buf[f+e]=k.buf[f]}function writePackedVarint(a,e){for(var k=0;k<a.length;k++)e.writeVarint(a[k])}function writePackedSVarint(a,e){for(var k=0;k<a.length;k++)e.writeSVarint(a[k])}function writePackedFloat(a,e){for(var k=0;k<a.length;k++)e.writeFloat(a[k])}function writePackedDouble(a,e){for(var k=0;k<a.length;k++)e.writeDouble(a[k])}function writePackedBoolean(a,e){for(var k=0;k<a.length;k++)e.writeBoolean(a[k])}function writePackedFixed32(a,e){for(var k=0;k<a.length;k++)e.writeFixed32(a[k])}function writePackedSFixed32(a,e){for(var k=0;k<a.length;k++)e.writeSFixed32(a[k])}function writePackedFixed64(a,e){for(var k=0;k<a.length;k++)e.writeFixed64(a[k])}function writePackedSFixed64(a,e){for(var k=0;k<a.length;k++)e.writeSFixed64(a[k])}function readUInt32(a,e){return(a[e]|a[e+1]<<8|a[e+2]<<16)+16777216*a[e+3]}function writeInt32(a,e,k){a[k]=e;a[k+1]=e>>>8;a[k+2]=e>>>16;a[k+3]=e>>>24}function readInt32(a,e){return(a[e]|a[e+1]<<8|a[e+2]<<16)+(a[e+3]<<24)}function readUtf8(a,e,k){for(var f="";e<k;){var h=a[e],m=null,g=239<h?4:223<h?3:191<h?2:1;if(e+g>k)break;var u,p,v;if(1===g)128>h&&(m=h);else if(2===g)u=a[e+1],128===(u&192)&&(m=(h&31)<<6|u&63,127>=m&&(m=null));else if(3===g){if(u=a[e+1],p=a[e+2],128===(u&192)&&128===(p&192)&&(m=(h&15)<<12|(u&63)<<6|p&63,2047>=m||55296<=m&&57343>=m))m=null}else 4===g&&(u=a[e+1],p=a[e+2],v=a[e+3],128===(u&192)&&128===(p&192)&&128===(v&192)&&(m=(h&15)<<18|(u&63)<<12|(p&63)<<6|v&63,65535>=m||1114112<=m))&&(m=null);null===m?(m=65533,g=1):65535<m&&(m-=65536,f+=String.fromCharCode(m>>>10&1023|55296),m=56320|m&1023);f+=String.fromCharCode(m);e+=g}return f}function writeUtf8(a,e,k){for(var f=0,h,m;f<e.length;f++){h=e.charCodeAt(f);if(55295<h&&57344>h)if(m)if(56320>h){a[k++]=239;a[k++]=191;a[k++]=189;m=h;continue}else h=m-55296<<10|h-56320|65536,m=null;else{56319<h||f+1===e.length?(a[k++]=239,a[k++]=191,a[k++]=189):m=h;continue}else m&&(a[k++]=239,a[k++]=191,a[k++]=189,m=null);128>h?a[k++]=h:(2048>h?a[k++]=h>>6|192:(65536>h?a[k++]=h>>12|224:(a[k++]=h>>18|240,a[k++]=h>>12&63|128),a[k++]=h>>6&63|128),a[k++]=h&63|128)}return k}var index$5=Point$1;function Point$1(a,e){this.x=a;this.y=e}Point$1.prototype={clone:function(){return new Point$1(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var e=a.x-this.x;a=a.y-this.y;return e*e+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,e){return Math.atan2(this.x*e-this.y*a,this.x*a+this.y*e)},_matMult:function(a){var e=a[2]*this.x+a[3]*this.y;this.x=a[0]*this.x+a[1]*this.y;this.y=e;return this},_add:function(a){this.x+=a.x;this.y+=a.y;return this},_sub:function(a){this.x-=a.x;this.y-=a.y;return this},_mult:function(a){this.x*=a;this.y*=a;return this},_div:function(a){this.x/=a;this.y/=a;return this},_unit:function(){this._div(this.mag());return this},_perp:function(){var a=this.y;this.y=this.x;this.x=-a;return this},_rotate:function(a){var e=Math.cos(a);a=Math.sin(a);var k=a*this.x+e*this.y;this.x=e*this.x-a*this.y;this.y=k;return this},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}};Point$1.convert=function(a){return a instanceof Point$1?a:Array.isArray(a)?new Point$1(a[0],a[1]):a};var Point=index$5,vectortilefeature=VectorTileFeature$2;function VectorTileFeature$2(a,e,k,f,h){this.properties={};this.extent=k;this.type=0;this._pbf=a;this._geometry=-1;this._keys=f;this._values=h;a.readFields(readFeature,this,e)}function readFeature(a,e,k){1==a?e.id=k.readVarint():2==a?readTag(k,e):3==a?e.type=k.readVarint():4==a&&(e._geometry=k.pos)}function readTag(a,e){for(var k=a.readVarint()+a.pos;a.pos<k;){var f=e._keys[a.readVarint()],h=e._values[a.readVarint()];e.properties[f]=h}}VectorTileFeature$2.types=["Unknown","Point","LineString","Polygon"];VectorTileFeature$2.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var e=a.readVarint()+a.pos,k=1,f=0,h=0,m=0,g=[],u;a.pos<e;)if(f||(f=a.readVarint(),k=f&7,f>>=3),f--,1===k||2===k)h+=a.readSVarint(),m+=a.readSVarint(),1===k&&(u&&g.push(u),u=[]),u.push(new Point(h,m));else if(7===k)u&&u.push(u[0].clone());else throw Error("unknown command "+k);u&&g.push(u);return g};VectorTileFeature$2.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var e=a.readVarint()+a.pos,k=1,f=0,h=0,m=0,g=Infinity,u=-Infinity,p=Infinity,v=-Infinity;a.pos<e;)if(f||(f=a.readVarint(),k=f&7,f>>=3),f--,1===k||2===k)h+=a.readSVarint(),m+=a.readSVarint(),h<g&&(g=h),h>u&&(u=h),m<p&&(p=m),m>v&&(v=m);else if(7!==k)throw Error("unknown command "+k);return[g,p,u,v]};VectorTileFeature$2.prototype.toGeoJSON=function(a,e,k){function f(a){for(var e=0;e<a.length;e++){var f=a[e];a[e]=[360*(f.x+m)/h-180,360/Math.PI*Math.atan(Math.exp((180-360*(f.y+g)/h)*Math.PI/180))-90]}}var h=this.extent*Math.pow(2,k),m=this.extent*a,g=this.extent*e;a=this.loadGeometry();e=VectorTileFeature$2.types[this.type];var u;switch(this.type){case 1:u=[];for(k=0;k<a.length;k++)u[k]=a[k][0];a=u;f(a);break;case 2:for(k=0;k<a.length;k++)f(a[k]);break;case 3:for(a=classifyRings(a),k=0;k<a.length;k++)for(u=0;u<a[k].length;u++)f(a[k][u])}1===a.length?a=a[0]:e="Multi"+e;a={type:"Feature",geometry:{type:e,coordinates:a},properties:this.properties};"id"in this&&(a.id=this.id);return a};function classifyRings(a){var e=a.length;if(1>=e)return[a];for(var k=[],f,h,m=0;m<e;m++){var g=signedArea(a[m]);0!==g&&(void 0===h&&(h=0>g),h===0>g?(f&&k.push(f),f=[a[m]]):f.push(a[m]))}f&&k.push(f);return k}function signedArea(a){for(var e=0,k=0,f=a.length,h=f-1,m;k<f;h=k++)m=a[k],h=a[h],e+=(h.x-m.x)*(m.y+h.y);return e}var VectorTileFeature$1=vectortilefeature,vectortilelayer=VectorTileLayer$2;function VectorTileLayer$2(a,e){this.version=1;this.name=null;this.extent=4096;this.length=0;this._pbf=a;this._keys=[];this._values=[];this._features=[];a.readFields(readLayer,this,e);this.length=this._features.length}function readLayer(a,e,k){15===a?e.version=k.readVarint():1===a?e.name=k.readString():5===a?e.extent=k.readVarint():2===a?e._features.push(k.pos):3===a?e._keys.push(k.readString()):4===a&&e._values.push(readValueMessage(k))}function readValueMessage(a){for(var e=null,k=a.readVarint()+a.pos;a.pos<k;)e=a.readVarint()>>3,e=1===e?a.readString():2===e?a.readFloat():3===e?a.readDouble():4===e?a.readVarint64():5===e?a.readVarint():6===e?a.readSVarint():7===e?a.readBoolean():null;return e}VectorTileLayer$2.prototype.feature=function(a){if(0>a||a>=this._features.length)throw Error("feature index out of bounds");this._pbf.pos=this._features[a];a=this._pbf.readVarint()+this._pbf.pos;return new VectorTileFeature$1(this._pbf,a,this.extent,this._keys,this._values)};var VectorTileLayer$1=vectortilelayer,vectortile=VectorTile$1;function VectorTile$1(a,e){this.layers=a.readFields(readTile,{},e)}function readTile(a,e,k){3===a&&(a=new VectorTileLayer$1(k,k.readVarint()+k.pos),a.length&&(e[a.name]=a))}var VectorTile=vectortile;L.VectorGrid.Protobuf=L.VectorGrid.extend({options:{subdomains:"abc",fetchOptions:{}},initialize:function(a,e){this._url=a;L.VectorGrid.prototype.initialize.call(this,e)},setUrl:function(a,e){this._url=a;e||this.redraw();return this},_getSubdomain:L.TileLayer.prototype._getSubdomain,_getVectorTilePromise:function(a){var e={s:this._getSubdomain(a),x:a.x,y:a.y,z:a.z};this._map&&!this._map.options.crs.infinite&&(a=this._globalTileRange.max.y-a.y,this.options.tms&&(e.y=a),e["-y"]=a);e=L.Util.template(this._url,L.extend(e,this.options));return fetch(e,this.options.fetchOptions).then(function(a){return a.ok?a.blob().then(function(a){var e=new FileReader;return new Promise(function(f){e.addEventListener("loadend",function(){var a=new index(e.result);return f(new VectorTile(a))});e.readAsArrayBuffer(a)})}):{layers:[]}}).then(function(a){for(var e in a.layers){for(var h=[],m=0;m<a.layers[e].length;m++){var g=a.layers[e].feature(m);g.geometry=g.loadGeometry();h.push(g)}a.layers[e].features=h}return a})}});L.vectorGrid.protobuf=function(a,e){return new L.VectorGrid.Protobuf(a,e)};var workerCode=__$strToBlobUri("'use strict';\n\nvar simplify_1 \x3d simplify$1;\n\n// calculate simplification data using optimized Douglas-Peucker algorithm\n\nfunction simplify$1(points, tolerance) {\n\n    var sqTolerance \x3d tolerance * tolerance,\n        len \x3d points.length,\n        first \x3d 0,\n        last \x3d len - 1,\n        stack \x3d [],\n        i, maxSqDist, sqDist, index;\n\n    // always retain the endpoints (1 is the max value)\n    points[first][2] \x3d 1;\n    points[last][2] \x3d 1;\n\n    // avoid recursion by using a stack\n    while (last) {\n\n        maxSqDist \x3d 0;\n\n        for (i \x3d first + 1; i \x3c last; i++) {\n            sqDist \x3d getSqSegDist(points[i], points[first], points[last]);\n\n            if (sqDist \x3e maxSqDist) {\n                index \x3d i;\n                maxSqDist \x3d sqDist;\n            }\n        }\n\n        if (maxSqDist \x3e sqTolerance) {\n            points[index][2] \x3d maxSqDist; // save the point importance in squared pixels as a z coordinate\n            stack.push(first);\n            stack.push(index);\n            first \x3d index;\n\n        } else {\n            last \x3d stack.pop();\n            first \x3d stack.pop();\n        }\n    }\n}\n\n// square distance from a point to a segment\nfunction getSqSegDist(p, a, b) {\n\n    var x \x3d a[0], y \x3d a[1],\n        bx \x3d b[0], by \x3d b[1],\n        px \x3d p[0], py \x3d p[1],\n        dx \x3d bx - x,\n        dy \x3d by - y;\n\n    if (dx !\x3d\x3d 0 || dy !\x3d\x3d 0) {\n\n        var t \x3d ((px - x) * dx + (py - y) * dy) / (dx * dx + dy * dy);\n\n        if (t \x3e 1) {\n            x \x3d bx;\n            y \x3d by;\n\n        } else if (t \x3e 0) {\n            x +\x3d dx * t;\n            y +\x3d dy * t;\n        }\n    }\n\n    dx \x3d px - x;\n    dy \x3d py - y;\n\n    return dx * dx + dy * dy;\n}\n\nvar convert_1 \x3d convert$1;\n\nvar simplify \x3d simplify_1;\n\n// converts GeoJSON feature into an intermediate projected JSON vector format with simplification data\n\nfunction convert$1(data, tolerance) {\n    var features \x3d [];\n\n    if (data.type \x3d\x3d\x3d 'FeatureCollection') {\n        for (var i \x3d 0; i \x3c data.features.length; i++) {\n            convertFeature(features, data.features[i], tolerance);\n        }\n    } else if (data.type \x3d\x3d\x3d 'Feature') {\n        convertFeature(features, data, tolerance);\n\n    } else {\n        // single geometry or a geometry collection\n        convertFeature(features, {geometry: data}, tolerance);\n    }\n    return features;\n}\n\nfunction convertFeature(features, feature, tolerance) {\n    if (feature.geometry \x3d\x3d\x3d null) {\n        // ignore features with null geometry\n        return;\n    }\n\n    var geom \x3d feature.geometry,\n        type \x3d geom.type,\n        coords \x3d geom.coordinates,\n        tags \x3d feature.properties,\n        i, j, rings, projectedRing;\n\n    if (type \x3d\x3d\x3d 'Point') {\n        features.push(create(tags, 1, [projectPoint(coords)]));\n\n    } else if (type \x3d\x3d\x3d 'MultiPoint') {\n        features.push(create(tags, 1, project(coords)));\n\n    } else if (type \x3d\x3d\x3d 'LineString') {\n        features.push(create(tags, 2, [project(coords, tolerance)]));\n\n    } else if (type \x3d\x3d\x3d 'MultiLineString' || type \x3d\x3d\x3d 'Polygon') {\n        rings \x3d [];\n        for (i \x3d 0; i \x3c coords.length; i++) {\n            projectedRing \x3d project(coords[i], tolerance);\n            if (type \x3d\x3d\x3d 'Polygon') { projectedRing.outer \x3d (i \x3d\x3d\x3d 0); }\n            rings.push(projectedRing);\n        }\n        features.push(create(tags, type \x3d\x3d\x3d 'Polygon' ? 3 : 2, rings));\n\n    } else if (type \x3d\x3d\x3d 'MultiPolygon') {\n        rings \x3d [];\n        for (i \x3d 0; i \x3c coords.length; i++) {\n            for (j \x3d 0; j \x3c coords[i].length; j++) {\n                projectedRing \x3d project(coords[i][j], tolerance);\n                projectedRing.outer \x3d (j \x3d\x3d\x3d 0);\n                rings.push(projectedRing);\n            }\n        }\n        features.push(create(tags, 3, rings));\n\n    } else if (type \x3d\x3d\x3d 'GeometryCollection') {\n        for (i \x3d 0; i \x3c geom.geometries.length; i++) {\n            convertFeature(features, {\n                geometry: geom.geometries[i],\n                properties: tags\n            }, tolerance);\n        }\n\n    } else {\n        throw new Error('Input data is not a valid GeoJSON object.');\n    }\n}\n\nfunction create(tags, type, geometry) {\n    var feature \x3d {\n        geometry: geometry,\n        type: type,\n        tags: tags || null,\n        min: [2, 1], // initial bbox values;\n        max: [-1, 0]  // note that coords are usually in [0..1] range\n    };\n    calcBBox(feature);\n    return feature;\n}\n\nfunction project(lonlats, tolerance) {\n    var projected \x3d [];\n    for (var i \x3d 0; i \x3c lonlats.length; i++) {\n        projected.push(projectPoint(lonlats[i]));\n    }\n    if (tolerance) {\n        simplify(projected, tolerance);\n        calcSize(projected);\n    }\n    return projected;\n}\n\nfunction projectPoint(p) {\n    var sin \x3d Math.sin(p[1] * Math.PI / 180),\n        x \x3d (p[0] / 360 + 0.5),\n        y \x3d (0.5 - 0.25 * Math.log((1 + sin) / (1 - sin)) / Math.PI);\n\n    y \x3d y \x3c 0 ? 0 :\n        y \x3e 1 ? 1 : y;\n\n    return [x, y, 0];\n}\n\n// calculate area and length of the poly\nfunction calcSize(points) {\n    var area \x3d 0,\n        dist \x3d 0;\n\n    for (var i \x3d 0, a, b; i \x3c points.length - 1; i++) {\n        a \x3d b || points[i];\n        b \x3d points[i + 1];\n\n        area +\x3d a[0] * b[1] - b[0] * a[1];\n\n        // use Manhattan distance instead of Euclidian one to avoid expensive square root computation\n        dist +\x3d Math.abs(b[0] - a[0]) + Math.abs(b[1] - a[1]);\n    }\n    points.area \x3d Math.abs(area / 2);\n    points.dist \x3d dist;\n}\n\n// calculate the feature bounding box for faster clipping later\nfunction calcBBox(feature) {\n    var geometry \x3d feature.geometry,\n        min \x3d feature.min,\n        max \x3d feature.max;\n\n    if (feature.type \x3d\x3d\x3d 1) { calcRingBBox(min, max, geometry); }\n    else { for (var i \x3d 0; i \x3c geometry.length; i++) { calcRingBBox(min, max, geometry[i]); } }\n\n    return feature;\n}\n\nfunction calcRingBBox(min, max, points) {\n    for (var i \x3d 0, p; i \x3c points.length; i++) {\n        p \x3d points[i];\n        min[0] \x3d Math.min(p[0], min[0]);\n        max[0] \x3d Math.max(p[0], max[0]);\n        min[1] \x3d Math.min(p[1], min[1]);\n        max[1] \x3d Math.max(p[1], max[1]);\n    }\n}\n\nvar tile \x3d transformTile;\nvar point \x3d transformPoint;\n\n// Transforms the coordinates of each feature in the given tile from\n// mercator-projected space into (extent x extent) tile space.\nfunction transformTile(tile, extent) {\n    if (tile.transformed) { return tile; }\n\n    var z2 \x3d tile.z2,\n        tx \x3d tile.x,\n        ty \x3d tile.y,\n        i, j, k;\n\n    for (i \x3d 0; i \x3c tile.features.length; i++) {\n        var feature \x3d tile.features[i],\n            geom \x3d feature.geometry,\n            type \x3d feature.type;\n\n        if (type \x3d\x3d\x3d 1) {\n            for (j \x3d 0; j \x3c geom.length; j++) { geom[j] \x3d transformPoint(geom[j], extent, z2, tx, ty); }\n\n        } else {\n            for (j \x3d 0; j \x3c geom.length; j++) {\n                var ring \x3d geom[j];\n                for (k \x3d 0; k \x3c ring.length; k++) { ring[k] \x3d transformPoint(ring[k], extent, z2, tx, ty); }\n            }\n        }\n    }\n\n    tile.transformed \x3d true;\n\n    return tile;\n}\n\nfunction transformPoint(p, extent, z2, tx, ty) {\n    var x \x3d Math.round(extent * (p[0] * z2 - tx)),\n        y \x3d Math.round(extent * (p[1] * z2 - ty));\n    return [x, y];\n}\n\nvar transform$1 \x3d {\n\ttile: tile,\n\tpoint: point\n};\n\nvar clip_1 \x3d clip$1;\n\n/* clip features between two axis-parallel lines:\n *     |        |\n *  ___|___     |     /\n * /   |   ____|____/\n *     |        |\n */\n\nfunction clip$1(features, scale, k1, k2, axis, intersect, minAll, maxAll) {\n\n    k1 /\x3d scale;\n    k2 /\x3d scale;\n\n    if (minAll \x3e\x3d k1 \x26\x26 maxAll \x3c\x3d k2) { return features; } // trivial accept\n    else if (minAll \x3e k2 || maxAll \x3c k1) { return null; } // trivial reject\n\n    var clipped \x3d [];\n\n    for (var i \x3d 0; i \x3c features.length; i++) {\n\n        var feature \x3d features[i],\n            geometry \x3d feature.geometry,\n            type \x3d feature.type,\n            min, max;\n\n        min \x3d feature.min[axis];\n        max \x3d feature.max[axis];\n\n        if (min \x3e\x3d k1 \x26\x26 max \x3c\x3d k2) { // trivial accept\n            clipped.push(feature);\n            continue;\n        } else if (min \x3e k2 || max \x3c k1) { continue; } // trivial reject\n\n        var slices \x3d type \x3d\x3d\x3d 1 ?\n                clipPoints(geometry, k1, k2, axis) :\n                clipGeometry(geometry, k1, k2, axis, intersect, type \x3d\x3d\x3d 3);\n\n        if (slices.length) {\n            // if a feature got clipped, it will likely get clipped on the next zoom level as well,\n            // so there's no need to recalculate bboxes\n            clipped.push({\n                geometry: slices,\n                type: type,\n                tags: features[i].tags || null,\n                min: feature.min,\n                max: feature.max\n            });\n        }\n    }\n\n    return clipped.length ? clipped : null;\n}\n\nfunction clipPoints(geometry, k1, k2, axis) {\n    var slice \x3d [];\n\n    for (var i \x3d 0; i \x3c geometry.length; i++) {\n        var a \x3d geometry[i],\n            ak \x3d a[axis];\n\n        if (ak \x3e\x3d k1 \x26\x26 ak \x3c\x3d k2) { slice.push(a); }\n    }\n    return slice;\n}\n\nfunction clipGeometry(geometry, k1, k2, axis, intersect, closed) {\n\n    var slices \x3d [];\n\n    for (var i \x3d 0; i \x3c geometry.length; i++) {\n\n        var ak \x3d 0,\n            bk \x3d 0,\n            b \x3d null,\n            points \x3d geometry[i],\n            area \x3d points.area,\n            dist \x3d points.dist,\n            outer \x3d points.outer,\n            len \x3d points.length,\n            a, j, last;\n\n        var slice \x3d [];\n\n        for (j \x3d 0; j \x3c len - 1; j++) {\n            a \x3d b || points[j];\n            b \x3d points[j + 1];\n            ak \x3d bk || a[axis];\n            bk \x3d b[axis];\n\n            if (ak \x3c k1) {\n\n                if ((bk \x3e k2)) { // ---|-----|--\x3e\n                    slice.push(intersect(a, b, k1), intersect(a, b, k2));\n                    if (!closed) { slice \x3d newSlice(slices, slice, area, dist, outer); }\n\n                } else if (bk \x3e\x3d k1) { slice.push(intersect(a, b, k1)); } // ---|--\x3e  |\n\n            } else if (ak \x3e k2) {\n\n                if ((bk \x3c k1)) { // \x3c--|-----|---\n                    slice.push(intersect(a, b, k2), intersect(a, b, k1));\n                    if (!closed) { slice \x3d newSlice(slices, slice, area, dist, outer); }\n\n                } else if (bk \x3c\x3d k2) { slice.push(intersect(a, b, k2)); } // |  \x3c--|---\n\n            } else {\n\n                slice.push(a);\n\n                if (bk \x3c k1) { // \x3c--|---  |\n                    slice.push(intersect(a, b, k1));\n                    if (!closed) { slice \x3d newSlice(slices, slice, area, dist, outer); }\n\n                } else if (bk \x3e k2) { // |  ---|--\x3e\n                    slice.push(intersect(a, b, k2));\n                    if (!closed) { slice \x3d newSlice(slices, slice, area, dist, outer); }\n                }\n                // | --\x3e |\n            }\n        }\n\n        // add the last point\n        a \x3d points[len - 1];\n        ak \x3d a[axis];\n        if (ak \x3e\x3d k1 \x26\x26 ak \x3c\x3d k2) { slice.push(a); }\n\n        // close the polygon if its endpoints are not the same after clipping\n\n        last \x3d slice[slice.length - 1];\n        if (closed \x26\x26 last \x26\x26 (slice[0][0] !\x3d\x3d last[0] || slice[0][1] !\x3d\x3d last[1])) { slice.push(slice[0]); }\n\n        // add the final slice\n        newSlice(slices, slice, area, dist, outer);\n    }\n\n    return slices;\n}\n\nfunction newSlice(slices, slice, area, dist, outer) {\n    if (slice.length) {\n        // we don't recalculate the area/length of the unclipped geometry because the case where it goes\n        // below the visibility threshold as a result of clipping is rare, so we avoid doing unnecessary work\n        slice.area \x3d area;\n        slice.dist \x3d dist;\n        if (outer !\x3d\x3d undefined) { slice.outer \x3d outer; }\n\n        slices.push(slice);\n    }\n    return [];\n}\n\nvar clip$2 \x3d clip_1;\n\nvar wrap_1 \x3d wrap$1;\n\nfunction wrap$1(features, buffer, intersectX) {\n    var merged \x3d features,\n        left  \x3d clip$2(features, 1, -1 - buffer, buffer,     0, intersectX, -1, 2), // left world copy\n        right \x3d clip$2(features, 1,  1 - buffer, 2 + buffer, 0, intersectX, -1, 2); // right world copy\n\n    if (left || right) {\n        merged \x3d clip$2(features, 1, -buffer, 1 + buffer, 0, intersectX, -1, 2); // center world copy\n\n        if (left) { merged \x3d shiftFeatureCoords(left, 1).concat(merged); } // merge left into center\n        if (right) { merged \x3d merged.concat(shiftFeatureCoords(right, -1)); } // merge right into center\n    }\n\n    return merged;\n}\n\nfunction shiftFeatureCoords(features, offset) {\n    var newFeatures \x3d [];\n\n    for (var i \x3d 0; i \x3c features.length; i++) {\n        var feature \x3d features[i],\n            type \x3d feature.type;\n\n        var newGeometry;\n\n        if (type \x3d\x3d\x3d 1) {\n            newGeometry \x3d shiftCoords(feature.geometry, offset);\n        } else {\n            newGeometry \x3d [];\n            for (var j \x3d 0; j \x3c feature.geometry.length; j++) {\n                newGeometry.push(shiftCoords(feature.geometry[j], offset));\n            }\n        }\n\n        newFeatures.push({\n            geometry: newGeometry,\n            type: type,\n            tags: feature.tags,\n            min: [feature.min[0] + offset, feature.min[1]],\n            max: [feature.max[0] + offset, feature.max[1]]\n        });\n    }\n\n    return newFeatures;\n}\n\nfunction shiftCoords(points, offset) {\n    var newPoints \x3d [];\n    newPoints.area \x3d points.area;\n    newPoints.dist \x3d points.dist;\n\n    for (var i \x3d 0; i \x3c points.length; i++) {\n        newPoints.push([points[i][0] + offset, points[i][1], points[i][2]]);\n    }\n    return newPoints;\n}\n\nvar tile$1 \x3d createTile$1;\n\nfunction createTile$1(features, z2, tx, ty, tolerance, noSimplify) {\n    var tile \x3d {\n        features: [],\n        numPoints: 0,\n        numSimplified: 0,\n        numFeatures: 0,\n        source: null,\n        x: tx,\n        y: ty,\n        z2: z2,\n        transformed: false,\n        min: [2, 1],\n        max: [-1, 0]\n    };\n    for (var i \x3d 0; i \x3c features.length; i++) {\n        tile.numFeatures++;\n        addFeature(tile, features[i], tolerance, noSimplify);\n\n        var min \x3d features[i].min,\n            max \x3d features[i].max;\n\n        if (min[0] \x3c tile.min[0]) { tile.min[0] \x3d min[0]; }\n        if (min[1] \x3c tile.min[1]) { tile.min[1] \x3d min[1]; }\n        if (max[0] \x3e tile.max[0]) { tile.max[0] \x3d max[0]; }\n        if (max[1] \x3e tile.max[1]) { tile.max[1] \x3d max[1]; }\n    }\n    return tile;\n}\n\nfunction addFeature(tile, feature, tolerance, noSimplify) {\n\n    var geom \x3d feature.geometry,\n        type \x3d feature.type,\n        simplified \x3d [],\n        sqTolerance \x3d tolerance * tolerance,\n        i, j, ring, p;\n\n    if (type \x3d\x3d\x3d 1) {\n        for (i \x3d 0; i \x3c geom.length; i++) {\n            simplified.push(geom[i]);\n            tile.numPoints++;\n            tile.numSimplified++;\n        }\n\n    } else {\n\n        // simplify and transform projected coordinates for tile geometry\n        for (i \x3d 0; i \x3c geom.length; i++) {\n            ring \x3d geom[i];\n\n            // filter out tiny polylines \x26 polygons\n            if (!noSimplify \x26\x26 ((type \x3d\x3d\x3d 2 \x26\x26 ring.dist \x3c tolerance) ||\n                                (type \x3d\x3d\x3d 3 \x26\x26 ring.area \x3c sqTolerance))) {\n                tile.numPoints +\x3d ring.length;\n                continue;\n            }\n\n            var simplifiedRing \x3d [];\n\n            for (j \x3d 0; j \x3c ring.length; j++) {\n                p \x3d ring[j];\n                // keep points with importance \x3e tolerance\n                if (noSimplify || p[2] \x3e sqTolerance) {\n                    simplifiedRing.push(p);\n                    tile.numSimplified++;\n                }\n                tile.numPoints++;\n            }\n\n            if (type \x3d\x3d\x3d 3) { rewind(simplifiedRing, ring.outer); }\n\n            simplified.push(simplifiedRing);\n        }\n    }\n\n    if (simplified.length) {\n        tile.features.push({\n            geometry: simplified,\n            type: type,\n            tags: feature.tags || null\n        });\n    }\n}\n\nfunction rewind(ring, clockwise) {\n    var area \x3d signedArea(ring);\n    if (area \x3c 0 \x3d\x3d\x3d clockwise) { ring.reverse(); }\n}\n\nfunction signedArea(ring) {\n    var sum \x3d 0;\n    for (var i \x3d 0, len \x3d ring.length, j \x3d len - 1, p1, p2; i \x3c len; j \x3d i++) {\n        p1 \x3d ring[i];\n        p2 \x3d ring[j];\n        sum +\x3d (p2[0] - p1[0]) * (p1[1] + p2[1]);\n    }\n    return sum;\n}\n\nvar index \x3d geojsonvt;\n\nvar convert \x3d convert_1;\nvar transform \x3d transform$1;\nvar clip \x3d clip_1;\nvar wrap \x3d wrap_1;\nvar createTile \x3d tile$1;     // final simplified tile generation\n\n\nfunction geojsonvt(data, options) {\n    return new GeoJSONVT(data, options);\n}\n\nfunction GeoJSONVT(data, options) {\n    options \x3d this.options \x3d extend(Object.create(this.options), options);\n\n    var debug \x3d options.debug;\n\n    if (debug) { console.time('preprocess data'); }\n\n    var z2 \x3d 1 \x3c\x3c options.maxZoom, // 2^z\n        features \x3d convert(data, options.tolerance / (z2 * options.extent));\n\n    this.tiles \x3d {};\n    this.tileCoords \x3d [];\n\n    if (debug) {\n        console.timeEnd('preprocess data');\n        console.log('index: maxZoom: %d, maxPoints: %d', options.indexMaxZoom, options.indexMaxPoints);\n        console.time('generate tiles');\n        this.stats \x3d {};\n        this.total \x3d 0;\n    }\n\n    features \x3d wrap(features, options.buffer / options.extent, intersectX);\n\n    // start slicing from the top tile down\n    if (features.length) { this.splitTile(features, 0, 0, 0); }\n\n    if (debug) {\n        if (features.length) { console.log('features: %d, points: %d', this.tiles[0].numFeatures, this.tiles[0].numPoints); }\n        console.timeEnd('generate tiles');\n        console.log('tiles generated:', this.total, JSON.stringify(this.stats));\n    }\n}\n\nGeoJSONVT.prototype.options \x3d {\n    maxZoom: 14,            // max zoom to preserve detail on\n    indexMaxZoom: 5,        // max zoom in the tile index\n    indexMaxPoints: 100000, // max number of points per tile in the tile index\n    solidChildren: false,   // whether to tile solid square tiles further\n    tolerance: 3,           // simplification tolerance (higher means simpler)\n    extent: 4096,           // tile extent\n    buffer: 64,             // tile buffer on each side\n    debug: 0                // logging level (0, 1 or 2)\n};\n\nGeoJSONVT.prototype.splitTile \x3d function (features, z, x, y, cz, cx, cy) {\n    var this$1 \x3d this;\n\n\n    var stack \x3d [features, z, x, y],\n        options \x3d this.options,\n        debug \x3d options.debug,\n        solid \x3d null;\n\n    // avoid recursion by using a processing queue\n    while (stack.length) {\n        y \x3d stack.pop();\n        x \x3d stack.pop();\n        z \x3d stack.pop();\n        features \x3d stack.pop();\n\n        var z2 \x3d 1 \x3c\x3c z,\n            id \x3d toID(z, x, y),\n            tile \x3d this$1.tiles[id],\n            tileTolerance \x3d z \x3d\x3d\x3d options.maxZoom ? 0 : options.tolerance / (z2 * options.extent);\n\n        if (!tile) {\n            if (debug \x3e 1) { console.time('creation'); }\n\n            tile \x3d this$1.tiles[id] \x3d createTile(features, z2, x, y, tileTolerance, z \x3d\x3d\x3d options.maxZoom);\n            this$1.tileCoords.push({z: z, x: x, y: y});\n\n            if (debug) {\n                if (debug \x3e 1) {\n                    console.log('tile z%d-%d-%d (features: %d, points: %d, simplified: %d)',\n                        z, x, y, tile.numFeatures, tile.numPoints, tile.numSimplified);\n                    console.timeEnd('creation');\n                }\n                var key \x3d 'z' + z;\n                this$1.stats[key] \x3d (this$1.stats[key] || 0) + 1;\n                this$1.total++;\n            }\n        }\n\n        // save reference to original geometry in tile so that we can drill down later if we stop now\n        tile.source \x3d features;\n\n        // if it's the first-pass tiling\n        if (!cz) {\n            // stop tiling if we reached max zoom, or if the tile is too simple\n            if (z \x3d\x3d\x3d options.indexMaxZoom || tile.numPoints \x3c\x3d options.indexMaxPoints) { continue; }\n\n        // if a drilldown to a specific tile\n        } else {\n            // stop tiling if we reached base zoom or our target tile zoom\n            if (z \x3d\x3d\x3d options.maxZoom || z \x3d\x3d\x3d cz) { continue; }\n\n            // stop tiling if it's not an ancestor of the target tile\n            var m \x3d 1 \x3c\x3c (cz - z);\n            if (x !\x3d\x3d Math.floor(cx / m) || y !\x3d\x3d Math.floor(cy / m)) { continue; }\n        }\n\n        // stop tiling if the tile is solid clipped square\n        if (!options.solidChildren \x26\x26 isClippedSquare(tile, options.extent, options.buffer)) {\n            if (cz) { solid \x3d z; } // and remember the zoom if we're drilling down\n            continue;\n        }\n\n        // if we slice further down, no need to keep source geometry\n        tile.source \x3d null;\n\n        if (debug \x3e 1) { console.time('clipping'); }\n\n        // values we'll use for clipping\n        var k1 \x3d 0.5 * options.buffer / options.extent,\n            k2 \x3d 0.5 - k1,\n            k3 \x3d 0.5 + k1,\n            k4 \x3d 1 + k1,\n            tl, bl, tr, br, left, right;\n\n        tl \x3d bl \x3d tr \x3d br \x3d null;\n\n        left  \x3d clip(features, z2, x - k1, x + k3, 0, intersectX, tile.min[0], tile.max[0]);\n        right \x3d clip(features, z2, x + k2, x + k4, 0, intersectX, tile.min[0], tile.max[0]);\n\n        if (left) {\n            tl \x3d clip(left, z2, y - k1, y + k3, 1, intersectY, tile.min[1], tile.max[1]);\n            bl \x3d clip(left, z2, y + k2, y + k4, 1, intersectY, tile.min[1], tile.max[1]);\n        }\n\n        if (right) {\n            tr \x3d clip(right, z2, y - k1, y + k3, 1, intersectY, tile.min[1], tile.max[1]);\n            br \x3d clip(right, z2, y + k2, y + k4, 1, intersectY, tile.min[1], tile.max[1]);\n        }\n\n        if (debug \x3e 1) { console.timeEnd('clipping'); }\n\n        if (tl) { stack.push(tl, z + 1, x * 2,     y * 2); }\n        if (bl) { stack.push(bl, z + 1, x * 2,     y * 2 + 1); }\n        if (tr) { stack.push(tr, z + 1, x * 2 + 1, y * 2); }\n        if (br) { stack.push(br, z + 1, x * 2 + 1, y * 2 + 1); }\n    }\n\n    return solid;\n};\n\nGeoJSONVT.prototype.getTile \x3d function (z, x, y) {\n    var this$1 \x3d this;\n\n    var options \x3d this.options,\n        extent \x3d options.extent,\n        debug \x3d options.debug;\n\n    var z2 \x3d 1 \x3c\x3c z;\n    x \x3d ((x % z2) + z2) % z2; // wrap tile x coordinate\n\n    var id \x3d toID(z, x, y);\n    if (this.tiles[id]) { return transform.tile(this.tiles[id], extent); }\n\n    if (debug \x3e 1) { console.log('drilling down to z%d-%d-%d', z, x, y); }\n\n    var z0 \x3d z,\n        x0 \x3d x,\n        y0 \x3d y,\n        parent;\n\n    while (!parent \x26\x26 z0 \x3e 0) {\n        z0--;\n        x0 \x3d Math.floor(x0 / 2);\n        y0 \x3d Math.floor(y0 / 2);\n        parent \x3d this$1.tiles[toID(z0, x0, y0)];\n    }\n\n    if (!parent || !parent.source) { return null; }\n\n    // if we found a parent tile containing the original geometry, we can drill down from it\n    if (debug \x3e 1) { console.log('found parent tile z%d-%d-%d', z0, x0, y0); }\n\n    // it parent tile is a solid clipped square, return it instead since it's identical\n    if (isClippedSquare(parent, extent, options.buffer)) { return transform.tile(parent, extent); }\n\n    if (debug \x3e 1) { console.time('drilling down'); }\n    var solid \x3d this.splitTile(parent.source, z0, x0, y0, z, x, y);\n    if (debug \x3e 1) { console.timeEnd('drilling down'); }\n\n    // one of the parent tiles was a solid clipped square\n    if (solid !\x3d\x3d null) {\n        var m \x3d 1 \x3c\x3c (z - solid);\n        id \x3d toID(solid, Math.floor(x / m), Math.floor(y / m));\n    }\n\n    return this.tiles[id] ? transform.tile(this.tiles[id], extent) : null;\n};\n\nfunction toID(z, x, y) {\n    return (((1 \x3c\x3c z) * y + x) * 32) + z;\n}\n\nfunction intersectX(a, b, x) {\n    return [x, (x - a[0]) * (b[1] - a[1]) / (b[0] - a[0]) + a[1], 1];\n}\nfunction intersectY(a, b, y) {\n    return [(y - a[1]) * (b[0] - a[0]) / (b[1] - a[1]) + a[0], y, 1];\n}\n\nfunction extend(dest, src) {\n    for (var i in src) { dest[i] \x3d src[i]; }\n    return dest;\n}\n\n// checks whether a tile is a whole-area fill after clipping; if it is, there's no sense slicing it further\nfunction isClippedSquare(tile, extent, buffer) {\n\n    var features \x3d tile.source;\n    if (features.length !\x3d\x3d 1) { return false; }\n\n    var feature \x3d features[0];\n    if (feature.type !\x3d\x3d 3 || feature.geometry.length \x3e 1) { return false; }\n\n    var len \x3d feature.geometry[0].length;\n    if (len !\x3d\x3d 5) { return false; }\n\n    for (var i \x3d 0; i \x3c len; i++) {\n        var p \x3d transform.point(feature.geometry[0][i], extent, tile.z2, tile.x, tile.y);\n        if ((p[0] !\x3d\x3d -buffer \x26\x26 p[0] !\x3d\x3d extent + buffer) ||\n            (p[1] !\x3d\x3d -buffer \x26\x26 p[1] !\x3d\x3d extent + buffer)) { return false; }\n    }\n\n    return true;\n}\n\nvar identity \x3d function(x) {\n  return x;\n};\n\nvar transform$3 \x3d function(topology) {\n  if ((transform \x3d topology.transform) \x3d\x3d null) { return identity; }\n  var transform,\n      x0,\n      y0,\n      kx \x3d transform.scale[0],\n      ky \x3d transform.scale[1],\n      dx \x3d transform.translate[0],\n      dy \x3d transform.translate[1];\n  return function(point, i) {\n    if (!i) { x0 \x3d y0 \x3d 0; }\n    point[0] \x3d (x0 +\x3d point[0]) * kx + dx;\n    point[1] \x3d (y0 +\x3d point[1]) * ky + dy;\n    return point;\n  };\n};\n\nvar bbox \x3d function(topology) {\n  var bbox \x3d topology.bbox;\n\n  function bboxPoint(p0) {\n    p1[0] \x3d p0[0], p1[1] \x3d p0[1], t(p1);\n    if (p1[0] \x3c x0) { x0 \x3d p1[0]; }\n    if (p1[0] \x3e x1) { x1 \x3d p1[0]; }\n    if (p1[1] \x3c y0) { y0 \x3d p1[1]; }\n    if (p1[1] \x3e y1) { y1 \x3d p1[1]; }\n  }\n\n  function bboxGeometry(o) {\n    switch (o.type) {\n      case \"GeometryCollection\": o.geometries.forEach(bboxGeometry); break;\n      case \"Point\": bboxPoint(o.coordinates); break;\n      case \"MultiPoint\": o.coordinates.forEach(bboxPoint); break;\n    }\n  }\n\n  if (!bbox) {\n    var t \x3d transform$3(topology), p0, p1 \x3d new Array(2), name,\n        x0 \x3d Infinity, y0 \x3d x0, x1 \x3d -x0, y1 \x3d -x0;\n\n    topology.arcs.forEach(function(arc) {\n      var i \x3d -1, n \x3d arc.length;\n      while (++i \x3c n) {\n        p0 \x3d arc[i], p1[0] \x3d p0[0], p1[1] \x3d p0[1], t(p1, i);\n        if (p1[0] \x3c x0) { x0 \x3d p1[0]; }\n        if (p1[0] \x3e x1) { x1 \x3d p1[0]; }\n        if (p1[1] \x3c y0) { y0 \x3d p1[1]; }\n        if (p1[1] \x3e y1) { y1 \x3d p1[1]; }\n      }\n    });\n\n    for (name in topology.objects) {\n      bboxGeometry(topology.objects[name]);\n    }\n\n    bbox \x3d topology.bbox \x3d [x0, y0, x1, y1];\n  }\n\n  return bbox;\n};\n\nvar reverse \x3d function(array, n) {\n  var t, j \x3d array.length, i \x3d j - n;\n  while (i \x3c --j) { t \x3d array[i], array[i++] \x3d array[j], array[j] \x3d t; }\n};\n\nvar feature \x3d function(topology, o) {\n  return o.type \x3d\x3d\x3d \"GeometryCollection\"\n      ? {type: \"FeatureCollection\", features: o.geometries.map(function(o) { return feature$1(topology, o); })}\n      : feature$1(topology, o);\n};\n\nfunction feature$1(topology, o) {\n  var id \x3d o.id,\n      bbox \x3d o.bbox,\n      properties \x3d o.properties \x3d\x3d null ? {} : o.properties,\n      geometry \x3d object(topology, o);\n  return id \x3d\x3d null \x26\x26 bbox \x3d\x3d null ? {type: \"Feature\", properties: properties, geometry: geometry}\n      : bbox \x3d\x3d null ? {type: \"Feature\", id: id, properties: properties, geometry: geometry}\n      : {type: \"Feature\", id: id, bbox: bbox, properties: properties, geometry: geometry};\n}\n\nfunction object(topology, o) {\n  var transformPoint \x3d transform$3(topology),\n      arcs \x3d topology.arcs;\n\n  function arc(i, points) {\n    if (points.length) { points.pop(); }\n    for (var a \x3d arcs[i \x3c 0 ? ~i : i], k \x3d 0, n \x3d a.length; k \x3c n; ++k) {\n      points.push(transformPoint(a[k].slice(), k));\n    }\n    if (i \x3c 0) { reverse(points, n); }\n  }\n\n  function point(p) {\n    return transformPoint(p.slice());\n  }\n\n  function line(arcs) {\n    var points \x3d [];\n    for (var i \x3d 0, n \x3d arcs.length; i \x3c n; ++i) { arc(arcs[i], points); }\n    if (points.length \x3c 2) { points.push(points[0].slice()); }\n    return points;\n  }\n\n  function ring(arcs) {\n    var points \x3d line(arcs);\n    while (points.length \x3c 4) { points.push(points[0].slice()); }\n    return points;\n  }\n\n  function polygon(arcs) {\n    return arcs.map(ring);\n  }\n\n  function geometry(o) {\n    var type \x3d o.type, coordinates;\n    switch (type) {\n      case \"GeometryCollection\": return {type: type, geometries: o.geometries.map(geometry)};\n      case \"Point\": coordinates \x3d point(o.coordinates); break;\n      case \"MultiPoint\": coordinates \x3d o.coordinates.map(point); break;\n      case \"LineString\": coordinates \x3d line(o.arcs); break;\n      case \"MultiLineString\": coordinates \x3d o.arcs.map(line); break;\n      case \"Polygon\": coordinates \x3d polygon(o.arcs); break;\n      case \"MultiPolygon\": coordinates \x3d o.arcs.map(polygon); break;\n      default: return null;\n    }\n    return {type: type, coordinates: coordinates};\n  }\n\n  return geometry(o);\n}\n\nvar stitch \x3d function(topology, arcs) {\n  var stitchedArcs \x3d {},\n      fragmentByStart \x3d {},\n      fragmentByEnd \x3d {},\n      fragments \x3d [],\n      emptyIndex \x3d -1;\n\n  // Stitch empty arcs first, since they may be subsumed by other arcs.\n  arcs.forEach(function(i, j) {\n    var arc \x3d topology.arcs[i \x3c 0 ? ~i : i], t;\n    if (arc.length \x3c 3 \x26\x26 !arc[1][0] \x26\x26 !arc[1][1]) {\n      t \x3d arcs[++emptyIndex], arcs[emptyIndex] \x3d i, arcs[j] \x3d t;\n    }\n  });\n\n  arcs.forEach(function(i) {\n    var e \x3d ends(i),\n        start \x3d e[0],\n        end \x3d e[1],\n        f, g;\n\n    if (f \x3d fragmentByEnd[start]) {\n      delete fragmentByEnd[f.end];\n      f.push(i);\n      f.end \x3d end;\n      if (g \x3d fragmentByStart[end]) {\n        delete fragmentByStart[g.start];\n        var fg \x3d g \x3d\x3d\x3d f ? f : f.concat(g);\n        fragmentByStart[fg.start \x3d f.start] \x3d fragmentByEnd[fg.end \x3d g.end] \x3d fg;\n      } else {\n        fragmentByStart[f.start] \x3d fragmentByEnd[f.end] \x3d f;\n      }\n    } else if (f \x3d fragmentByStart[end]) {\n      delete fragmentByStart[f.start];\n      f.unshift(i);\n      f.start \x3d start;\n      if (g \x3d fragmentByEnd[start]) {\n        delete fragmentByEnd[g.end];\n        var gf \x3d g \x3d\x3d\x3d f ? f : g.concat(f);\n        fragmentByStart[gf.start \x3d g.start] \x3d fragmentByEnd[gf.end \x3d f.end] \x3d gf;\n      } else {\n        fragmentByStart[f.start] \x3d fragmentByEnd[f.end] \x3d f;\n      }\n    } else {\n      f \x3d [i];\n      fragmentByStart[f.start \x3d start] \x3d fragmentByEnd[f.end \x3d end] \x3d f;\n    }\n  });\n\n  function ends(i) {\n    var arc \x3d topology.arcs[i \x3c 0 ? ~i : i], p0 \x3d arc[0], p1;\n    if (topology.transform) { p1 \x3d [0, 0], arc.forEach(function(dp) { p1[0] +\x3d dp[0], p1[1] +\x3d dp[1]; }); }\n    else { p1 \x3d arc[arc.length - 1]; }\n    return i \x3c 0 ? [p1, p0] : [p0, p1];\n  }\n\n  function flush(fragmentByEnd, fragmentByStart) {\n    for (var k in fragmentByEnd) {\n      var f \x3d fragmentByEnd[k];\n      delete fragmentByStart[f.start];\n      delete f.start;\n      delete f.end;\n      f.forEach(function(i) { stitchedArcs[i \x3c 0 ? ~i : i] \x3d 1; });\n      fragments.push(f);\n    }\n  }\n\n  flush(fragmentByEnd, fragmentByStart);\n  flush(fragmentByStart, fragmentByEnd);\n  arcs.forEach(function(i) { if (!stitchedArcs[i \x3c 0 ? ~i : i]) { fragments.push([i]); } });\n\n  return fragments;\n};\n\nfunction extractArcs(topology, object$$1, filter) {\n  var arcs \x3d [],\n      geomsByArc \x3d [],\n      geom;\n\n  function extract0(i) {\n    var j \x3d i \x3c 0 ? ~i : i;\n    (geomsByArc[j] || (geomsByArc[j] \x3d [])).push({i: i, g: geom});\n  }\n\n  function extract1(arcs) {\n    arcs.forEach(extract0);\n  }\n\n  function extract2(arcs) {\n    arcs.forEach(extract1);\n  }\n\n  function extract3(arcs) {\n    arcs.forEach(extract2);\n  }\n\n  function geometry(o) {\n    switch (geom \x3d o, o.type) {\n      case \"GeometryCollection\": o.geometries.forEach(geometry); break;\n      case \"LineString\": extract1(o.arcs); break;\n      case \"MultiLineString\": case \"Polygon\": extract2(o.arcs); break;\n      case \"MultiPolygon\": extract3(o.arcs); break;\n    }\n  }\n\n  geometry(object$$1);\n\n  geomsByArc.forEach(filter \x3d\x3d null\n      ? function(geoms) { arcs.push(geoms[0].i); }\n      : function(geoms) { if (filter(geoms[0].g, geoms[geoms.length - 1].g)) { arcs.push(geoms[0].i); } });\n\n  return arcs;\n}\n\nfunction planarRingArea(ring) {\n  var i \x3d -1, n \x3d ring.length, a, b \x3d ring[n - 1], area \x3d 0;\n  while (++i \x3c n) { a \x3d b, b \x3d ring[i], area +\x3d a[0] * b[1] - a[1] * b[0]; }\n  return Math.abs(area); // Note: doubled area!\n}\n\nvar bisect \x3d function(a, x) {\n  var lo \x3d 0, hi \x3d a.length;\n  while (lo \x3c hi) {\n    var mid \x3d lo + hi \x3e\x3e\x3e 1;\n    if (a[mid] \x3c x) { lo \x3d mid + 1; }\n    else { hi \x3d mid; }\n  }\n  return lo;\n};\n\nvar slicers \x3d {};\nvar options;\n\nonmessage \x3d function (e) {\n\tif (e.data[0] \x3d\x3d\x3d 'slice') {\n\t\t// Given a blob of GeoJSON and some topojson/geojson-vt options, do the slicing.\n\t\tvar geojson \x3d e.data[1];\n\t\toptions     \x3d e.data[2];\n\n\t\tif (geojson.type \x26\x26 geojson.type \x3d\x3d\x3d 'Topology') {\n\t\t\tfor (var layerName in geojson.objects) {\n\t\t\t\tslicers[layerName] \x3d index(\n\t\t\t\t\tfeature(geojson, geojson.objects[layerName])\n\t\t\t\t, options);\n\t\t\t}\n\t\t} else {\n\t\t\tslicers[options.vectorTileLayerName] \x3d index(geojson, options);\n\t\t}\n\n\t} else if (e.data[0] \x3d\x3d\x3d 'get') {\n\t\t// Gets the vector tile for the given coordinates, sends it back as a message\n\t\tvar coords \x3d e.data[1];\n\n\t\tvar tileLayers \x3d {};\n\t\tfor (var layerName in slicers) {\n\t\t\tvar slicedTileLayer \x3d slicers[layerName].getTile(coords.z, coords.x, coords.y);\n\n\t\t\tif (slicedTileLayer) {\n\t\t\t\tvar vectorTileLayer \x3d {\n\t\t\t\t\tfeatures: [],\n\t\t\t\t\textent: options.extent,\n\t\t\t\t\tname: options.vectorTileLayerName,\n\t\t\t\t\tlength: slicedTileLayer.features.length\n\t\t\t\t};\n\n\t\t\t\tfor (var i in slicedTileLayer.features) {\n\t\t\t\t\tvar feat \x3d {\n\t\t\t\t\t\tgeometry: slicedTileLayer.features[i].geometry,\n\t\t\t\t\t\tproperties: slicedTileLayer.features[i].tags,\n\t\t\t\t\t\ttype: slicedTileLayer.features[i].type\t// 1 \x3d point, 2 \x3d line, 3 \x3d polygon\n\t\t\t\t\t};\n\t\t\t\t\tvectorTileLayer.features.push(feat);\n\t\t\t\t}\n\t\t\t\ttileLayers[layerName] \x3d vectorTileLayer;\n\t\t\t}\n\t\t}\n\t\tpostMessage({ layers: tileLayers, coords: coords });\n\t}\n};\n//# sourceMappingURL\x3dslicerWebWorker.js.worker.map\n","text/plain; charset\x3dus-ascii",!1);L.VectorGrid.Slicer=L.VectorGrid.extend({options:{vectorTileLayerName:"sliced",extent:4096,maxZoom:14},initialize:function(a,e){L.VectorGrid.prototype.initialize.call(this,e);e={};for(var k in this.options)"rendererFactory"!==k&&"vectorTileLayerStyles"!==k&&"function"!==typeof this.options[k]&&(e[k]=this.options[k]);this._worker=new Worker(workerCode);this._worker.postMessage(["slice",a,e])},_getVectorTilePromise:function(a){var e=this,k=new Promise(function(f){e._worker.addEventListener("message",function m(g){g.data.coords&&g.data.coords.x===a.x&&g.data.coords.y===a.y&&g.data.coords.z===a.z&&(f(g.data),e._worker.removeEventListener("message",m))})});this._worker.postMessage(["get",a]);return k}});L.vectorGrid.slicer=function(a,e){return new L.VectorGrid.Slicer(a,e)};L.Canvas.Tile=L.Canvas.extend({initialize:function(a,e,k){L.Canvas.prototype.initialize.call(this,k);this._tileCoord=a;this._size=e;this._initContainer();this._container.setAttribute("width",this._size.x);this._container.setAttribute("height",this._size.y);this._layers={};this._drawnLayers={};this._drawing=!0;k.interactive&&(this._container.style.pointerEvents="auto")},getCoord:function(){return this._tileCoord},getContainer:function(){return this._container},getOffset:function(){return this._tileCoord.scaleBy(this._size).subtract(this._map.getPixelOrigin())},onAdd:L.Util.falseFn,addTo:function(a){this._map=a},removeFrom:function(a){delete this._map},_onClick:function(a){var e=this._map.mouseEventToLayerPoint(a).subtract(this.getOffset()),k,f,h;for(h in this._layers)k=this._layers[h],k.options.interactive&&k._containsPoint(e)&&!this._map._draggableMoved(k)&&(f=k);f&&(L.DomEvent.fakeStop(a),this._fireEvent([f],a))},_onMouseMove:function(a){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(a).subtract(this.getOffset());this._handleMouseHover(a,e)}},_updateIcon:function(a){if(this._drawing){var e=a.options.icon.options,k=L.point(e.iconSize),e=e.iconAnchor||k&&k.divideBy(2,!0),f=a._point.subtract(e),h=this._ctx,m=a._getImage();if(m.complete)h.drawImage(m,f.x,f.y,k.x,k.y);else L.DomEvent.on(m,"load",function(){h.drawImage(m,f.x,f.y,k.x,k.y)});this._drawnLayers[a._leaflet_id]=a}}});L.canvas.tile=function(a,e,k){return new L.Canvas.Tile(a,e,k)};!function(){function a(e){return this instanceof a?(this._canvas=e="string"==typeof e?document.getElementById(e):e,this._ctx=e.getContext("2d"),this._width=e.width,this._height=e.height,this._max=1,void this.clear()):new a(e)}a.prototype={defaultRadius:25,defaultGradient:{"0.4":"blue","0.6":"cyan","0.7":"lime","0.8":"yellow",1:"red"},data:function(a,k){return this._data=a,this},max:function(a){return this._max=a,this},add:function(a){return this._data.push(a),this},clear:function(){return this._data=[],this},radius:function(a,k){k=k||15;var e=this._circle=document.createElement("canvas"),h=e.getContext("2d"),m=this._r=a+k;return e.width=e.height=2*m,h.shadowOffsetX=h.shadowOffsetY=200,h.shadowBlur=k,h.shadowColor="black",h.beginPath(),h.arc(m-200,m-200,a,0,2*Math.PI,!0),h.closePath(),h.fill(),this},gradient:function(a){var e=document.createElement("canvas"),f=e.getContext("2d"),h=f.createLinearGradient(0,0,0,256);e.width=1;e.height=256;for(var m in a)h.addColorStop(m,a[m]);return f.fillStyle=h,f.fillRect(0,0,1,256),this._grad=f.getImageData(0,0,1,256).data,this},draw:function(a){this._circle||this.radius(this.defaultRadius);this._grad||this.gradient(this.defaultGradient);var e=this._ctx;e.clearRect(0,0,this._width,this._height);for(var f,h=0,m=this._data.length;m>h;h++)f=this._data[h],e.globalAlpha=Math.max(f[2]/this._max,a||.05),e.drawImage(this._circle,f[0]-this._r,f[1]-this._r);a=e.getImageData(0,0,this._width,this._height);return this._colorize(a.data,this._grad),e.putImageData(a,0,0),this},_colorize:function(a,k){for(var e,h=3,m=a.length;m>h;h+=4)(e=4*a[h])&&(a[h-3]=k[e],a[h-2]=k[e+1],a[h-1]=k[e+2])}};window.simpleheat=a}();L.HeatLayer=(L.Layer?L.Layer:L.Class).extend({initialize:function(a,e){this._latlngs=a;L.setOptions(this,e);var k=e||{};this._minZoom=void 0!=k.minZoom?k.minZoom:0;this._maxZoom=void 0!=k.maxZoom?k.maxZoom:22;this._isShow=!0},setLatLngs:function(a){return this._latlngs=a,this.redraw()},addLatLng:function(a){return this._latlngs.push(a),this.redraw()},setOptions:function(a){return L.setOptions(this,a),this._heat&&this._updateOptions(),this.redraw()},redraw:function(){return!this._heat||this._frame||this._map._animating||(this._frame=L.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(a){this._map=a;this._canvas||this._initCanvas();this._isShow&&a._panes.overlayPane.appendChild(this._canvas);a.on("moveend",this._reset,this);a.options.zoomAnimation&&L.Browser.any3d&&a.on("zoomanim",this._animateZoom,this);this._reset()},onRemove:function(a){this._isShow&&a.getPanes().overlayPane.removeChild(this._canvas);a.off("moveend",this._reset,this);a.options.zoomAnimation&&a.off("zoomanim",this._animateZoom,this)},removeCanvas:function(a){a.getPanes().overlayPane.removeChild(this._canvas);this._isShow=!1},removeEvent:function(){t.on("moveend",this._reset,this);t.options.zoomAnimation&&L.Browser.any3d&&t.on("zoomanim",this._animateZoom,this);this._reset()},addEvent:function(){t.off("moveend",this._reset,this);t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addCanvas:function(a){this._map=a;this._canvas||this._initCanvas();a._panes.overlayPane.appendChild(this._canvas);this._reset();this._isShow=!0},getShowState:function(){return this._isShow},addTo:function(a){return a.addLayer(this),this},_initCanvas:function(){var a=this._canvas=L.DomUtil.create("canvas","leaflet-heatmap-layer leaflet-layer"),e=L.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","msTransformOrigin"]);a.style[e]="50% 50%";e=this._map.getSize();a.width=e.x;a.height=e.y;L.DomUtil.addClass(a,"leaflet-zoom-"+(this._map.options.zoomAnimation&&L.Browser.any3d?"animated":"hide"));this._heat=simpleheat(a);this._updateOptions()},_updateOptions:function(){this._heat.radius(this.options.radius||this._heat.defaultRadius,this.options.blur);this.options.gradient&&this._heat.gradient(this.options.gradient);this.options.max&&this._heat.max(this.options.max)},_reset:function(){var a=this._map.getZoom();a>=this._minZoom&&a<=this._maxZoom&&(a=this._map.containerPointToLayerPoint([0,0]),L.DomUtil.setPosition(this._canvas,a),a=this._map.getSize(),this._heat._width!==a.x&&(this._canvas.width=this._heat._width=a.x),this._heat._height!==a.y&&(this._canvas.height=this._heat._height=a.y),this._redraw())},_redraw:function(){var a,e,k,f,h,m,g,u,p=[],v=this._heat._r,x=this._map.getSize();g=new L.Bounds(L.point([-v,-v]),x.add([v,v]));x=void 0===this.options.max?1:this.options.max;a=void 0===this.options.maxZoom?this._map.getMaxZoom():this.options.maxZoom;var E=1/Math.pow(2,Math.max(0,Math.min(a-this._map.getZoom(),12))),z=v/2,v=[];a=this._map._getMapPanePos();var H=a.x%z,F=a.y%z;a=0;for(e=this._latlngs.length;e>a;a++)if(k=this._map.latLngToContainerPoint(this._latlngs[a]),g.contains(k))h=Math.floor((k.x-H)/z)+2,m=Math.floor((k.y-F)/z)+2,u=(void 0!==this._latlngs[a].alt?this._latlngs[a].alt:void 0!==this._latlngs[a][2]?+this._latlngs[a][2]:1)*E,v[m]=v[m]||[],(f=v[m][h])?(f[0]=(f[0]*f[2]+k.x*u)/(f[2]+u),f[1]=(f[1]*f[2]+k.y*u)/(f[2]+u),f[2]+=u):v[m][h]=[k.x,k.y,u];a=0;for(e=v.length;e>a;a++)if(v[a])for(k=0,g=v[a].length;g>k;k++)(f=v[a][k])&&p.push([Math.round(f[0]),Math.round(f[1]),Math.min(f[2],x)]);this._heat.data(p).draw(this.options.minOpacity);this._frame=null},_animateZoom:function(a){var e=this._map.getZoomScale(a.zoom);a=this._map._getCenterOffset(a.center)._multiplyBy(-e).subtract(this._map._getMapPanePos());L.DomUtil.setTransform?L.DomUtil.setTransform(this._canvas,a,e):this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(a)+" scale("+e+")"}});L.heatLayer=function(a,e){return new L.HeatLayer(a,e)};L.TileLayer.WMTS=L.TileLayer.extend({defaultWmtsParams:{service:"WMTS",request:"GetTile",version:"1.0.0",layers:"",styles:"",tilematrixSet:"",format:"image/jpeg"},initialize:function(a,e){this._url=a;var k=L.extend({},this.defaultWmtsParams),f=e.tileSize||this.options.tileSize;k.width=e.detectRetina&&L.Browser.retina?k.height=2*f:k.height=f;for(var h in e)this.options.hasOwnProperty(h)||"matrixIds"==h||(k[h]=e[h]);this.wmtsParams=k;this.matrixIds=e.matrixIds||this.getDefaultMatrix();L.setOptions(this,e)},onAdd:function(a){this._crs=this.options.crs||a.options.crs;L.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var e=this.options.tileSize,k=a.multiplyBy(e);k.x+=1;--k.y;var f=k.add(new L.Point(e,e)),e=this._tileZoom,h=this._crs.project(this._map.unproject(k,e)),m=this._crs.project(this._map.unproject(f,e)).x-h.x,k=this.matrixIds[e].identifier,f=Math.floor((h.x-this.matrixIds[e].topLeftCorner.lng)/m),e=-Math.floor((h.y-this.matrixIds[e].topLeftCorner.lat)/m);a=L.Util.template(this._url,{s:this._getSubdomain(a)});return a+L.Util.getParamString(this.wmtsParams,a)+"\x26tilematrix\x3d"+k+"\x26tilerow\x3d"+e+"\x26tilecol\x3d"+f},setParams:function(a,e){L.extend(this.wmtsParams,a);e||this.redraw();return this},getDefaultMatrix:function(){for(var a=Array(22),e=0;22>e;e++)a[e]={identifier:""+e,topLeftCorner:new L.LatLng(2.00375083428E7,-2.00375083428E7)};return a}});L.tileLayer.wmts=function(a,e){return new L.TileLayer.WMTS(a,e)};(function(a){function e(){var a=new Date,e=a.getFullYear(),f=a.getMonth()+1,h=a.getDate(),k=a.getHours(),x=a.getMinutes(),a=a.getSeconds();1<=f&&9>=f&&(f="0"+f);0<=h&&9>=h&&(h="0"+h);0<=k&&9>=k&&(k="0"+k);0<=x&&9>=x&&(x="0"+x);0<=a&&9>=a&&(a="0"+a);return e+"-"+f+"-"+h+" "+k+":"+x+":"+a}function k(a,f){var g=sessionStorage.getItem("currentUser");if(!g)return null;var h={},k=e(),g=JSON.parse(g);h.userId=g.userId;h.phoneNumber=g.phoneNumber;h.gisTimestamp=k;h.clickOrSuspend="clickFeatureLayer"==a?"0":"1";h.addressId=f.featureAttr.addressid;h.clickOrSuspendGisId=f.latlng?f.latlng.lat+","+f.latlng.lng:"";h.scale=f.resolution?JSON.stringify(f.resolution):f.zoom;return h}function f(a,f){var g=sessionStorage.getItem("currentUser");if(!g)return null;var h={},k=e(),g=JSON.parse(g);h.userId=g.userId;h.phoneNumber=g.phoneNumber;h.gisTimestamp=k;h.operationName=a;h.coordinate=f.latlng?f.latlng.lat+","+f.latlng.lng:"";h.scale=f.resolution?JSON.stringify(f.resolution):f.zoom;f.centerRectBounds?h.currentCenter=f.centerRectBounds.northEast.lat+","+f.centerRectBounds.northEast.lng+" "+f.centerRectBounds.southWest.lat+f.centerRectBounds.southWest.lng:f.centerRectBounds="";return h}function h(a,g){if(a&&g){var h={clickFeatureLayer:"1",zoomInMap:"2",zoomOutMap:"2",moveendMap:"2"}[a],m=null;"1"===h?m=k(a,g):"2"===h&&(m=f(a,g));if(m){var v=sessionStorage.getItem("currentOpenProductCode"),h={appId:v?v:"",type:h,createTime:e(),datas:[m]};console.log(h);$.ajax({type:"post",contentType:"application/json",async:!0,url:reqPrefix+"/api/product/etl/dataCollect",data:JSON.stringify(h),dataType:"json",success:function(){}})}}}a.Z={};(function(a){a.Zmap=L.Map.extend({initialize:function(a,e){this._eventFunction={};e.zoomControl=!1;e.attributionControl=!1;L.Map.prototype.initialize.call(this,a,e)},off:function(a,e){e&&L.Map.prototype.off.call(this,a,e)},getResolution:function(){var a=this.getBounds(),a=a._northEast.lat-a._southWest.lat,e=this.getSize().y;return 40008600*a/360/e},getBounds:function(){var a=L.Map.prototype.getBounds.call(this);a.northEast=a._northEast;a.southWest=a._southWest;return a},getRectangleBouds:function(a,e){var f=this.getCenter(),g=this.latLngToLayerPoint(f),f=[g.x+a/2,g.y-e/2],g=this.layerPointToLatLng([g.x-a/2,g.y+e/2]),f=this.layerPointToLatLng(f);return{southWest:g,northEast:f}},opentip:function(a,e){var f=new L.tooltip({direction:(e||{}).direction||"right"});this.mapTipLayer=(new L.circleMarker([0,0],{opacity:0,fillOpacity:0})).bindTooltip(f).addTo(this);this.mapTipLayer.openTooltip();this.mapTipLayer.setTooltipContent(a);var g=this;this.on("mousemove",function(a){null!=g.mapTipLayer&&g.mapTipLayer.setLatLng(a.latlng)})},closetip:function(){this.mapTipLayer.closeTooltip();this.mapTipLayer&&(this.mapTipLayer.remove(),this.mapTipLayer=null)},hasFeature:function(a){return this.hasLayer(a)},addFeature:function(a){a.addTo(this)},removeFeature:function(a){a.remove()},addEvent:function(a,e){var f=Object.keys(this._eventFunction).length,f="map_event_"+a+f;this.on(a,this._eventFunction[f]=function(a){e(a)});return f},removeEvent:function(a,e){if(e)this._eventFunction[e]&&this.off(a,this._eventFunction[e]);else for(var f in this._eventFunction)-1!=f.indexOf(a)&&this.off(a,this._eventFunction[f])},setListen:function(a){this._keepListen=a},setCenterRectangleSize:function(a){this._centerRectangleSize=a},getRectangleBouds:function(a,e){var f=this.getCenter(),g=this.latLngToLayerPoint(f),f=[g.x+a/2,g.y-e/2],g=this.layerPointToLatLng([g.x-a/2,g.y+e/2]),f=this.layerPointToLatLng(f);return{southWest:g,northEast:f}},addBaseLayerByUrl:function(e,f){var g=f||{},h=null;switch(e.toUpperCase()){case "TILELAYER":h=L.tileLayer(g.url,{noWrap:void 0==g.noWrap?!1:g.noWrap});break;case "WMSLAYER":h=L.tileLayer.wms(g.url,{layers:g.layerName,format:g.format||"image/png"});break;case "WMTSLAYER":for(var k=g.leftTopLatLng?g.leftTopLatLng:[90,-180],h=[],m=0;22>m;++m)h[m]={identifier:""+m,topLeftCorner:new L.LatLng(k[0],k[1])};k=g.tilematrixSet?g.tilematrixSet.replace(/[^0-9]/ig,""):"";k=L.CRS["EPSG"+k]||null;null!=k&&this.options.crs==k||console.log("\u56fe\u5c42\u672a\u8bbe\u7f6e\u5750\u6807\u7cfb\u6216\u4e0eMap\u5750\u6807\u7cfb\u4e0d\u540c\uff0c\u53ef\u80fd\u5bfc\u81f4\u56fe\u5c42\u65e0\u6cd5\u6b63\u5e38\u52a0\u8f7d,\u8bf7\u6b63\u786e\u914d\u7f6eMap\u53ca\u56fe\u5c42\u5750\u6807\u7cfb\uff01");h={layer:g.layerName||"",tilematrixSet:g.tilematrixSet||"EPSG:4326",format:g.format||"image/png",matrixIds:h,minZoom:void 0==g.minZoom?0:g.minZoom,maxZoom:void 0==g.maxZoom?22:g.maxZoom};k&&(h.crs=k);h=new L.TileLayer.WMTS(g.url,h);break;case "ESRIMAPLAYER":h=L.esri.dynamicMapLayer({url:g.url});break;case "ESRITILEMAPLAYER":h=L.esri.tiledMapLayer({url:g.url,continuousWorld:!1});break;case "ESRITILELAYER":h=new a.esriTileLayer(g.url,{minZoom:void 0==g.minZoom?0:g.minZoom,maxZoom:void 0==g.maxZoom?22:g.maxZoom});break;case "GAODETILELAYER":h=new L.tileLayer(g.url,{maxZoom:void 0==g.maxZoom?20:g.maxZoom,minZoom:void 0==g.minZoom?1:g.minZoom,subdomains:g.subdomains||["1","2","3","4"]});break;default:console.log("\u4e0d\u652f\u6301\u8be5\u56fe\u5c42\u7c7b\u578b\uff01")}null!=h&&this.addLayer(h);return h}});a.zmap=function(e,f){var g=new a.Zmap(e,f);f&&f.center||g.setView([41,120],2);g.setListen(!0);g.setCenterRectangleSize([300,200]);var k=g.getZoom(),m=g.getZoom(),u={};g.on("zoomend moveend",function(a){if(1==g._keepListen){var e={};"mousemove"==a.type?(u.mousemove&&clearTimeout(u.mousemove),u.mousemove=setTimeout(function(){var f=g.getBounds();e.bounds={northEast:f._northEast,southWest:f._southWest};a.latlng&&(e.latlng=a.latlng);f=g.getZoom();e.zoom=f;e.center=g.getCenter();e.resolution=g.getResolution();e.centerRectBounds=g.getRectangleBouds(g._centerRectangleSize[0],g._centerRectangleSize[1]);h(a.type+"Map",e)},1E3)):"moveend"==a.type?(u.moveend&&clearTimeout(u.moveend),u.moveend=setTimeout(function(){var f=g.getBounds();e.bounds={northEast:f._northEast,southWest:f._southWest};e.center=g.getCenter();e.resolution=g.getResolution();e.centerRectBounds=g.getRectangleBouds(g._centerRectangleSize[0],g._centerRectangleSize[1]);a.latlng&&(e.latlng=a.latlng);f=g.getZoom();e.zoom=f;m==f?h(a.type+"Map",e):m=f},1E3)):"zoomend"==a.type&&(u.zoomend&&clearTimeout(u.zoomend),u.zoomend=setTimeout(function(){var f=g.getBounds();e.bounds={northEast:f._northEast,southWest:f._southWest};e.center=g.getCenter();e.resolution=g.getResolution();e.centerRectBounds=g.getRectangleBouds(g._centerRectangleSize[0],g._centerRectangleSize[1]);a.latlng&&(e.latlng=a.latlng);f=g.getZoom();e.zoom=f;var m=a.type;if("zoomend"==a.type||"moveend"==a.type)f>k?m="zoomIn":f<k&&(m="zoomOut"),k=f;h(m+"Map",e)},1E3))}});return g};L.map=a.zmap;a.esriTileLayer=L.TileLayer.extend({getTileUrl:function(a){var e=a.x.toString(16),e="C"+"00000000".substring(0,8-e.length)+e,f=a.y.toString(16),f="R"+"00000000".substring(0,8-f.length)+f;return L.Util.template(this._url,L.extend({s:this._getSubdomain(a),z:1<a.z.toString().length?"L"+a.z:"L0"+a.z,x:e,y:f},this.options))}})})(Z);(function(a){a.VectorGridLayer=function(a,e){var f=e||{},g={};f.renderFactory=f.renderFactory?f.renderFactory:L.svg.tile;g[f.layerName]=e.vectorTileLayerStyles;f.vectorTileLayerStyles=g;return{layer:L.vectorGrid.protobuf(a,f)}};a.VectorGridLayer.prototype={};a.vectorGridLayer=function(e,f){return(new a.VectorGridLayer(e,f)).layer}})(Z);(function(a){a.FeatureLayer=L.FeatureGroup.extend({initialize:function(a){this._eventFunction={};L.FeatureGroup.prototype.initialize.call(this,a)},addFeature:function(a){this.addLayer(a)},addFeatures:function(a){if("[object Array]"==Object.prototype.toString.call(a))for(var e=0,f=a.length;e<f;e++)this.addLayer(a[e]);else this.addLayer(a)},removeFeature:function(a){this.layer.removeLayer(a)},clearFeature:function(){this.clearLayers()},addEvent:function(a,e){var f=Object.keys(this._eventFunction).length,f="layer_event_"+a+f;this.on(a,this._eventFunction[f]=function(a){e(a)});return f},removeEvent:function(a,e){if(e)this._eventFunction[e]&&this.off(a,this._eventFunction[e]);else for(var f in this._eventFunction)-1!=f.indexOf(a)&&this.off(a,this._eventFunction[f])},onAdd:function(a){this.clickLayerListen=this._sendListen.bind(this);this.on("click",this.clickLayerListen);this.on("mouseover",this.clickLayerListen);L.FeatureGroup.prototype.onAdd.call(this,a)},onRemove:function(a){this.clickLayerListen&&(this.off("click",this.clickLayerListen),this.off("mouseover",this.clickLayerListen));L.FeatureGroup.prototype.onRemove.call(this,a)},_sendListen:function(a){h(a.type+"FeatureLayer",{latlng:a.latlng,layerName:a.layer.layerName,featureAttr:a.layer.attributes||{}})}});a.featureLayer=function(e,f){var g=new a.FeatureLayer(e);g.layerType="featureLayer";g.layerName="";f&&(g.attributes=f.attributes,layerName=f.layerName||"");return g};L.featureLayer=Z.featureLayer})(Z);(function(a){function e(a,e){var f=Object.prototype.toString.call(a);if("[object Array]"==f)for(var g=0,f=a.length;g<f;g++){var h=a[g].properties,k;for(k in h)e[k]&&(h[e[k]]=h[k],delete h[k]);a[g].properties={}}else if("[object Object]"==f){k=a.properties;for(g in k)e[g]&&(k[e[g]]=k[g],delete k[g]);a.properties=k}return a}function f(a,e,f){a=a.split(",").reverse();a=[parseFloat(a[0]),parseFloat(a[1])];a=[2.003750834E7*a[0]/180,Math.log(Math.tan((90+a[1])*Math.PI/360))/(Math.PI/180)*2.003750834E7/180];var g=[],h="",k;f=void 0==f?30:f;for(var m=0;m<f;m++){var p=12*m,p=[(a[0]+e*Math.cos(3.14*p/180))/2.003750834E7*180,180/Math.PI*(2*Math.atan(Math.exp((a[1]+e*Math.sin(3.14*p/180))/2.003750834E7*180*Math.PI/180))-Math.PI/2)];g.push(p);h=h+(p[0]+","+p[1])+" ";0==m&&(k=p)}return h+k[0]+","+k[1]}a.wfsQuery=function(a,e,g,h){e=e||{};a=a+"service\x3dWFS\x26request\x3dGetFeature\x26version\x3d1.0.0\x26maxFeatures\x3d200\x26typeName\x3d"+e.layerName+"\x26outputFormat\x3djson\x26Filter\x3d";var k;k='\x3cFilter xmlns\x3d"http://www.opengis.net/ogc" xmlns:gml\x3d"http://www.opengis.net/gml"\x3e\x3cIntersects\x3e\x3cPropertyName\x3e'+e.field+"\x3c/PropertyName\x3e";k+="\x3cgml:polygon\x3e\x3cgml:outerBoundaryIs\x3e\x3cgml:LinearRing\x3e";"polygon"==e.geometry?k=k+"\x3cgml:coordinates\x3e"+e.coordString+"\x3c/gml:coordinates\x3e":"circle"==e.geometry&&(e=f(e.coordString,e.radius),k=k+"\x3cgml:coordinates\x3e"+e+"\x3c/gml:coordinates\x3e");$.ajax({type:"POST",contentType:"text/plain;charset\x3dUTF-8",async:!0,url:a+(k+"\x3c/gml:LinearRing\x3e\x3c/gml:outerBoundaryIs\x3e\x3c/gml:polygon\x3e\x3c/Intersects\x3e\x3c/Filter\x3e"),success:function(a){g(a)},error:function(a){h(a)}})};a.vectorTileClick=function(f,g,k,m){var p=null;a.wfsQuery(f,g,function(a){if(a.features&&0<a.features.length){$.ajax({type:"get",dataType:"json",async:!1,url:"./assets/utils/dataBaseTableConfig.json",success:function(a){p=a}});a=a.features[0];var f=a.properties,m=g.coordString.split(",");h("clickFeatureLayer",{latlng:{lat:m[0],lng:m[1]},layerName:g.layerName,featureAttr:f||{}});a=p?e(a,p.geo_gd_segment_pl):a;k(a)}else k(null)},function(a){m(a)})}})(Z);(function(a){a.addFeatureLayer=function(a,e,f,h,k){return new Z.AddFeatureLayer(a,e,f,h,k)};a.AddFeatureLayer=function(e,f,h,k,m){this._data=f;this._zmap=e;this._style=k||{};this._featureType=h.toLocaleLowerCase();this._eventKeys={};this._addFeatureLayerEvent={};this._tempColor=null;this._layerName=this._style.layerName||"";this._visible=0==this._style.visible?!1:!0;this._minZoom=void 0!=this._style.minZoom?this._style.minZoom:0;this._maxZoom=void 0!=this._style.maxZoom?this._style.maxZoom:22;this.layer=new Z.featureLayer;this.layer.attributes=m||{};this._visible&&this._zmap.addLayer(this.layer);this.setData(f);this._addMoveEvent();for(var g in this.layer)a.addFeatureLayer.prototype[g]=this.layer[g]};a.AddFeatureLayer.prototype={setVisible:function(a){this._visible=a;var e=this._zmap.hasLayer(this.layer),f=this._zmap.getZoom();a?e||(this._clearLayer(),this._zmap.addLayer(this.layer),this._addMoveEvent(),f>=this._minZoom&&f<=this._maxZoom&&this._addCurExtentFeatureToLayer()):e&&(this._clearLayer(),this._zmap.removeLayer(this.layer),this._removeMoveEvent())},getVisible:function(){return this._visible},setMinZoom:function(a){this._minZoom=a;this._visible&&(a=this._zmap.getZoom(),this._updateFeature(this,a))},getMinZoom:function(){return this._minZoom},setMaxZoom:function(a){this._maxZoom=a;this._visible&&(a=this._zmap.getZoom(),this._updateFeature(this,a))},getMaxZoom:function(){return this._maxZoom},setData:function(a){this._data=a;this._dataType=Object.prototype.toString.call(a);"[object Array]"==this._dataType?this._alldata=a:"[object String]"==this._dataType&&(this._alldata=this._getData(a)||[]);this.layer instanceof L.FeatureGroup&&this.refresh()},refresh:function(){"[object String]"==this._dataType&&(this._alldata=this._getData(this._data)||[]);this._updateFeature(this,this._zmap.getZoom())},removeFromMap:function(){this._zmap.hasLayer(this.layer)&&(this._clearLayer(),this._zmap.removeLayer(this.layer),this._removeMoveEvent())},addToMap:function(){this._zmap.hasLayer(this.layer)||(this._zmap.addLayer(this.layer),this._updateFeature(),this._addMoveEvent())},onAdd:function(a){this._map=a;console.log(a)},addEvent:function(a,e){var f=Object.keys(this._eventKeys).length,f="layer_event_"+a+f;this.layer.on(a,this._eventKeys[f]=function(a){e(a)});return f},removeEvent:function(a,e){if(e)this._eventKeys[e]&&this.layer.off(a,this._eventKeys[e]);else for(var f in this._eventKeys)-1!=f.indexOf(a)&&this.layer.off(a,this._eventKeys[f])},_getBounds:function(){var a=this._zmap.getBounds();return{maxLat:a._northEast.lat,minLat:a._southWest.lat,maxLng:a._northEast.lng,minLng:a._southWest.lng}},_addCurExtentFeatureToLayer:function(){var a=this._alldata;if(null==this._tempColor){for(var e="0123456789abcdef".split(""),f="#",h=0;6>h;h++)f+=e[Math.floor(16*Math.random())];this._tempColor=f}e=this._getBounds();f=0;for(h=a.length;f<h;f++){var k=this._isInCurExtent(a[f],e);k.layerName=this._layerName;k&&("marker"==this._featureType.toLowerCase()?(k=new Z.marker([k.lat,k.lng],this._style,k),this.layer.addFeature(k)):"circlemarker"==this._featureType.toLowerCase()?(k=new Z.circleMarker([k.lat,k.lng],this._style,k),this.layer.addFeature(k)):"polyline"==this._featureType.toLowerCase()?(k=new Z.polyline(k.linePaths,this._style,k),this.layer.addFeature(k)):"polygon"==this._featureType.toLowerCase()&&(k=new Z.polygon([k.linePaths],this._style,k),this.layer.addFeature(k)))}},_isInCurExtent:function(a,e){if("marker"==this._featureType.toLowerCase()||"circlemarker"==this._featureType.toLowerCase()){var f=a.centerLat||a.lat,g=a.centerLng||a.lng;return f&&g&&f>e.minLat&&f<e.maxLat&&g<e.maxLng&&g>e.minLng?(a.lat=f,a.lng=g,a):!1}if("polyline"==this._featureType.toLowerCase()||"polygon"==this._featureType.toLowerCase())return f=this._stringLatlngToArray(a.SHAPE||a.POINTS),0<f.length&&f[0][0]>e.minLat&&f[0][0]<e.maxLat&&f[0][1]<e.maxLng&&f[0][1]>e.minLng&&f[f.length-1][0]>e.minLat&&f[f.length-1][0]<e.maxLat&&f[f.length-1][1]<e.maxLng&&f[f.length-1][1]>e.minLng?(a.linePaths=f,a):!1},_clearLayer:function(){this.layer.clearFeature()},_addMoveEvent:function(){this._addFeatureLayerEvent=this._updateFeature.bind(this);this._eventKey=this._zmap.on("moveend",this._addFeatureLayerEvent)},_removeMoveEvent:function(){this._zmap.off("moveend",this._addFeatureLayerEvent)},_updateFeature:function(){var a=this._zmap.getZoom();if(this._visible){var e=this._zmap.hasLayer(this.layer);a>=this._minZoom&&a<=this._maxZoom?(this._clearLayer(),this._addCurExtentFeatureToLayer(),e||this._zmap.addLayer(this.layer)):e&&this._zmap.removeLayer(this.layer)}},_getData:function(a){var e;$.ajax({type:"get",async:!1,url:a,dataType:"json",success:function(a){e=a},error:function(a){console.log(a)}});return e},_stringLatlngToArray:function(a){a=a.replace("LINESTRING","");a=a.replace("POLYGON","");a=a.replace(/\(/g,"").replace(/\)/g,"");a=a.split(",");for(var e=[],f=0;f<a.length;f++){a[f]=a[f].replace(/(^\s*)|(\s*$)/g,"");a[f]=a[f].split(" ");var g=[parseFloat(a[f][1]),parseFloat(a[f][0])];e.push(g)}return e}}})(Z);(function(a){a.HeatLayer=L.HeatLayer.extend({initialize:function(a,e){null!=a&&void 0!=a?"object"==typeof a?(this._alldata=a,this._serviceUrl=""):"string"==typeof a?(this._serviceUrl=a,this._alldata=this._getDataFromService()):(this._alldata=[],this._serviceUrl=""):(this._alldata=[],this._serviceUrl="");this._options=e||{};var f={minOpacity:this._options.maxOpacity||1,maxZoom:this._options.maxZoom||22,minZoom:this._options.minZoom||0,max:this._options.max||1,radius:this._options.radius||25,blur:this._options.blur||15,gradient:this._options.gradient||{1:"rgba(255,0,0,1)","0.9":"rgba(255,255,0,1)","0.8":"rgba(0,255,0,1)","0.5":"rgba(0,255,255,1)",0:"rgba(0,0,255,1)"}};this._heatData=this._getHeatmapData();L.HeatLayer.prototype.initialize.call(this,this._heatData,f)},_getHeatmapData:function(){var a=this._alldata.length;if(0==a)return[[0,0,0]];for(var e=[],f=0;f<a;f++){var h=this._alldata[f].centerLat||this._alldata[f].lat,k=this._alldata[f].centerLng||this._alldata[f].lng;h&&k&&e.push([h,k,.5])}return e},_getDataFromService:function(a){var e;void 0!=a&&(this._serviceUrl=a);if(""==this._serviceUrl)return[];$.ajax({type:"get",async:!1,url:this._serviceUrl,dataType:"json",success:function(a){e=a},error:function(a){console.log(a)}});return e},onAdd:function(a){this._map=a;this._eventFunction=this._updateFeature.bind(this);this._map.on("moveend",this._eventFunction);this._zminZoom=void 0!=this._options.minZoom?this._options.minZoom:0;this._zmaxZoom=void 0!=this._options.maxZoom?this._options.maxZoom:this._map.getMaxZoom();this._resetEventFunction=this._reset.bind(this);this._animateZoomEventFunction=this._animateZoom.bind(this);t=a;this._canvas||this._initCanvas();this._isShow&&t._panes.overlayPane.appendChild(this._canvas);t.on("moveend",this._resetEventFunction);t.options.zoomAnimation&&L.Browser.any3d&&t.on("zoomanim",this._animateZoomEventFunction);this._reset()},onRemove:function(){this._map.off("moveend",this._eventFunction);this._isShow&&t.getPanes().overlayPane.removeChild(this._canvas);t.off("moveend",this._resetEventFunction);t.options.zoomAnimation&&t.off("zoomanim",this._animateZoomEventFunction);this._map=null},_updateFeature:function(){var a=this._map.getZoom(),e=this.getShowState();a>=this._zminZoom&&a<=this._zmaxZoom?e||this.addCanvas(this._map):e&&this.removeCanvas(this._map)},setOptions:function(a){L.HeatLayer.prototype.setOptions.call(this,a)},addData:function(a){var e=a.lat;a=a.lng;e&&a&&(e=[e,a,.5],this._heatData.push(e),L.HeatLayer.prototype.addLatLng.call(this,e))},setData:function(a){this._alldata=a;this._heatData=this._getHeatmapData();L.HeatLayer.prototype.setLatLngs.call(this,this._heatData)},refresh:function(a){this._alldata=this._getDataFromService(a);this._heatData=this._getHeatmapData();L.HeatLayer.prototype.setLatLngs.call(this,this._heatData)},redraw:function(){L.HeatLayer.prototype.redraw.call(this)}});a.heatLayer=function(e,f){return new a.HeatLayer(e,f)}})(Z);(function(a){a.MarkerClusterLayer=L.MarkerClusterGroup.extend({initialize:function(a,e,f){null!=a&&void 0!=a?"object"==typeof a?(this._alldata=a,this._serviceUrl=""):"string"==typeof a?(this._serviceUrl=a,this._alldata=this._getDataFromService()):(this._alldata=[],this._serviceUrl=""):(this._alldata=[],this._serviceUrl="");this._allMarkers=[];this._options=e||{};this._iconStyle=f||{};this._eventKeys={};this._isAddFeatures=!0;L.MarkerClusterGroup.prototype.initialize.call(this,{showCoverageOnHover:this._options.showCoverageOnHover||!1,zoomToBoundsOnClick:this._options.zoomToBoundsOnClick||!1,spiderfyOnMaxZoom:this._options.spiderfyOnMaxZoom||!1,disableClusteringAtZoom:this._options.disableClusteringAtZoom||18,maxClusterRadius:this._options.maxClusterRadius||80,animate:this._options.animate||!0,iconCreateFunction:this._options.IconCreateFunction||null});this._alldata!=[]&&void 0!=this._alldata&&this._addDataToLayer()},onAdd:function(a){this._zmap=a;this._eventFunction=this._updateEvent.bind(this);this._zmap.on("moveend",this._eventFunction);this._zminZoom=void 0!=this._options.minZoom?this._options.minZoom:0;this._zmaxZoom=void 0!=this._options.maxZoom?this._options.maxZoom:this._map.getMaxZoom();var e,f;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";this._featureGroup.addTo(a);this._nonPointGroup.addTo(a);this._gridClusters||this._generateInitialClusters();this._maxLat=a.options.crs.projection.MAX_LATITUDE;a=0;for(e=this._needsRemoving.length;a<e;a++)f=this._needsRemoving[a],f.newlatlng=f.layer._latlng,f.layer._latlng=f.latlng;a=0;for(e=this._needsRemoving.length;a<e;a++)f=this._needsRemoving[a],this._removeLayer(f.layer,!0),f.layer._latlng=f.newlatlng;this._needsRemoving=[];this._zoom=Math.round(this._map._zoom);this._currentShownBounds=this._getExpandedVisibleBounds();this._zoomEndEventFunction=this._zoomEnd.bind(this);this._moveEndEventFunction=this._moveEnd.bind(this);this._map.on("zoomend",this._zoomEndEventFunction);this._map.on("moveend",this._moveEndEventFunction);this._spiderfierOnAdd&&this._spiderfierOnAdd();this._bindEvents();e=this._needsClustering;this._needsClustering=[];this.addLayers(e,!0);a=this._zmap.getZoom();(a>this._zmaxZoom||a<this._zminZoom)&&this.clearLayers()},onRemove:function(a){this._zmap.off("moveend",this._eventFunction);a.off("zoomend",this._zoomEndEventFunction);a.off("moveend",this._moveEndEventFunction);this._unbindEvents();this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","");this._spiderfierOnRemove&&this._spiderfierOnRemove();delete this._maxLat;this._hideCoverage();this._featureGroup.remove();this._nonPointGroup.remove();this._featureGroup.clearLayers();this._zmap=null},_addDataToLayer:function(){var a=this._alldata.length;if(0!=a)for(var e=0;e<a;e++){var f=this._alldata[e].centerLat||this._alldata[e].lat,h=this._alldata[e].centerLng||this._alldata[e].lng,k;k=this._iconStyle.type&&"divIcon"==this._iconStyle.type?L.divIcon(this._iconStyle):L.icon(this._iconStyle);f&&h&&(this._alldata[e].lat=f,this._alldata[e].lng=h,f=L.marker(new L.LatLng(f,h),{icon:k}),f.attributes=this._alldata[e],this.addFeature(f))}},_updateEvent:function(){if(this._zmap){var a=this._zmap.getZoom();a>=this._zminZoom&&a<=this._zmaxZoom?this._isAddFeatures||(this._addFeatures(),this._isAddFeatures=!0):this._isAddFeatures&&(this.clearLayers(),this._isAddFeatures=!1)}},_addFeatures:function(){if(this._allMarkers)for(var a=0,e=this._allMarkers.length;a<e;a++)this.addLayer(this._allMarkers[a])},_getDataFromService:function(a){var e=[];void 0!=a&&(this._serviceUrl=a);if(""==this._serviceUrl)return e;$.ajax({type:"get",async:!1,url:this._serviceUrl,dataType:"json",success:function(a){e=a},error:function(a){console.log("\u6570\u636e\u83b7\u53d6\u5931\u8d25\uff01"+a)}});return e},addEvent:function(a,e){var f=Object.keys(this._eventKeys).length,f="layer_event_"+a+f;this.on(a,this._eventKeys[f]=function(a){e(a)});return f},removeEvent:function(a,e){if(e)this._eventKeys[e]&&this.off(a,this._eventKeys[e]);else for(var f in this._eventKeys)-1!=f.indexOf(a)&&this.off(a,this._eventKeys[f])},addFeature:function(a){this._allMarkers.push(a);L.MarkerClusterGroup.prototype.addLayer.call(this,a)},clearFeatures:function(){this._allMarkers=[];L.MarkerClusterGroup.prototype.clearLayers.call(this)},setFeatures:function(a){this._allMarkers=a;this.clearLayers();this._addFeatures()},setData:function(a){this._alldata=a;this.clearFeatures();this._addDataToLayer()},refresh:function(a){this._alldata=this._getDataFromService(a);this.clearFeatures();this._addDataToLayer()}});a.markerClusterLayer=function(e,f,h){return new a.MarkerClusterLayer(e,f,h)}})(Z);(function(a){a.draw=function(a){this._map=a;this._type=null;this._pointAry=[];this._container=this._map._container;this._currentLayer=this._tempLayer=null;this._layerAry=[];this._radius=this._center=null;this.eventElement={}};a.draw.prototype={startDraw:function(a,e){this.stop();this._type=a.toLowerCase();this._map.doubleClickZoom.disable();this.eventElement.mousemove=this._onMove.bind(this);this.eventElement.click=this._onClick.bind(this);this.eventElement.dblclick=this._onFinish.bind(this,e);this.eventElement.mousedown=this._onmouseDown.bind(this);this.eventElement.mouseup=this._onmouseUp.bind(this,e);this._map.on("mousemove",this.eventElement.mousemove);this._map.on("click",this.eventElement.click);this._container.style.cursor="crosshair";if("circle"==this._type||"rectangle"==this._type)this._map.on("mousedown",this.eventElement.mousedown),this._map.on("mouseup",this.eventElement.mouseup);this._map.on("dblclick",this.eventElement.dblclick)},_onClick:function(a){a=a.latlng;"polyline"==this._type?(this._pointAry.push(a),1<this._pointAry.length&&(this._currentLayer?this._currentLayer.addLatLng(a):(this._currentLayer=new L.polyline([this._pointAry[0],this._pointAry[1]]),this._currentLayer.addTo(this._map)))):"polygon"==this._type?(this._pointAry.push(a),1<this._pointAry.length&&(this._currentLayer?this._currentLayer.addLatLng(a):(this._currentLayer=new L.polyline([this._pointAry[0],this._pointAry[1]]),this._currentLayer.addTo(this._map)))):"point"==this._type&&(this._pointAry.push(a),this._currentLayer=new L.circleMarker(a),this._currentLayer.addTo(this._map),this._layerAry.push(this._currentLayer),this._currentLayer=null)},_onmouseDown:function(a){this._map.dragging.disable();this._center=a.latlng;"circle"==this._type&&(this._currentLayer=L.circle(this._center,{radius:0}),this._currentLayer.addTo(this._map));"rectangle"==this._type&&(this._currentLayer=L.rectangle([this._center,this._center]),this._currentLayer.addTo(this._map))},_onmouseUp:function(a){var e;"circle"==this._type?e={type:this._type,center:this._center,radius:this._radius}:(e=this._currentLayer.getLatLngs(),e[0].push(e[0][0]),e={type:this._type,rectBounds:e});this._layerAry.push(this._currentLayer);this._currentLayer=this._center=null;this._map.dragging.enable();a&&a(e)},_onMove:function(a){a=a.latlng;"polyline"==this._type?0<this._pointAry.length&&(this._tempLayer?this._tempLayer.setLatLngs([this._pointAry[this._pointAry.length-1],a]):(this._tempLayer=new L.polyline([this._pointAry[this._pointAry.length-1],a]),this._tempLayer.addTo(this._map))):"polygon"==this._type?0<this._pointAry.length&&(this._tempLayer?this._tempLayer.setLatLngs([this._pointAry[0],a]):(this._tempLayer=new L.polyline([this._pointAry[this._pointAry.length-1],a]),this._tempLayer.addTo(this._map)),this._tempLayer1?this._tempLayer1.setLatLngs([this._pointAry[this._pointAry.length-1],a]):(this._tempLayer1=new L.polyline([this._pointAry[this._pointAry.length-1],a]),this._tempLayer1.addTo(this._map))):"circle"==this._type?this._center&&(this._radius=L.latLng(a).distanceTo(this._center),this._currentLayer.setRadius(this._radius)):"rectangle"==this._type&&this._center&&(this._rectBounds=[this._center,a],this._currentLayer.setBounds(this._rectBounds))},_onFinish:function(a){this._tempLayer&&(this._tempLayer.remove(),this._tempLayer=null);this._tempLayer1&&(this._tempLayer1.remove(),this._tempLayer1=null);if("point"==this._type||"polyline"==this._type)"point"==this._type&&(this._layerAry[this._layerAry.length-1].remove(),this._layerAry.pop()),this._pointAry.pop();"polygon"==this._type&&(this._pointAry.pop(),this._currentLayer&&(this._currentLayer.remove(),this._currentLayer=null),this._pointAry.push(this._pointAry[0]),this._currentLayer=(new L.polygon(this._pointAry)).addTo(this._map));if("circle"==this._type||"rectangle"==this._type)this._layerAry[this._layerAry.length-1].remove(),this._pointAry.pop(),this._layerAry[this._layerAry.length-2].remove(),this._pointAry.pop();var e={type:this._type,latLngAry:this._pointAry||[]};this._pointAry=[];this._currentLayer&&(this._layerAry.push(this._currentLayer),this._currentLayer=null);a&&a(e)},clearResult:function(){if(0<this._layerAry.length)for(var a=0;a<this._layerAry.length;a++)this._layerAry[a].remove()},cancel:function(){this._pointAry=[];this._radius=this._center=null;this._currentLayer&&(this._currentLayer.remove(),this._currentLayer=null);this._tempLayer&&(this._tempLayer.remove(),this._tempLayer=null);this._tempLayer1&&(this._tempLayer1.remove(),this._tempLayer1=null)},stop:function(){this.cancel();this._map.off("mousedown",this.eventElement.mousedown);this._map.off("mouseup",this.eventElement.mouseup);this._map.off("mousemove",this.eventElement.mousemove);this._map.off("click",this.eventElement.click);this._map.off("dblclick",this.eventElement.dblclick);this._container.style.cursor=""}}})(Z);(function(a){a.CircleMarker=L.CircleMarker.extend({});a.circleMarker=function(e,f,h){e=new a.CircleMarker(e,f);h&&(e.attributes=h);return e};L.circleMarker=a.circleMarker})(Z);(function(a){a.Marker=L.Marker.extend({initialize:function(a,e){this.iconOpt=e||{};var f={},g=null;void 0!=this.iconOpt.icon&&this.iconOpt.icon instanceof L.Icon?g=this.iconOpt.icon:void 0!=this.iconOpt.icon&&"string"==typeof this.iconOpt.icon||void 0!=this.iconOpt.iconUrl&&"string"==typeof this.iconOpt.iconUrl?(this.iconOpt.iconUrl=this.iconOpt.icon||this.iconOpt.iconUrl,g=L.icon(this.iconOpt)):this.iconOpt.html&&"string"==typeof this.iconOpt.html&&(g=L.divIcon(this.iconOpt));g&&(f.icon=g);L.Marker.prototype.initialize.call(this,a,f)},flashMarker:function(a,e){var f=0,g=this;this.intervalKey=setInterval(function(){f++;5<f?clearInterval(g.intervalKey):0==f%2?g.remove():g.addTo(e)},a)},setLatLng:function(a,e){L.Marker.prototype.setLatLng.call(this,a);e&&e instanceof Z.Zmap&&this.flashMarker(500,e)},setIcon:function(a){var e=Object.prototype.toString.call(a),f;"[object String]"==e?(this.iconOpt.iconUrl=a,f=L.icon(this.iconOpt)):"[object Object]"==e&&(f=L.icon(this.iconOpt));L.Marker.prototype.setIcon.call(this,f)},setDivIcon:function(a){var e=Object.prototype.toString.call(a),f;"[object String]"==e?(this.iconOpt.html=a,f=L.divIcon(this.iconOpt)):"[object Object]"==e&&(f=L.divIcon(a));L.Marker.prototype.setIcon.call(this,f)},alertSelf:function(){alert("i am z.marker!")}});a.marker=function(e,f,h){e=new a.Marker(e,f);h&&(e.attributes=h);return e};L.marker=a.marker})(Z);(function(a){a.Polyline=L.Polyline.extend({});a.polyline=function(e,f,h){e=new a.Polyline(e,f,h);e.attributes=h||"";return e};L.polyline=a.polyline})(Z);(function(a){a.Polygon=L.Polygon.extend({});a.polygon=function(e,f,h){e=new a.Polygon(e,f);e.attributes=h||"";return e};L.polygon=a.polygon})(Z);(function(a){a.Popup=L.Popup.extend({});a.popup=function(e){return new a.Popup(e)}})(Z);(function(a){a.Tooltip=L.Tooltip.extend({});a.tooltip=function(e){return new a.Tooltip(e)}})(Z);(function(a){a.Proj={};a.Proj.crs=L.Proj.CRS.extend({initialize:function(a,e,f){L.Proj.CRS.prototype.initialize.call(this,a,e,f)}});a.Proj.CRS=function(a,e,f){return new Z.Proj.crs(a,e,f)}})(Z)})(window);export default {Z};